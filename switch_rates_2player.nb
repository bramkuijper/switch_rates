(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    370721,      10179]
NotebookOptionsPosition[    354267,       9714]
NotebookOutlinePosition[    354711,       9732]
CellTagsIndexPosition[    354668,       9729]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Evolving Environmental Change - 2 individuals/patch", "Title",
 CellChangeTimes->{{3.68283925649305*^9, 3.682839275163673*^9}}],

Cell[CellGroupData[{

Cell["Basic functions", "Section",
 CellChangeTimes->{{3.685193445396308*^9, 3.6851934471079817`*^9}, {
  3.68519440129674*^9, 3.685194401847404*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.682840018157737*^9, 3.682840024116688*^9}}],

Cell["\<\
Survival dependent on the switch rate modulation factor. Maximum survival \
(continous time mortality rate = 1) when zs=0, otherwise mortality > 1.\
\>", "Text",
 CellChangeTimes->{{3.685194414430983*^9, 3.6851944637739887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nu", "[", "zs_", "]"}], ":=", 
  RowBox[{"1", "+", 
   RowBox[{"k", " ", 
    SuperscriptBox["zs", "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.6851069335929203`*^9, 3.685106959273797*^9}, {
  3.685192127968128*^9, 3.685192128706066*^9}, {3.685192408972494*^9, 
  3.685192411226541*^9}, {3.685192450467156*^9, 3.6851924877054367`*^9}, {
  3.685192519607628*^9, 3.685192520288231*^9}, {3.685192561967499*^9, 
  3.6851926076533413`*^9}}],

Cell[TextData[{
 "Function to export ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to C and string:"
}], "Text",
 CellChangeTimes->{{3.685194596178875*^9, 3.685194618402176*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tc", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{"CForm", "[", "x", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685194583927676*^9, 3.685194593421216*^9}, {
  3.685195371913392*^9, 3.6851953740144253`*^9}}],

Cell["Directory for exports from C", "Text",
 CellChangeTimes->{{3.685203539576831*^9, 3.6852035474156237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cdir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/switch_rates/src/numerical/2player/\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685203598214878*^9, 3.6852036640129433`*^9}}],

Cell["Substitution list", "Text",
 CellChangeTimes->{{3.685204081176705*^9, 3.6852040883981543`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"subslist", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", 
     RowBox[{"zs", "[", "1", "]"}]}], ",", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", 
     RowBox[{"zs", "[", "1", "]"}]}], ",", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", 
     RowBox[{"zs", "[", "2", "]"}]}], ",", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", 
     RowBox[{"zs", "[", "2", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.685204075096592*^9, 3.685204116313858*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"zs", "[", 
     RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", 
    RowBox[{"zs", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"zs", "[", 
     RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", 
    RowBox[{"zs", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"zs", "[", 
     RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", 
    RowBox[{"zs", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"zs", "[", 
     RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", 
    RowBox[{"zs", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685204116791028*^9, 3.685205503477003*^9, 
  3.685251041150608*^9, 3.685251771894628*^9, 3.6852518487488937`*^9, 
  3.685253730601018*^9, 3.685253973043376*^9, 3.685254091517014*^9, 
  3.685254171402437*^9, 3.6852543112860947`*^9, 3.685257674280416*^9, 
  3.685258586666609*^9, 3.685260223064498*^9, 3.6853379313450527`*^9, 
  3.685338472566917*^9, 3.685343258636223*^9, 3.6853439516853867`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"nu", "[", 
     RowBox[{"zs", "[", "1", "]"}], "]"}], "/.", 
    RowBox[{"k", "\[Rule]", ".25"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "5"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.685256370548551*^9, 3.6852564403925447`*^9}, {
  3.685256901320643*^9, 3.6852569166693163`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJw1lwk0lV33wO+9uXiRORmiJBJNMryZ2o9kyk1Sr0JvCqnoTcmUMRFKXyUS
IkkKidBEcW6GKF7CzRAZInN67sC9Lpf/8//W+s5aZ+31O+uctc/Z++y9z1H3
8HM6SSGRSL1E/3/51Mri1R6uFJ303yaP+RrqUHvXSNFF8TvbyOvkMM8/+/Nr
a8Xpj8vVfsaIS2M6ISbL5x6L0g1apP3Z82JYzveDdZcsqHRhsu7nQDVhbMfI
Dj7DgEov9lWqKV4pjNVNymzfrk2l+1h0v2EuUrFRbuv9UUkqXWVrQ+bdXiqm
I0u7eLBPiH5awof2VzoVK7Pes35LsBC9tK9290sFKlZXYnB5sGgFfampIRFX
FMLGoleZ2ShS6ME/pW95mFIwsYiS38liFPoljYbpCV0KtjXELndwkUxf87GM
GrGGggWdixALHSLTdxnrnPkoIGPCbj+7iwrJdEFn+txPOhnbYPAqUNacTHfF
w3SP2JExj9FDJd9PkOiZGfYCUU8SFjc046FziERPPFv8QeQvElbYl6AQbE2i
K+VaW8jakDBW+/sIaV0SXX7Xav+9uiSMEmWXFje+jMiH/Q1ujS8D6E20HVi5
jEIal0UnpZeh8q621bizAAVk6F3ZeVEAom5jnmQzAaIKaV5NdxWA87onV5TV
BajNslFTZrcAWIUadNrUIlK0VsP2yAhgE13NtDRqEZ36S7Sn4sUipE3K64Xm
LyDhbMb9H+wFCASyqgR/Hln07zupk8iHGiG6qebAPNKSMlNzD+SD9OdI1111
88hW4VtAoTsfig4t3jt/cx6ZPNVciDXgw8gZruzX9fNooIPvazcwD04pv0Qf
2POQ9pGsfinjedg+0cPZljWHKiVqRZIFXAjAt2xaHTuHYhhDiYNTXHjLjf57
yWcOJUu1V1t844KFsM7H5p1z6NqAlh684YKTRui9M4xZ1DCaY6Plz4XAv5VN
csVn0e07303zpuagss01SiGUjZzcfS28f83CUndxueA4G83fepu9qX8Wdg9S
xkds2GhUv6uI1DoLTTOFjuWr2Oje14SOiRez0Ce+oO5YykL2l6uc8gNnYdnq
ft21cSYiXTyr2EmZhT2VvX8InHGU/u8gnaPLgeLCPOMGUxyF2yX5q6hxQPG+
35mkdThKzfa1cZHmQCdX+I494zcK+JblqjzLBs0wZ+ks/gz6cp2nVYbYUBM9
K4HZ/EJSnXGHd7qwIdXj2lmG9C8UMMswbaOx4YylavPpb9NI+jfNMhpjgzTV
KjHpn2nEOl/5TkubDe4JKX8MJ08h55JEp3geCxZv6gvHDU6gJwoiitlZLPji
13BSuXAC3ehhbS28w4JcR7f64osTqDBI9ExzPAv2ysbEdglPoNtQau3sz4L0
u+2UTVvGkUB8/mmULQuMMi8sN10aRUdvnaBsmmfC+YISnozcMNLHUhU6fZmw
XfJczO7BH+hhDatlnxcTmP6bJS8+/4H4quVlPUeZ4G9WoMGw+YEC3d0Xtzgw
IbD1kUNq+BC6utI7rVGPCexJXTvD5gEkq7CZXb+IQ8DL/GOp3gNo38aPJy7P
4TAXoRnAJQ2gIJm6BQccB5702uwKw370n/NTpdojOCwayc6aZ/ehLpdxrZZm
HIRjeA+t/XtQZ3eG/lAODvG0wNdPJXrQYIj/kf5MHEQVWE2iT7tRF/N5/u97
OIgVTM197u1Cieccmxxu4iDV2k/bb9WJpJItlZbDcLid5ubxYuArusw3Ts8K
xkHWoztYJvQr6jdJ2eN4EQf52bZHHcUMdNw6QJXlg4OiSj3vsGIHik740bXR
DYf0EQvJirJ25PKGW3bqMA7KxdUayvvakRo6X/HuIA6qFm8d+qLbkJ/LTduH
NBwsW5ztPnS2os0VwX5ugIP1CceAGPFW5FvyLM/MDAdbjl22FdaC0iItRXYY
40BTNp/9VNCM3jx9QHPRx8HZWyOnPfwTktFcMZiujcP1CxcT7rxqRPFj6nXa
WjhUhdf6Oc00oHfBXWJNGjhsSPbc1e7+EbmSReh2a3E48qBc805aParnX96q
pYpDYsGKlU5tdejXh6TlVSo4sFBub9vuWhRYEfxp22octJrYNUlhNYgxQatx
WYWDS6dl4YGXHxBz7K3qPTkc6NPDIW2adHRi31+L9tI4jP8+RV9fVY1evbwa
VSuJw35h0VuPtlahhgnaSYeVOKjp225+JFOJ1lVlH3kghsNVu3G+esxbdMZN
19vzDxym3RM+5XBeo3MN+zpNRXE4GKSdpu79CumRRQo2iuBQeaPRO6erHJWK
Hu7XEsZBPfe0obpdGZr5bh5kTMUhoUJUKKfyBRq//O68uxAO/dkH8iyOFKNs
Zuu/aStweN6ctNvC9BmS2x72n58UHMLm2wYwtXxkZVZVYkWwnZZsBEbOQ/oK
qQYVZBxWH3RSxkZy0EAVdQ1GcNPyBr+om1nIVl/C+xsJh9MueQWRh+6hc0EF
sgkEC5VrjkQoJ6ED8d/V7QjGlGjmfPpVxDyZn6xKMJ6W7sVM90cOsmKnqQSH
U1LqrXe6wOkblGwSwVszPBvkjaIAYyTtlCK4X6l0RlzqBjAm3hjoEXxQv/t9
nEUKaP0bkOxN8Ouew1fiwzLAMLLxUAnBK+lTGnWuD4EsKAsRJ/YLyc/i6oJz
4bqdwXIowRe8fSfqUp7AF0/auIDgR8a6tPrSAuiwX9BPIc7PkJgqrm8pghSy
xQ9zwl7Cg4UyH6dKQOaqKptPcKaLoYlnbCnQOm97NxH2NbS86zssWw57ZjPM
Sgj7t2yezfTMeQnzQ6aBTwj/kEivlj2r30DGht2SrYQ/0yfk9UZoFRAX+vQc
ifD/jo4AD6/eStj2IFfPShwHrycG9V68KqhwOD4gStwfwa2UuZE4BBm96z7H
SxH2N+Mnl12nw06jkNXKMsR8Ldf6HUo18OzQVE+IPA7bVcT6/Qdr4LKiyH4r
BWK9VOVc2dNakCus0NJUxCF1Xklb36ge/IyGBWprcGho7rmuf7ARhDg29gsb
CH+GfGtw0/0EPlP7Ofc2EvlkQ69Q7IrPcDjx6z/2OjjsDeuLZJQ3QVOdS/vc
NhyaNw34B8q3gpya9Ql3In7Pfh0oyZpuhQoX05tlRHzHYefnPDy+wJh5ceIa
Sxw2Tp/XTzRpg75lCZ7BXkKfpf/z3sl20PQpTg12wWFnOqvpt3MHSEzeton+
m9D/239yRW0HhMoyG3NO4FCQcXHj5vsM+H1Ux3wjkY8mmQE54fadYNJ9ecoy
nND/MPiualEPOJ2ucq97jIPZHLdcT/EbVJwPVTQtxEGCFtJuFfsNCtRf5TSW
EPHADZE6d7QX1kbkamq/w2HGIfRatcR3+EfZi81rx+FtZHV1idEgJM4EPBkS
ZsLDgqV/K84OwsUoiVP1K5mQwNj1vfbRIAy/VecheSYc0UELXZJD4KZZnzi/
ngnzX9FO0tgQFI38DonEmGCy5UOZ471h+LLI8GmNYoIhozO1+tMwKOWZ2CTF
E/UmbDp08+IwHOnsJp+6xQStT6stRU+MwJuOahmHbCbInTzXgXR+wqKxXqYY
nQnTmSqcrdWjkPayxM2cyoIxS73uTHwUdk1nqZhLsuDHpPV7MY0x6Cmqq3Bc
zYKenf6xo/FjwGx8d7t8Ews+MhrlHxwYh7yzjgWn9rMgWyLIcOXPCdDwkLt6
7QELMsoTlcJWT8KGTde1G/JZkOqaIxi3m4Q1l4wLFctZcCO/ub6ueBKmyy1s
uQ0sCNmj4RweMgUyd3kzj1gscAr/EjQl/gv8qKSxcns2UIJW9Xkp4RDxIDD6
vQQHXI8Xtr81wEHO8kNXvDIHyvbCJwlHHGIPpMf6aHPAY+2Z1y/jiDr4bGYo
cA8Hahrf3xbi4GB6eOuzxxEciFHxsnrcwoSFOHKIB4cDQh/Kiodj2HDFnss/
xp6Fo89s8v7MZkOa7pf1q4Tm4OXdvvuJlWxIDDTM+SE/B14+wtf0mWwQssnL
qTWag3o5V8+YYxywHVQqzQqbgzhvsqKG8SzITDuLlf3BBREJx2iPmTnIP73u
idufPDiy0ZVuRIyHv//6/OFeHhTu9loW28CFy3uY+ot/88DhUkhEuQsXZJmu
7+ZieZA6+vCSUD0XPN7zXs938EDrA/PCk/s8qFI5duLPoHmwCkr2mLTlg6Og
9UpSEx9iBjst/XMFwLF35NErBNBfYf9PyHsBTB++sJH3RQAmyfTUyK+EdDUY
3z0uANyqcOK6yBIwLB6qya1egmPPIm7l+i6BSJaU+4PAJTAJ2tDL0F8Grxja
1uNGyzBPNa5Q8SBhS/FrY2yJ9/yL+3GOkSwyRktZ0dIhTcGa5OLGpEgU7HtV
5IjMOgo2mng1MmclBeNJvA9320bB1oTHFtVpU7BWlYgdMg4ULOHoFVFxdwrG
X1AsF75BwY6rRtLvNVGwfR/fiCqLrcCkswO3lz5egQ1eSaL+kBTC/B55SY84
U7Gq+6+suCbC2DGfDNX4aFHsTAuJ51wnhl07EGSsnymO1UxWjNxul8KE5O+O
RvElsZZPXseLlmQx96zU/FCuFPa//9n/AUyy5vk=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-10, 10}, {0, 5}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], Automatic}]], "Output",
 CellChangeTimes->{{3.685256397215892*^9, 3.6852564409357243`*^9}, {
   3.685256906530796*^9, 3.6852569172369003`*^9}, 3.685257674309387*^9, 
   3.685258586715549*^9, 3.68526022312451*^9, 3.685337931387886*^9, 
   3.6853384726117697`*^9, 3.685343258681716*^9, 3.685343951739462*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["q"], "Input",
 CellChangeTimes->{3.6852572065266542`*^9}],

Cell[BoxData["q"], "Output",
 CellChangeTimes->{3.685257674318218*^9, 3.685258586725913*^9, 
  3.685260223137815*^9, 3.68533793142702*^9, 3.685338472656887*^9, 
  3.685343258735654*^9, 3.685343951750124*^9}]
}, Open  ]],

Cell["\<\
Export system of equations to C code\
\>", "Text",
 CellChangeTimes->{{3.685212481064468*^9, 3.685212494054912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recur2c", "[", 
   RowBox[{
   "lhs_", ",", "rhs_", ",", "variables_", ",", "bound_", ",", 
    "convergence_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "str", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Length", "[", "lhs", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "rhs", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Length", "[", "lhs", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "variables", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"first", " ", "declare", " ", "rhs"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "lhs", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"tc", "[", 
           RowBox[{"lhs", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"then", " ", "iterate"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{
      "str", "<>", 
       "\"\<for(int iter = 0; iter < 1e08; ++iter) {\\n\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "rhs", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", 
          RowBox[{"tc", "[", 
           RowBox[{"lhs", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
          RowBox[{"tc", "[", "bound", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"tc", "[", 
           RowBox[{"rhs", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"evaluate", " ", "convergence"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"convergence", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", "\"\<if (\\n\\n\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"iter", "=", "1"}], ",", 
          RowBox[{"iter", "\[LessEqual]", 
           RowBox[{"Length", "[", "rhs", "]"}]}], ",", 
          RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"str", "=", 
            RowBox[{"str", "<>", "\"\<fabs(\>\"", "<>", 
             RowBox[{"tc", "[", 
              RowBox[{"lhs", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\< - \>\"", 
             "<>", 
             RowBox[{"tc", "[", 
              RowBox[{"variables", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", 
             "\"\<)<=1e-07\>\""}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"iter", "<", 
              RowBox[{"Length", "[", "rhs", "]"}]}], ",", 
             RowBox[{"str", "=", 
              RowBox[{"str", "<>", "\"\<&&\\n\\n\>\""}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", "\"\<)\\n\\n{break;}\\n\\n\>\""}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"update", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "rhs", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", 
          RowBox[{"tc", "[", 
           RowBox[{"variables", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
          RowBox[{"tc", "[", 
           RowBox[{"lhs", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "iteration"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"str", " ", "=", 
      RowBox[{"str", "<>", "\"\<}\\n\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"export", " ", "to", " ", "gsl_vector"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "rhs", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"str", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"tc", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"tc", "[", 
           RowBox[{"variables", "[", 
            RowBox[{"[", "iter", "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "str", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685209614910993*^9, 3.685209661145727*^9}, {
  3.685209694142723*^9, 3.685209863273239*^9}, {3.685210764292458*^9, 
  3.685210987028152*^9}, {3.685211248559246*^9, 3.685211367200728*^9}, {
  3.685211408176893*^9, 3.68521144977796*^9}, {3.685211490328933*^9, 
  3.685211491803747*^9}, {3.685211528790462*^9, 3.685211535122222*^9}, {
  3.685211647585174*^9, 3.685211647652994*^9}, {3.6852118011456337`*^9, 
  3.6852118024652767`*^9}, {3.685212205485675*^9, 3.6852122517039757`*^9}, {
  3.6852123539821568`*^9, 3.68521235460798*^9}, {3.685212389002179*^9, 
  3.685212389854944*^9}, {3.685212439952259*^9, 3.685212444685377*^9}, {
  3.685257651751573*^9, 3.68525766889802*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Patch frequencies", "Section",
 CellChangeTimes->{{3.682839290907461*^9, 3.682839293683313*^9}, {
  3.685106951853847*^9, 3.685106952468895*^9}}],

Cell["\<\
2 players per patch: 2 environments with each individual either adapted or \
maladapted yielding 2x3 combinations\
\>", "Text",
 CellChangeTimes->{{3.682839352322534*^9, 3.682839377921241*^9}}],

Cell[CellGroupData[{

Cell["Basic functions", "Subsection",
 CellChangeTimes->{{3.682839734424313*^9, 3.682839735832242*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"patches", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"ei", ",", 
       RowBox[{"statex", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"statex", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ei", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.683222237011471*^9, 3.683222280771747*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "a", ",", "a"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "a", ",", "m"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "m", ",", "m"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "a", ",", "a"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "a", ",", "m"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6832222759161987`*^9, 3.683222281683762*^9}, 
   3.683227218136971*^9, 3.683227252466351*^9, 3.6849993032342567`*^9, {
   3.685007559979795*^9, 3.685007579715004*^9}, 3.685008286419301*^9, 
   3.685008494743064*^9, 3.68500996763317*^9, 3.685011903429612*^9, 
   3.6850121476347237`*^9, 3.685012776888669*^9, 3.685012967781156*^9, 
   3.685013033025296*^9, 3.6850131272772627`*^9, 3.685013245109236*^9, 
   3.6850135999341373`*^9, 3.685013682735832*^9, 3.6850137754977293`*^9, 
   3.6850748796888723`*^9, 3.685075735769313*^9, 3.685075868415422*^9, 
   3.6850759787426233`*^9, 3.6850760657339487`*^9, 3.685076249278241*^9, 
   3.685076349549931*^9, 3.685076431412888*^9, 3.685076813206607*^9, 
   3.68507689822722*^9, 3.6850772992828608`*^9, 3.6850773553793497`*^9, 
   3.685077412155895*^9, 3.685077799456902*^9, 3.685078087792465*^9, 
   3.685081063136734*^9, 3.6850811518396893`*^9, 3.6850814422704773`*^9, 
   3.685081849194378*^9, 3.685081945689837*^9, 3.685085951250333*^9, 
   3.6850860370932217`*^9, 3.685086083981477*^9, 3.6850861808714247`*^9, 
   3.685086579923284*^9, {3.685086627706616*^9, 3.685086646912017*^9}, 
   3.685092453386024*^9, 3.685092915850807*^9, 3.68509295922782*^9, 
   3.685093413421948*^9, 3.685094211018045*^9, 3.685094964086812*^9, 
   3.685095985992957*^9, 3.685096026822175*^9, 3.685096260466878*^9, 
   3.6850994564972143`*^9, 3.68510464846751*^9, 3.685104835054796*^9, 
   3.6851049937330723`*^9, 3.6851065041455927`*^9, 3.6851923778078003`*^9, 
   3.685192714003703*^9, 3.6851932592139606`*^9, 3.685193930704368*^9, 
   3.685195318748199*^9, 3.685195391031385*^9, 3.685203477955783*^9, 
   3.685204014003182*^9, 3.6852055035136127`*^9, 3.68521304605175*^9, 
   3.6852510411921177`*^9, 3.685251771953755*^9, 3.68525184879139*^9, 
   3.6852537306390047`*^9, 3.6852539730847054`*^9, 3.685254091568342*^9, 
   3.685254171433578*^9, 3.685254311300158*^9, 3.6852576743298798`*^9, 
   3.685258586736271*^9, 3.68526022314818*^9, 3.685337931467326*^9, 
   3.685338472760654*^9, 3.685343258792523*^9, 3.685343951760996*^9}]
}, Open  ]],

Cell[TextData[{
 "Determine phenotype of adult living in envt ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]]],
 " and having state x (a,m)"
}], "Text",
 CellChangeTimes->{{3.682839984971283*^9, 3.6828400101313667`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phen", "[", 
    RowBox[{"ei_", ",", "state_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "state", "}"}], ",", "a"}], "]"}], ">", "0"}], "&&", 
       RowBox[{"ei", "\[Equal]", "1"}]}], "||", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "state", "}"}], ",", "m"}], "]"}], ">", "0"}], "&&", 
       RowBox[{"ei", "\[Equal]", "2"}]}]}], ",", "1", ",", "2"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.68284001348737*^9, 3.682840037124978*^9}}],

Cell[TextData[{
 "Probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "a"], "(", 
    RowBox[{
     SubscriptBox["e", "1"], ",", 
     SubscriptBox["state", "1"], ",", 
     SubscriptBox["state", "2"]}], ")"}], TraditionalForm]]],
 " that a locally ",
 StyleBox["adapted",
  FontSlant->"Italic"],
 " juvenile occupies a vacant position in a environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]]],
 "-patch previously containing two adult breeders in state1 and state2"
}], "Text",
 CellChangeTimes->{{3.6828397381281157`*^9, 3.682839819678378*^9}, {
  3.68284056184733*^9, 3.6828405665666933`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pa", "[", 
   RowBox[{"ei_", ",", "state1_", ",", "state2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "d"}], ")"}], 
    FractionBox["1", "2"], 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ei", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "state1"}], "]"}], "]"}], "+", 
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "state2"}], "]"}], "]"}]}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "state1"}], "]"}], "]"}], "+", "1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "state2"}], "]"}], "]"}]}]}], "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], "d", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"ex", ",", 
         RowBox[{"statex", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"statex", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ei", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ex", ",", 
             RowBox[{"statex", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ex", ",", 
             RowBox[{"statex", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"1", "-", 
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ex", ",", 
             RowBox[{"statex", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", "-", 
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ex", ",", 
             RowBox[{"statex", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "m"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.682839719870585*^9, 3.682839720051049*^9}, {
  3.682839822464223*^9, 3.6828398757381887`*^9}, {3.6828400587273703`*^9, 
  3.682840294744473*^9}, {3.682840703519944*^9, 3.6828408266472*^9}, {
  3.682841023676312*^9, 3.6828410239780693`*^9}, {3.68284118263155*^9, 
  3.68284118294252*^9}, {3.6850865588763866`*^9, 3.685086559544208*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pa", "[", 
    RowBox[{"1", ",", "a", ",", "m"}], "]"}], "/.", 
   RowBox[{"d", "\[Rule]", "1"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.682841188469254*^9, 3.6828411995228653`*^9}, {
   3.682841275411911*^9, 3.682841308552052*^9}, {3.6828415300931807`*^9, 
   3.68284156846031*^9}, 3.682841608403376*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "a", ",", "a"}], "]"}]}], "+", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "a", ",", "m"}], "]"}], "+", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "a", ",", "m"}], "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"2", ",", "m", ",", "m"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"p", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "a", ",", "m"}], "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"1", ",", "m", ",", "m"}], "]"}], "+", 
          RowBox[{"f", "[", 
           RowBox[{"2", ",", "a", ",", "a"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "a", ",", "m"}], "]"}]}], ")"}], " ", 
     RowBox[{"p", "[", "2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.682841192704534*^9, 3.682841199968245*^9}, {
   3.682841276806492*^9, 3.6828413089177113`*^9}, {3.682841533120509*^9, 
   3.682841569209649*^9}, 3.682841608983121*^9, 3.682842910011792*^9, 
   3.682844514397462*^9, 3.6828447159831877`*^9, {3.682844846986526*^9, 
   3.682844863474484*^9}, 3.683199338390189*^9, 3.683200029421755*^9, 
   3.683201000637844*^9, 3.683214380319901*^9, 3.683218276157082*^9, 
   3.68321831135402*^9, {3.683218492739461*^9, 3.6832185218232*^9}, 
   3.683218639399634*^9, 3.6832190357360373`*^9, 3.6832201201193733`*^9, 
   3.6832201774186783`*^9, 3.6832206185877743`*^9, 3.683220690943645*^9, 
   3.683221738944068*^9, 3.68322721826365*^9, 3.683227252590742*^9, 
   3.684999303642604*^9, {3.6850075601117897`*^9, 3.685007579864496*^9}, 
   3.685008286589367*^9, 3.685008494915966*^9, 3.685009967779059*^9, 
   3.685011903600491*^9, 3.685012147782193*^9, 3.685012777041614*^9, 
   3.685012967936809*^9, 3.685013033232036*^9, 3.685013127416522*^9, 
   3.685013245240933*^9, 3.68501360002663*^9, 3.6850136828747272`*^9, 
   3.6850137756613007`*^9, 3.6850748800338306`*^9, 3.685075735933838*^9, 
   3.685075868565686*^9, 3.685075978894773*^9, 3.685076065884923*^9, 
   3.685076249430232*^9, 3.685076349727113*^9, 3.6850764315951347`*^9, 
   3.6850768132988777`*^9, 3.685076898381061*^9, 3.68507729944401*^9, 
   3.6850773555399523`*^9, 3.6850774123274307`*^9, 3.685077799622957*^9, 
   3.6850780879539957`*^9, 3.685081063297488*^9, 3.685081151925584*^9, 
   3.685081442402013*^9, 3.685081849307811*^9, 3.685081945828076*^9, 
   3.685085951391398*^9, 3.6850860372490473`*^9, 3.68508608411896*^9, 
   3.6850861810054617`*^9, 3.685086580088492*^9, {3.685086627857723*^9, 
   3.685086647097645*^9}, 3.685092453529442*^9, 3.685092915983756*^9, 
   3.685092959409892*^9, 3.685093413582841*^9, 3.685094211148366*^9, 
   3.685094964254448*^9, 3.6850959862621737`*^9, 3.685096026953394*^9, 
   3.685096260640827*^9, 3.685099456628468*^9, 3.685104648595625*^9, 
   3.685104835166637*^9, 3.685104993852152*^9, 3.685106504263212*^9, 
   3.6851923780969667`*^9, 3.685192714088077*^9, 3.685193259341174*^9, 
   3.685193930826263*^9, 3.685195318803*^9, 3.685195391139791*^9, 
   3.68520347825112*^9, 3.6852040141854267`*^9, 3.685205503622254*^9, 
   3.6852130462416897`*^9, 3.685251041528364*^9, 3.685251772108836*^9, 
   3.685251849015472*^9, 3.6852537307619467`*^9, 3.685253973311348*^9, 
   3.685254091741087*^9, 3.6852541716457767`*^9, 3.685254311426118*^9, 
   3.685257674434897*^9, 3.685258586851617*^9, 3.685260223272583*^9, 
   3.685337931750361*^9, 3.685338472862597*^9, 3.685343258871876*^9, 
   3.685343951872925*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pa", "[", 
    RowBox[{"1", ",", "a", ",", "a"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.682841517422905*^9, 3.682841526380045*^9}, {
  3.6828417602481403`*^9, 3.682841851534142*^9}, {3.682841912036694*^9, 
  3.6828419663814487`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.682841821434124*^9, 3.682841842847329*^9}, {
   3.682841920530855*^9, 3.682841966909236*^9}, 3.6828429100198517`*^9, 
   3.6828445144075203`*^9, 3.682844716011902*^9, {3.682844847024642*^9, 
   3.6828448635076113`*^9}, 3.683199338427557*^9, 3.683200029471447*^9, 
   3.683201000676756*^9, 3.683214380386866*^9, 3.683218276196762*^9, 
   3.683218311403677*^9, {3.6832184927772617`*^9, 3.683218521857522*^9}, 
   3.683218639454995*^9, 3.68321903578629*^9, 3.6832201202632217`*^9, 
   3.683220177477306*^9, 3.683220618636527*^9, 3.683220690985627*^9, 
   3.6832217390121393`*^9, 3.683227218332843*^9, 3.683227252646771*^9, 
   3.684999303685499*^9, {3.685007560159361*^9, 3.6850075799358807`*^9}, 
   3.6850082866462584`*^9, 3.685008494989964*^9, 3.685009967845724*^9, 
   3.685011903664136*^9, 3.685012147850857*^9, 3.685012777113967*^9, 
   3.685012967990906*^9, 3.685013033291245*^9, 3.685013127473474*^9, 
   3.685013245296096*^9, 3.685013600102476*^9, 3.6850136829316587`*^9, 
   3.685013775728223*^9, 3.6850748801383*^9, 3.6850757360228987`*^9, 
   3.68507586862656*^9, 3.685075978903473*^9, 3.685076065947893*^9, 
   3.685076249507657*^9, 3.6850763498020687`*^9, 3.685076431675651*^9, 
   3.685076813430128*^9, 3.68507689844995*^9, 3.685077299517057*^9, 
   3.685077355548881*^9, 3.68507741239686*^9, 3.685077799674364*^9, 
   3.6850780880178747`*^9, 3.685081063367538*^9, 3.685081151980352*^9, 
   3.685081442458097*^9, 3.685081849351707*^9, 3.685081945898109*^9, 
   3.685085951450654*^9, 3.685086037306644*^9, 3.6850860841763477`*^9, 
   3.6850861810654583`*^9, 3.685086580158391*^9, {3.685086627926958*^9, 
   3.685086647270421*^9}, 3.685092453568722*^9, 3.685092916035282*^9, 
   3.685092959479425*^9, 3.685093413649984*^9, 3.685094211190962*^9, 
   3.685094964319703*^9, 3.685095986339053*^9, 3.685096027002777*^9, 
   3.685096260681573*^9, 3.6850994566809187`*^9, 3.6851046486406393`*^9, 
   3.685104835198838*^9, 3.685104993982679*^9, 3.6851065043865557`*^9, 
   3.6851923781390963`*^9, 3.685192714141163*^9, 3.685193259369917*^9, 
   3.685193930903494*^9, 3.6851953188372097`*^9, 3.6851953911740303`*^9, 
   3.685203478285568*^9, 3.6852040142225733`*^9, 3.685205503651813*^9, 
   3.685213046293688*^9, 3.685251041560988*^9, 3.685251772132962*^9, 
   3.685251849049152*^9, 3.685253730789715*^9, 3.685253973347105*^9, 
   3.685254091775095*^9, 3.685254171665597*^9, 3.685254311463567*^9, 
   3.6852576744619303`*^9, 3.685258586890995*^9, 3.6852602233190613`*^9, 
   3.68533793175637*^9, 3.6853384728991737`*^9, 3.685343258916667*^9, 
   3.6853439519075947`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pa", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "+", 
    RowBox[{"pa", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "+", 
    RowBox[{"pa", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "+", 
    RowBox[{"pa", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "+", 
    RowBox[{"pa", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "+", 
    RowBox[{"pa", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], "/.", 
   RowBox[{"d", "\[Rule]", "1"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.682840359525919*^9, 3.682840472752337*^9}, {
   3.68284050478489*^9, 3.6828405078070307`*^9}, {3.682840625326007*^9, 
   3.6828406531702023`*^9}, {3.6828408388166523`*^9, 3.682840855078033*^9}, {
   3.682840895231802*^9, 3.682840895876672*^9}, 3.682841063673695*^9, {
   3.682841159671711*^9, 3.6828411607109137`*^9}, {3.682841340819521*^9, 
   3.682841343826193*^9}, {3.682841779434367*^9, 3.682841783802148*^9}, {
   3.6828418548084707`*^9, 3.682841876119692*^9}}],

Cell[BoxData[
 RowBox[{"3", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "+", 
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6828403645828123`*^9, 3.6828403749069357`*^9}, {
   3.682840416467767*^9, 3.6828404197217913`*^9}, 3.682840473560335*^9, 
   3.682840508423678*^9, {3.6828406322184362`*^9, 3.682840653582881*^9}, {
   3.682840809632477*^9, 3.682840855495788*^9}, 3.682840896550845*^9, 
   3.6828410256035547`*^9, 3.6828410644117517`*^9, 3.68284116167943*^9, 
   3.682841344330983*^9, 3.68284178431448*^9, {3.6828418553712053`*^9, 
   3.6828418765709476`*^9}, 3.68284291005037*^9, 3.682844514450981*^9, 
   3.682844716138966*^9, {3.682844847062601*^9, 3.682844863543186*^9}, 
   3.683199338462479*^9, 3.6832000295053663`*^9, 3.683201000741777*^9, 
   3.683214380419036*^9, 3.68321827623742*^9, 3.6832183114414988`*^9, {
   3.6832184928194237`*^9, 3.683218521892448*^9}, 3.683218639517066*^9, 
   3.6832190358324327`*^9, 3.683220120319436*^9, 3.683220177530161*^9, 
   3.683220618677787*^9, 3.683220691021121*^9, 3.683221739060266*^9, 
   3.683227218388176*^9, 3.683227252700585*^9, 3.684999303740405*^9, {
   3.685007560208445*^9, 3.685007579998063*^9}, 3.685008286714221*^9, 
   3.685008495056122*^9, 3.685009967913353*^9, 3.685011903729702*^9, 
   3.685012147919332*^9, 3.6850127771800537`*^9, 3.68501296805023*^9, 
   3.685013033355081*^9, 3.6850131275337763`*^9, 3.685013245346822*^9, 
   3.685013600171372*^9, 3.685013682992012*^9, 3.685013775797236*^9, 
   3.685074880210393*^9, 3.685075736110366*^9, 3.685075868698574*^9, 
   3.685075978967676*^9, 3.685076066025852*^9, 3.685076249583844*^9, 
   3.685076349869388*^9, 3.685076431753357*^9, 3.6850768134974546`*^9, 
   3.685076898529725*^9, 3.685077299600334*^9, 3.68507735555586*^9, 
   3.685077412468491*^9, 3.685077799738387*^9, 3.685078088083767*^9, 
   3.685081063428174*^9, 3.6850811520438538`*^9, 3.685081442512354*^9, 
   3.685081849394587*^9, 3.6850819459595003`*^9, 3.685085951549638*^9, 
   3.6850860373682528`*^9, 3.685086084282722*^9, 3.685086181117704*^9, 
   3.685086580230761*^9, {3.6850866279871492`*^9, 3.6850866473454857`*^9}, 
   3.685092453608584*^9, 3.68509291608119*^9, 3.685092959542161*^9, 
   3.685093413718198*^9, 3.685094211238393*^9, 3.685094964374873*^9, 
   3.6850959863871927`*^9, 3.6850960270563993`*^9, 3.685096260723125*^9, 
   3.685099456722061*^9, 3.685104648648177*^9, 3.68510483528983*^9, 
   3.685104994026232*^9, 3.685106504422119*^9, 3.685192378183195*^9, 
   3.685192714200428*^9, 3.685193259398912*^9, 3.685193930986261*^9, 
   3.685195318869544*^9, 3.685195391207869*^9, 3.685203478316454*^9, 
   3.685204014253077*^9, 3.68520550368015*^9, 3.685213046324086*^9, 
   3.6852510416025963`*^9, 3.685251772157885*^9, 3.6852518490791807`*^9, 
   3.685253730815157*^9, 3.685253973379024*^9, 3.685254091807227*^9, 
   3.685254171686304*^9, 3.685254311498958*^9, 3.68525767448794*^9, 
   3.685258586931349*^9, 3.6852602233612967`*^9, 3.685337931790765*^9, 
   3.685338472934938*^9, 3.68534325896111*^9, 3.685343951944759*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
dfaadt - changes in frequency of patches containing two adapted individuals\
\>", "Subsection",
 CellChangeTimes->{{3.685080022316739*^9, 3.685080037484027*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.685079589061872*^9, 3.685079592885844*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfaadt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"q", " ", 
      RowBox[{"zs", "[", 
       RowBox[{
        RowBox[{"3", "-", "ei"}], ",", "m"}], "]"}]}], "]"}], 
    RowBox[{"s", "[", 
     RowBox[{"3", "-", "ei"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"3", "-", "ei"}], ",", "m", ",", "m"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"q", " ", 
      RowBox[{"zs", "[", 
       RowBox[{"ei", ",", "a"}], "]"}]}], "]"}], 
    RowBox[{"s", "[", "ei", "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.685078329231666*^9, 3.685078350433331*^9}, {
   3.685079532325173*^9, 3.68507958589573*^9}, {3.685079674917585*^9, 
   3.685079675956917*^9}, 3.6850800536951027`*^9, {3.685192189396329*^9, 
   3.685192211619975*^9}}],

Cell["\<\
Mortality of maladapted individual in f[ei,a,m] patch, replaced by adapted\
\>", "Text",
 CellChangeTimes->{{3.685079595669931*^9, 3.68507960836557*^9}, {
  3.685079800690548*^9, 3.6850798163937893`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfaadt2", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6850796677101316`*^9, 3.685079682334791*^9}, {
   3.685079728206745*^9, 3.685079753595113*^9}, 3.6850799958536053`*^9, 
   3.685080052854694*^9}],

Cell["Mortality of adapted individual replaced by maladapted", "Text",
 CellChangeTimes->{{3.6850797708899593`*^9, 3.685079798000944*^9}, {
  3.685079856009412*^9, 3.68507986216748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfaadt3", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "2"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.68507988561872*^9, 3.685079896723215*^9}, {
   3.685079988091125*^9, 3.685079994854566*^9}, 3.6850800521982727`*^9, {
   3.685080086967593*^9, 3.6850800870505447`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfaadt", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"dfaadt1", "[", "ei", "]"}], "+", 
   RowBox[{"dfaadt2", "[", "ei", "]"}], "+", 
   RowBox[{"dfaadt3", "[", "ei", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685079999821764*^9, 3.685080007369368*^9}, {
  3.685080040672866*^9, 3.6850800495934668`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
dfamdt - changes in frequency of patches containing one adapted and one \
maladapted breeder\
\>", "Subsection",
 CellChangeTimes->{{3.685080183921131*^9, 3.685080197632658*^9}, 
   3.685081138439829*^9}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.685080201192494*^9, 3.685080206231926*^9}, 
   3.685081138440209*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfamdt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"q", " ", 
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", 
         RowBox[{
          RowBox[{"3", "-", "ei"}], ",", "a"}], "]"}], "+", 
        RowBox[{"zs", "[", 
         RowBox[{
          RowBox[{"3", "-", "ei"}], ",", "m"}], "]"}]}], ")"}]}], "]"}], 
    RowBox[{"s", "[", 
     RowBox[{"3", "-", "ei"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"3", "-", "ei"}], ",", "a", ",", "m"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"q", 
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", 
         RowBox[{"ei", ",", "a"}], "]"}], "+", 
        RowBox[{"zs", "[", 
         RowBox[{"ei", ",", "m"}], "]"}]}], ")"}]}], "]"}], 
    RowBox[{"s", "[", "ei", "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6850801082643747`*^9, 3.685080178526833*^9}, 
   3.6850803882960987`*^9, 3.6850811384409122`*^9, {3.685192226822084*^9, 
   3.6851922398527184`*^9}, {3.685192287308612*^9, 3.685192290879471*^9}}],

Cell["\<\
Mortality of a maladapted individual in a f[ei,m,m] patch, replaced by an \
adapted individual\
\>", "Text",
 CellChangeTimes->{{3.685080310053713*^9, 3.685080328653447*^9}, 
   3.685081138442872*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfamdt2", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", " ", 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685080329798661*^9, 3.685080386740913*^9}, 
   3.685081138443363*^9}],

Cell["\<\
Mortality of an adapted individual in a f[ei,a,a] patch, replaced by a \
maladapted individual\
\>", "Text",
 CellChangeTimes->{{3.6850803990034637`*^9, 3.685080421986698*^9}, 
   3.6850811384451838`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfamdt3", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", " ", 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685080423015396*^9, 3.685080448634514*^9}, 
   3.685081138445656*^9}],

Cell[TextData[{
 "Mortality of an adapted individual in a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "[", 
    RowBox[{
     SubscriptBox["e", "i"], ",", "a", ",", "m"}], "]"}], TraditionalForm]]],
 " patch, replaced by a maladapted individual"
}], "Text",
 CellChangeTimes->{{3.685080208423974*^9, 3.68508023278393*^9}, 
   3.685081138447915*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfamdt4", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"mu", "[", "a", "]"}]}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685080240259932*^9, 3.6850802471164703`*^9}, {
   3.685080287275671*^9, 3.685080307206882*^9}, 3.685080389260743*^9, {
   3.68508050489818*^9, 3.685080505024611*^9}, 3.6850811384483967`*^9}],

Cell["\<\
Mortality of a maladapted individual in a f[ei,a,m] patch, replaced by an \
adapted individual\
\>", "Text",
 CellChangeTimes->{{3.6850805166164427`*^9, 3.6850805366798162`*^9}, 
   3.685081138450787*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfamdt5", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"mu", "[", "m", "]"}]}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685080537632009*^9, 3.6850805632669487`*^9}, 
   3.6850811384512672`*^9}],

Cell["Total change:", "Text",
 CellChangeTimes->{{3.6850806467412663`*^9, 3.685080654316482*^9}, 
   3.685081138453212*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dfamdt", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dfamdt1", "[", "ei", "]"}], "+", 
    RowBox[{"dfamdt2", "[", "ei", "]"}], "+", 
    RowBox[{"dfamdt3", "[", "ei", "]"}], "+", 
    RowBox[{"dfamdt4", "[", "ei", "]"}], "+", 
    RowBox[{"dfamdt5", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685080579421645*^9, 3.6850806082942553`*^9}, 
   3.685081138453676*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
dfmmdt -  changes in frequency of patches containing two maladapted breeders\
\>", "Subsection",
 CellChangeTimes->{{3.685080714443746*^9, 3.685080728883328*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfmmdt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"q", " ", 
      RowBox[{"zs", "[", 
       RowBox[{
        RowBox[{"3", "-", "ei"}], ",", "m"}], "]"}]}], "]"}], 
    RowBox[{"s", "[", 
     RowBox[{"3", "-", "ei"}], "]"}], 
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{"3", "-", "ei"}], ",", "a", ",", "a"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"q", " ", 
      RowBox[{"zs", "[", 
       RowBox[{"ei", ",", "m"}], "]"}]}], "]"}], 
    RowBox[{"s", "[", "ei", "]"}], 
    RowBox[{"f", "[", 
     RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.685080731020108*^9, 3.685080741751562*^9}, {
  3.685080820126631*^9, 3.6850808545694923`*^9}, {3.685081431046817*^9, 
  3.685081432323371*^9}, {3.685192274177895*^9, 3.685192284836411*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfmmdt2", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "2"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6850808559780483`*^9, 3.6850808790400047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfmmdt3", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}], 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685080879827236*^9, 3.6850809017672853`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfmmdt", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"dfmmdt1", "[", "ei", "]"}], "+", 
   RowBox[{"dfmmdt2", "[", "ei", "]"}], "+", 
   RowBox[{"dfmmdt3", "[", "ei", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685080907145267*^9, 3.685080922148411*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Solve for equilibrium patch frequencies", "Subsection",
 CellChangeTimes->{{3.682844188372295*^9, 3.68284419688402*^9}}],

Cell[TextData[{
 "Add the constraint that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "o"}], "n"], 
     SubscriptBox["p", "i"]}], "=", "1"}], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.6851936967836103`*^9, 3.6851937501920013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dfdtconst", "=", 
   RowBox[{
    RowBox[{"Total", "[", "patches", "]"}], "\[Equal]", "1"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682844302412682*^9, 3.6828443146524973`*^9}, {
  3.682844414907618*^9, 3.68284443839462*^9}, {3.685193682485427*^9, 
  3.685193687531497*^9}}],

Cell["Generate system of recursion equations:", "Text",
 CellChangeTimes->{{3.685193743206633*^9, 3.68519374877499*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"syspatch", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"dfaadt", "[", "ei", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"dfamdt", "[", "ei", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"dfmmdt", "[", "ei", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682844484883501*^9, 3.68284455262272*^9}, {
   3.685080963023711*^9, 3.685081012556081*^9}, 3.685081077988969*^9}],

Cell[CellGroupData[{

Cell[BoxData["patches"], "Input",
 CellChangeTimes->{{3.685194866787046*^9, 3.685194867407126*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "a", ",", "a"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "a", ",", "m"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "m", ",", "m"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "a", ",", "a"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "a", ",", "m"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685194867748021*^9, 3.685195318980809*^9, 
  3.685195391397894*^9, 3.685203478469838*^9, 3.685204014372943*^9, 
  3.6852055037722673`*^9, 3.6852130464587383`*^9, 3.6852510417010393`*^9, 
  3.68525177227794*^9, 3.6852518491556263`*^9, 3.68525373099445*^9, 
  3.685253973456129*^9, 3.685254091894681*^9, 3.685254171750798*^9, 
  3.6852543115806427`*^9, 3.6852576746616993`*^9, 3.685258587025703*^9, 
  3.685260223465317*^9, 3.685337931890082*^9, 3.68533847303193*^9, 
  3.6853432590800333`*^9, 3.685343952038754*^9}]
}, Open  ]],

Cell["\<\
Make list of recursions, with constraint inserted at different positions. \
These should result in the same solutions, unless something is wrong:\
\>", "Text",
 CellChangeTimes->{{3.6851936068178177`*^9, 3.685193641833178*^9}, {
  3.6851937538308153`*^9, 3.685193754070374*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"syspatch1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"syspatch", ",", 
     RowBox[{"1", "\[Rule]", "dfdtconst"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"syspatch2", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"syspatch", ",", 
     RowBox[{"6", "\[Rule]", "dfdtconst"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682844554378042*^9, 3.682844578228119*^9}, {
  3.682844859868082*^9, 3.682844861049427*^9}}],

Cell["Prepare system of recursions for export to C", "Text",
 CellChangeTimes->{{3.685193601338025*^9, 3.685193603553784*^9}, {
  3.685193648057824*^9, 3.685193658080552*^9}}],

Cell["\<\
Numerically solve for testing purposes (solving will be done in C for \
scalability)\
\>", "Text",
 CellChangeTimes->{{3.685194314049472*^9, 3.68519432744888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansTest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"syspatch1", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
     RowBox[{
      RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
     RowBox[{"d", "\[Rule]", "ds"}], ",", 
     RowBox[{"k", "\[Rule]", "ks"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
     RowBox[{"q", "\[Rule]", "qs"}], ",", 
     RowBox[{
      RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "zs1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "zs2"}], "/.", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
       RowBox[{"1", "/", "6"}]}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "6"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "6"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "6"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "6"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "6"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.682844199111166*^9, 3.682844224606859*^9}, {
  3.682844441749*^9, 3.682844478975329*^9}, {3.682844531163204*^9, 
  3.6828445315602903`*^9}, {3.682844581072274*^9, 3.682844677536944*^9}, {
  3.682844729987465*^9, 3.682844773807713*^9}, {3.685192306979719*^9, 
  3.685192314054551*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ans", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
     RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"syspatch1", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
        RowBox[{
         RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
        RowBox[{"d", "\[Rule]", "ds"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
        RowBox[{"q", "\[Rule]", "qs"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "zs2"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "zs2"}]}], "}"}]}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a", ",", "a"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "m", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a", ",", "a"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "m", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682844199111166*^9, 3.682844224606859*^9}, {
  3.682844441749*^9, 3.682844478975329*^9}, {3.682844531163204*^9, 
  3.6828445315602903`*^9}, {3.682844581072274*^9, 3.682844677536944*^9}, {
  3.6828447930515327`*^9, 3.682844815210123*^9}, {3.68519231685913*^9, 
  3.685192323720293*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ansAlt", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
     RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"syspatch2", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
        RowBox[{
         RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
        RowBox[{"d", "\[Rule]", "ds"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
        RowBox[{"q", "\[Rule]", "qs"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "zs2"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "zs2"}]}], "}"}]}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a", ",", "a"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "m", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a", ",", "a"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "m", ",", "m"}], "]"}], ",", 
         RowBox[{"1", "/", "6"}]}], "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682844199111166*^9, 3.682844224606859*^9}, {
  3.682844441749*^9, 3.682844478975329*^9}, {3.682844531163204*^9, 
  3.6828445315602903`*^9}, {3.682844581072274*^9, 3.682844688243565*^9}, {
  3.682844832244445*^9, 3.682844834671414*^9}, {3.6851923258501177`*^9, 
  3.685192331566452*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.001", ",", "0.001"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"-", "6"}]}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682844781892026*^9, 3.682844782378977*^9}, {
  3.682844819490077*^9, 3.682844819955771*^9}, {3.682844876997488*^9, 
  3.682844878226667*^9}, {3.6850777646861973`*^9, 3.6850777670015182`*^9}, {
  3.6850780647816143`*^9, 3.685078081227344*^9}, {3.6851923343989363`*^9, 
  3.6851923361906137`*^9}, {3.685192841279498*^9, 3.685192843948432*^9}, {
  3.685338026133791*^9, 3.6853380474763403`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "3.2825667184432916`*^-10"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "1.0927583151409959`*^-6"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "0.0009275757522136385`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "0.9980707000338122`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "0.0010003803991589788`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "2.5072824330618637`*^-7"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6828447827654123`*^9, {3.682844821396532*^9, 3.682844878707765*^9}, 
   3.6831993387273903`*^9, 3.683200029893487*^9, 3.683201001140911*^9, 
   3.6832143806598473`*^9, 3.6832182765087013`*^9, 3.68321831169211*^9, {
   3.683218493060857*^9, 3.683218522210465*^9}, 3.683218639826892*^9, 
   3.683219036047797*^9, 3.683220120573119*^9, 3.683220177968446*^9, 
   3.683220619040297*^9, 3.68322069132654*^9, 3.6832217392966213`*^9, 
   3.68322721861211*^9, 3.683227253156739*^9, 3.68499930399527*^9, {
   3.685007560419134*^9, 3.685007580231512*^9}, 3.685008286988879*^9, 
   3.6850084953443747`*^9, 3.685009968185704*^9, 3.6850119040159483`*^9, 
   3.685012148177631*^9, 3.685012777571328*^9, 3.685012968304817*^9, 
   3.685013033685768*^9, 3.6850131278745613`*^9, 3.68501324556518*^9, 
   3.685013600580434*^9, 3.685013683233445*^9, 3.685013776065131*^9, 
   3.6850748805188704`*^9, 3.685075736391295*^9, 3.68507586901478*^9, 
   3.6850759794223547`*^9, 3.685076066306322*^9, 3.685076249852889*^9, 
   3.685076350111226*^9, 3.6850764320211554`*^9, 3.685076813805097*^9, 
   3.6850768987989187`*^9, 3.685077300153605*^9, 3.6850773569110737`*^9, 
   3.685077412782378*^9, 3.68507780007425*^9, 3.685078088424971*^9, 
   3.685081063861752*^9, 3.685081152510149*^9, 3.685081442782928*^9, 
   3.68508184964107*^9, 3.685081946252952*^9, 3.685085952756777*^9, 
   3.685086037710112*^9, 3.685086084769474*^9, 3.685086181358395*^9, 
   3.685086580518042*^9, {3.685086628308524*^9, 3.6850866477324677`*^9}, 
   3.685092453784459*^9, 3.685092916285747*^9, 3.68509295978725*^9, 
   3.6850934139916067`*^9, 3.685094211554818*^9, 3.685094964573463*^9, 
   3.685095986731049*^9, 3.685096027293748*^9, 3.6850962609233007`*^9, 
   3.6850994569022913`*^9, 3.6851046488891773`*^9, 3.685104835423463*^9, 
   3.685104994172699*^9, 3.685106504553814*^9, 3.685192378416411*^9, 
   3.68519271438186*^9, 3.6851928445871477`*^9, 3.68519325951027*^9, 
   3.6851953190740757`*^9, 3.685195391455617*^9, 3.685203478558576*^9, 
   3.685204014436275*^9, 3.685205503829817*^9, 3.685213046528452*^9, 
   3.685251041822526*^9, 3.6852517723160267`*^9, 3.685251849197152*^9, 
   3.685253731059587*^9, 3.685253973498225*^9, 3.685254091938044*^9, 
   3.685254171782583*^9, 3.685254311633862*^9, 3.685257674706873*^9, 
   3.685258587092372*^9, 3.6852602235355062`*^9, 3.685337932008513*^9, 
   3.685338054034779*^9, 3.6853384730918207`*^9, 3.685343259146886*^9, 
   3.685343952101493*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansAlt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682844690394718*^9, 3.682844712964632*^9}, {
  3.682844838725485*^9, 3.682844839098769*^9}, {3.682844870750375*^9, 
  3.682844872394734*^9}, {3.685077767894009*^9, 3.685077775554861*^9}, {
  3.685078067478292*^9, 3.68507807981194*^9}, {3.685192339519293*^9, 
  3.6851923424858627`*^9}, {3.685192862500772*^9, 3.685192864173212*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "0.0595487919594417`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "0.11762087657362477`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "0.09555760419420622`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "0.41431016124425507`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "0.25218368760407234`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "0.06077887842439991`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.682844716599186*^9, {3.6828448395941877`*^9, 3.682844874177581*^9}, 
   3.6831993387641363`*^9, 3.683200029926746*^9, 3.683201001172039*^9, 
   3.6832143806914454`*^9, 3.683218276554338*^9, 3.683218311733917*^9, {
   3.6832184932008963`*^9, 3.683218522251499*^9}, 3.683218639889962*^9, 
   3.683219036099676*^9, 3.6832201206165752`*^9, 3.6832201780165997`*^9, 
   3.683220619083599*^9, 3.683220691367845*^9, 3.683221739347555*^9, 
   3.6832272186566763`*^9, 3.6832272532032633`*^9, 3.684999304043631*^9, {
   3.685007560469062*^9, 3.6850075802857924`*^9}, 3.6850082870569897`*^9, 
   3.685008495420949*^9, 3.685009968250052*^9, 3.6850119040863*^9, 
   3.685012148240642*^9, 3.685012777646031*^9, 3.685012968362817*^9, 
   3.685013033754993*^9, 3.6850131279415092`*^9, 3.685013245620973*^9, 
   3.685013600656406*^9, 3.6850136832925797`*^9, 3.685013776131822*^9, 
   3.685074880600281*^9, 3.685075736477002*^9, 3.685075869088674*^9, 
   3.685075979488834*^9, 3.685076066381819*^9, 3.6850762499299726`*^9, 
   3.685076350177273*^9, 3.685076432091567*^9, 3.6850768138816977`*^9, 
   3.685076898881054*^9, 3.685077300243291*^9, 3.68507735700529*^9, 
   3.685077412860422*^9, 3.6850778001388817`*^9, 3.685078088489896*^9, 
   3.685081063905786*^9, 3.685081152573719*^9, 3.685081442832481*^9, 
   3.68508184968534*^9, 3.685081946307667*^9, 3.685085952842292*^9, 
   3.685086037780876*^9, 3.685086084824038*^9, 3.6850861814157257`*^9, 
   3.685086580589713*^9, {3.68508662837501*^9, 3.685086647816201*^9}, 
   3.685092453821241*^9, 3.6850929163293467`*^9, 3.685092959850953*^9, 
   3.685093414049865*^9, 3.685094211606552*^9, 3.685094964622698*^9, 
   3.6850959867762623`*^9, 3.685096027333662*^9, 3.6850962609669228`*^9, 
   3.685099456956641*^9, 3.685104648935484*^9, 3.685104835454926*^9, 
   3.685104994208764*^9, 3.685106504577187*^9, 3.685192378458057*^9, 
   3.6851927144337587`*^9, 3.685192864650381*^9, 3.6851932595406303`*^9, 
   3.6851953191309137`*^9, 3.685195391486326*^9, 3.6852034785970182`*^9, 
   3.685204014466538*^9, 3.6852055038611813`*^9, 3.685213046558045*^9, 
   3.6852510418590183`*^9, 3.685251772341393*^9, 3.685251849224792*^9, 
   3.685253731089748*^9, 3.685253973531011*^9, 3.685254091965027*^9, 
   3.685254171803451*^9, 3.685254311666025*^9, 3.685257674732993*^9, 
   3.685258587149139*^9, 3.685260223586885*^9, 3.685337932042871*^9, 
   3.6853384731355343`*^9, 3.685343259190302*^9, 3.685343952144123*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export patch frequency equations to C\
\>", "Subsection",
 CellChangeTimes->{{3.685194333961053*^9, 3.685194337792637*^9}, {
  3.685203438213744*^9, 3.685203466531927*^9}, {3.685204183114839*^9, 
  3.685204185013172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"patchvalstplus1", "=", 
  RowBox[{"patches", "/.", 
   RowBox[{"f", "\[Rule]", "ftplus1"}]}]}]], "Input",
 CellChangeTimes->{{3.685212650400878*^9, 3.6852126583226337`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "a", ",", "a"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "a", ",", "m"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "m", ",", "m"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "a", ",", "a"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "a", ",", "m"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6852126589661303`*^9, 3.6852130027139482`*^9, 
  3.685213046562191*^9, 3.6852510418985233`*^9, 3.685251772367029*^9, 
  3.685251849251306*^9, 3.6852537311160107`*^9, 3.68525397356702*^9, 
  3.685254091991384*^9, 3.685254171820225*^9, 3.685254311698874*^9, 
  3.6852576747582817`*^9, 3.685258587154525*^9, 3.685260223629644*^9, 
  3.685337932077648*^9, 3.685338473170862*^9, 3.685343259234456*^9, 
  3.685343952149354*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"patchsysRHS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "+", 
          RowBox[{"eul", " ", 
           RowBox[{"dfaadt", "[", "ei", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
          RowBox[{"eul", " ", 
           RowBox[{"dfamdt", "[", "ei", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "+", 
          RowBox[{"eul", " ", 
           RowBox[{"dfmmdt", "[", "ei", "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "/.", 
     "subslist"}], "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"patchsysRHS", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"patchsysRHS", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"2", ",", "m", ",", "m"}], "]"}], "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{"dfdtconst", ",", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], "]"}]}], "/.", 
         RowBox[{"f", "\[Rule]", "ftplus1"}]}], ")"}]}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.685212665706449*^9, 3.685212716074629*^9}, {
  3.685212822871293*^9, 3.685212945561305*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"strpatchFreq", "=", 
   RowBox[{"recur2c", "[", 
    RowBox[{
    "patchvalstplus1", ",", "patchsysRHS", ",", "patches", ",", "bound01", 
     ",", "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6852129491915293`*^9, 3.685212972499621*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"cdir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "strpatchFreq"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.685203492229539*^9, 3.685203532381892*^9}, 
   3.685203673044236*^9, 3.68520402268504*^9, 3.685204062963731*^9, 
   3.685213042041252*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reproductive values", "Section",
 CellChangeTimes->{{3.682844962098281*^9, 3.6828449638582706`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvals", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"ex", ",", "statex1", ",", "statex2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex1", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex2", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683200086190008*^9, 3.683200155658983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvalsTest", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "statex1", ",", "statex2"}], "]"}], "\[Rule]", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "statex1", ",", "statex2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"statex1", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex2", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6832001606051397`*^9, 3.683200179314473*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    SubscriptBox["e", "i"]}], TraditionalForm]]],
 ",a,m]: Reproductive value of focal adapted individual sharing a environment \
ei patch with a maladapted individual "
}], "Subsection",
 CellChangeTimes->{{3.682845152607973*^9, 3.6828451899586554`*^9}, {
  3.683199373324525*^9, 3.683199405378907*^9}}],

Cell["Environmental change:", "Text",
 CellChangeTimes->{{3.682845239557769*^9, 3.6828452435668077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6828451992130203`*^9, 3.682845246071899*^9}, {
  3.683199347330213*^9, 3.68319940962227*^9}, {3.685192895131504*^9, 
  3.685192897684272*^9}}],

Cell["Mortality of focal, replaced by her own maladapted offspring", "Text",
 CellChangeTimes->{{3.6828452501496277`*^9, 3.68284525658976*^9}, {
  3.682845329972937*^9, 3.682845331604385*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt2", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845258154578*^9, 3.682845356278455*^9}, {
   3.683199411005266*^9, 3.683199421837904*^9}, {3.683199452764576*^9, 
   3.68319951112311*^9}, 3.683227210190816*^9}],

Cell["Mortality of focal, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68284535944386*^9, 3.682845365923882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt3", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845368271618*^9, 3.682845390486068*^9}, {
   3.683199514840802*^9, 3.683199523540876*^9}, 3.683227209011223*^9}],

Cell["Mortality of nonfocal, replaced by focal's offspring", "Text",
 CellChangeTimes->{{3.682845393347591*^9, 3.682845405355267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt4", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "m", ",", "a"}], "]"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}], "]"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845406494494*^9, 3.6828454555095787`*^9}, {
  3.6831995261390457`*^9, 3.683199751862639*^9}}],

Cell["\<\
Mortality of nonfocal, replaced by nonfocal offspring of a different type \
than nonfocal\
\>", "Text",
 CellChangeTimes->{{3.682845472978017*^9, 3.6828454882093973`*^9}, {
  3.683199796656701*^9, 3.683199797376515*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt5", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845489127758*^9, 3.682845652705119*^9}, {
   3.683199761631853*^9, 3.683199902715605*^9}, {3.683200116816619*^9, 
   3.683200118465126*^9}, {3.683200860421144*^9, 3.683200864659851*^9}, 
   3.6832189099756813`*^9, 3.683227206083026*^9}],

Cell["\<\
Mortality of individual in remote patch, replaced by focal's offspring\
\>", "Text",
 CellChangeTimes->{{3.682845684654298*^9, 3.682845694533659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt6", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682845654868635*^9, 3.682845679124524*^9}, {
   3.6831983981408043`*^9, 3.683198481007554*^9}, {3.683198569254446*^9, 
   3.683198631061006*^9}, {3.683198894243639*^9, 3.683199109099525*^9}, 
   3.68319934095358*^9, {3.683199926463127*^9, 3.683199981943626*^9}, {
   3.68320035894034*^9, 3.6832003611335793`*^9}, 3.683218944788011*^9, 
   3.683227204207383*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvamdt", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvamdt1", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt2", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt3", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt4", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt5", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt6", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683199311291834*^9, 3.683199335664133*^9}, {
  3.683200008076005*^9, 3.6832000770423727`*^9}, {3.683200190847007*^9, 
  3.683200245334814*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    SubscriptBox["e", "i"]}], TraditionalForm]]],
 ",m,a]: Reproductive value of focal maladapted individual sharing a \
environment ei patch with an adapted individual "
}], "Subsection",
 CellChangeTimes->{{3.682845152607973*^9, 3.6828451899586554`*^9}, {
  3.683199373324525*^9, 3.683199405378907*^9}, {3.683200341720703*^9, 
  3.683200352201293*^9}}],

Cell["Environmental change:", "Text",
 CellChangeTimes->{{3.682845239557769*^9, 3.6828452435668077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6828451992130203`*^9, 3.682845246071899*^9}, {
  3.683199347330213*^9, 3.68319940962227*^9}, {3.6832004127359333`*^9, 
  3.68320043309993*^9}, {3.685192906452745*^9, 3.68519290995665*^9}}],

Cell["Mortality of focal, replaced by her own adapted offspring", "Text",
 CellChangeTimes->{{3.6828452501496277`*^9, 3.68284525658976*^9}, {
  3.682845329972937*^9, 3.682845331604385*^9}, {3.683200460076082*^9, 
  3.6832004609474897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt2", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845258154578*^9, 3.682845356278455*^9}, {
   3.683199411005266*^9, 3.683199421837904*^9}, {3.683199452764576*^9, 
   3.68319951112311*^9}, {3.6832004363552237`*^9, 3.683200472657877*^9}, {
   3.683200555700583*^9, 3.6832005768996687`*^9}, 3.683219505299831*^9, 
   3.683227201430964*^9}],

Cell["Mortality of focal, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68284535944386*^9, 3.682845365923882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt3", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845368271618*^9, 3.682845390486068*^9}, {
   3.683199514840802*^9, 3.683199523540876*^9}, {3.68320058014487*^9, 
   3.683200589869781*^9}, 3.683227200189714*^9}],

Cell["Mortality of nonfocal, replaced by focal's offspring", "Text",
 CellChangeTimes->{{3.682845393347591*^9, 3.682845405355267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt4", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], "]"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845406494494*^9, 3.6828454555095787`*^9}, {
  3.6831995261390457`*^9, 3.683199751862639*^9}, {3.6832005956307487`*^9, 
  3.683200742417244*^9}, {3.683200801830461*^9, 3.683200802245098*^9}}],

Cell["\<\
Mortality of nonfocal adapted, replaced by nonfocal maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.682845472978017*^9, 3.6828454882093973`*^9}, {
  3.683199796656701*^9, 3.683199797376515*^9}, {3.683213694530525*^9, 
  3.683213700345112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt5", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845489127758*^9, 3.682845652705119*^9}, {
   3.683199761631853*^9, 3.683199902715605*^9}, {3.683200116816619*^9, 
   3.683200118465126*^9}, {3.683200754640517*^9, 3.6832008538239202`*^9}, {
   3.6832008997121553`*^9, 3.683200902071858*^9}, 3.6832189925315723`*^9, {
   3.68321984562053*^9, 3.683219862401634*^9}, 3.6832271967477627`*^9}],

Cell["\<\
Mortality of individual in remote patch, replaced by focal's offspring\
\>", "Text",
 CellChangeTimes->{{3.682845684654298*^9, 3.682845694533659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt6", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682845654868635*^9, 3.682845679124524*^9}, {
   3.6831983981408043`*^9, 3.683198481007554*^9}, {3.683198569254446*^9, 
   3.683198631061006*^9}, {3.683198894243639*^9, 3.683199109099525*^9}, 
   3.68319934095358*^9, {3.683199926463127*^9, 3.683199981943626*^9}, {
   3.683200927136066*^9, 3.6832009722494783`*^9}, 3.683218996081359*^9, 
   3.683227195001505*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvmadt", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvmadt1", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt2", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt3", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt4", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt5", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt6", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683199311291834*^9, 3.683199335664133*^9}, {
  3.683200008076005*^9, 3.6832000770423727`*^9}, {3.683200190847007*^9, 
  3.683200245334814*^9}, {3.683200978950598*^9, 3.6832009932869453`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    RowBox[{
     SubscriptBox["e", "i"], ",", "a", ",", "a"}], "]"}], TraditionalForm]]],
 " reproductive value of focal adapted individual living in a patch with \
another adapted individual"
}], "Subsection",
 CellChangeTimes->{{3.6832132294642563`*^9, 3.683213249847337*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.6832132582712584`*^9, 3.683213260558799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6832132616833057`*^9, 3.683213303386718*^9}, {
   3.6832177969847403`*^9, 3.6832178203628473`*^9}, 3.6832271931226387`*^9, {
   3.6851929164419117`*^9, 3.685192918858774*^9}}],

Cell["Focal adapted dies, replaced by her own maladapted offspring", "Text",
 CellChangeTimes->{{3.6832132809258957`*^9, 3.683213296676857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt2", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6832133014352007`*^9, 3.683213357824053*^9}, {
   3.683213401879324*^9, 3.683213403911558*^9}, {3.683213534705427*^9, 
   3.683213542979003*^9}, 3.683227192084193*^9}],

Cell["Focal adapted dies, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68321336010565*^9, 3.683213366625884*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt3", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683213367584035*^9, 3.683213416711776*^9}, 
   3.683227190646262*^9}],

Cell["Nonfocal adapted dies, replaced by focal offspring", "Text",
 CellChangeTimes->{{3.683213418678454*^9, 3.68321342567815*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt4", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6832134270223827`*^9, 3.683213583469589*^9}, 
   3.683227187898449*^9}],

Cell["\<\
Nonfocal adapted dies, replaced by nonfocal maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.6832135876560698`*^9, 3.683213597054346*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt5", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}]}], "+", 
     RowBox[{"d", "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683213598227193*^9, 3.6832137177*^9}, 
   3.6832190029681473`*^9, 3.683220676813352*^9, {3.683224361949139*^9, 
   3.683224364332396*^9}, 3.68322718657099*^9, {3.685005433142889*^9, 
   3.685005439598843*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt6", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683213719921734*^9, 3.683213773822291*^9}, 
   3.6832190057815733`*^9, 3.6832271841108418`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvaadt", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvaadt1", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt2", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt3", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt4", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt5", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt6", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683213786759811*^9, 3.6832138193694963`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"v", "[", 
   RowBox[{
    SubscriptBox["e", "i"], ",", "m", ",", "m"}], "]"}], 
  TraditionalForm]]]], "Subsection",
 CellChangeTimes->{{3.6832144102492037`*^9, 3.683214425500306*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.6832177787163754`*^9, 3.683217781747661*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683217782423493*^9, 3.683217791529729*^9}, {
   3.683217881336334*^9, 3.683217897056925*^9}, {3.6832271799072657`*^9, 
   3.683227182420065*^9}, 3.6832272429076*^9, {3.685192927521343*^9, 
   3.685192929667186*^9}}],

Cell["Focal dies, replaced by her own adapted offspring", "Text",
 CellChangeTimes->{{3.6832144383815317`*^9, 3.683214453429648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt2", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683214430586694*^9, 3.6832144562819443`*^9}, {
   3.6832174226063623`*^9, 3.683217427491819*^9}, {3.683217776583317*^9, 
   3.683217776664213*^9}, {3.683217903779244*^9, 3.6832179482178926`*^9}, 
   3.6832271790872507`*^9}],

Cell["Focal dies, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6832179512898397`*^9, 3.683217958449692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt3", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683217959347053*^9, 3.683217984452059*^9}, 
   3.6832271776208477`*^9}],

Cell["Nonfocal dies, replaced by focal offspring ", "Text",
 CellChangeTimes->{{3.683217987151927*^9, 3.683217991370469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt4", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683217993904415*^9, 3.6832180563791037`*^9}, {
  3.683218095013372*^9, 3.683218143285419*^9}}],

Cell["\<\
Nonfocal maladapted dies, replaced by nonfocal adapted offspring\
\>", "Text",
 CellChangeTimes->{{3.683218151473761*^9, 3.683218170208146*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt5", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683218146483746*^9, 3.683218227381504*^9}, 
   3.683219026276667*^9, 3.683220671511565*^9, 3.683227168476479*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt6", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683213719921734*^9, 3.683213773822291*^9}, {
   3.6832182359567204`*^9, 3.683218271839697*^9}, 3.6832190294842663`*^9, 
   3.6832271744595623`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvmmdt", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvmmdt1", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt2", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt3", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt4", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt5", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt6", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683218278288801*^9, 3.683218309191255*^9}, {
  3.6832185168692217`*^9, 3.68321852724966*^9}, {3.683227169531499*^9, 
  3.6832271732217007`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Find equilibrium reproductive values", "Subsection",
 CellChangeTimes->{{3.683218435956686*^9, 3.683218443140956*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvsys", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"dvmmdt", "[", "ei", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"dvaadt", "[", "ei", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"dvamdt", "[", "ei", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"dvmadt", "[", "ei", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683218445813548*^9, 3.6832184889190693`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvconstraint", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "a"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    "1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683218565414443*^9, 3.683218651929019*^9}, {
  3.6832201537093763`*^9, 3.68322017417721*^9}, {3.685007551305884*^9, 
  3.6850075767270184`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["rvconstraint"], "Input",
 CellChangeTimes->{{3.683220139552684*^9, 3.68322014428004*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], " ", 
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a", ",", "m"}], "]"}], "+", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "m", ",", "a"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], " ", 
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], " ", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "a", ",", "m"}], "]"}], "+", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "m", ",", "a"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}], " ", 
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}]}]}], "\[Equal]", 
  "1"}]], "Output",
 CellChangeTimes->{
  3.683220144689172*^9, 3.6832201784812193`*^9, 3.68322061962683*^9, 
   3.683220691624185*^9, 3.683221739590584*^9, 3.6832272192975597`*^9, 
   3.683227253672536*^9, 3.684999304334524*^9, {3.68500756073915*^9, 
   3.685007580634136*^9}, 3.685008324204123*^9, 3.685008495781111*^9, 
   3.685009968522624*^9, 3.685011904466653*^9, 3.685012148507814*^9, 
   3.685012778009078*^9, 3.6850129687739697`*^9, 3.685013034178965*^9, 
   3.685013128468617*^9, 3.685013245846919*^9, 3.685013601092149*^9, 
   3.685013683560832*^9, 3.685013776555921*^9, 3.685074880963729*^9, 
   3.685075736890358*^9, 3.685075869879331*^9, 3.685075980476068*^9, 
   3.685076066920776*^9, 3.685076250270548*^9, 3.68507635069657*^9, 
   3.685076432407044*^9, 3.685076814358395*^9, 3.685076899309168*^9, 
   3.685077300764921*^9, 3.68507735730202*^9, 3.685077413248564*^9, 
   3.685086648156271*^9, 3.685092454021798*^9, 3.685092916560483*^9, 
   3.685092960260188*^9, 3.685093414529076*^9, 3.685094211803638*^9, 
   3.685094964843175*^9, 3.685095987464802*^9, 3.6850960275264883`*^9, 
   3.68509626122556*^9, 3.685099457180242*^9, 3.6851046493127117`*^9, 
   3.685104835636804*^9, 3.685104994399272*^9, 3.6851065047456017`*^9, {
   3.685192975488578*^9, 3.685193025675151*^9}, 3.685193259710915*^9, 
   3.685195602468197*^9, 3.685204727560247*^9, 3.685204762310638*^9, 
   3.685205504073303*^9, {3.685212299337327*^9, 3.6852123231885843`*^9}, 
   3.6852510423649797`*^9, 3.685251772533085*^9, 3.6852518494728003`*^9, 
   3.685253731543276*^9, 3.6852539737267838`*^9, 3.685254092180318*^9, 
   3.6852541719556837`*^9, 3.6852543118609533`*^9, 3.6852576750867767`*^9, 
   3.685258587362433*^9, 3.685260223828507*^9, 3.685337932405004*^9, 
   3.6853384733460417`*^9, 3.685343259516118*^9, 3.685343952441827*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rvsys1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"rvsys", ",", 
     RowBox[{"1", "\[Rule]", "rvconstraint"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvsys2", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"rvsys", ",", 
     RowBox[{"5", "\[Rule]", "rvconstraint"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvinit", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rvali", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"rvali", ",", "rvals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"rvinittest", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"rvali", "\[Rule]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{"rvali", ",", "rvals"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.683218669983214*^9, 3.683218692556246*^9}, {
  3.683218752833969*^9, 3.68321877334536*^9}, {3.68321883761534*^9, 
  3.6832188536637487`*^9}, {3.6849992946119757`*^9, 3.6849992947318983`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m", ",", "a"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m", ",", "a"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}], "\[Rule]", "1"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6832188545809517`*^9, 3.68321903640269*^9, 3.6832201208770123`*^9, 
   3.6832201785361567`*^9, 3.683220619666597*^9, 3.683220691663301*^9, 
   3.683221739647336*^9, 3.683227219348284*^9, 3.6832272537120953`*^9, 
   3.684999304339632*^9, {3.685007560786059*^9, 3.685007580641615*^9}, 
   3.6850083242777033`*^9, 3.685008495787641*^9, 3.685009968678939*^9, 
   3.685011904528977*^9, 3.6850121485151043`*^9, 3.685012778016477*^9, 
   3.6850129687807198`*^9, 3.685013034185869*^9, 3.685013128477092*^9, 
   3.6850132458537493`*^9, 3.6850136010986757`*^9, 3.685013683567915*^9, 
   3.685013776562566*^9, 3.685074880969589*^9, 3.685075736971559*^9, 
   3.6850758698887997`*^9, 3.685075980529332*^9, 3.685076066998007*^9, 
   3.6850762502769403`*^9, 3.685076350770644*^9, 3.685076432479941*^9, 
   3.6850768143647614`*^9, 3.685076899315483*^9, 3.685077300772057*^9, 
   3.685077357308679*^9, 3.685077413313024*^9, 3.685086648163258*^9, 
   3.6850924540285273`*^9, 3.685092916567473*^9, 3.6850929602671328`*^9, 
   3.685093414592883*^9, 3.685094211810199*^9, 3.6850949648931*^9, 
   3.685095987470986*^9, 3.6850960275330553`*^9, 3.6850962612323723`*^9, 
   3.685099457186511*^9, 3.685104649319562*^9, 3.6851048356432533`*^9, 
   3.685104994406191*^9, 3.6851065047524023`*^9, {3.685192975531331*^9, 
   3.685193025681736*^9}, 3.685193259717888*^9, 3.685195602508443*^9, 
   3.685204727584993*^9, 3.685204762342784*^9, 3.685205504104356*^9, {
   3.6852122993596992`*^9, 3.685212323209803*^9}, 3.6852510423708344`*^9, 
   3.685251772556611*^9, 3.685251849475964*^9, 3.6852537315464687`*^9, 
   3.685253973730184*^9, 3.685254092183361*^9, 3.685254171958787*^9, 
   3.685254311864324*^9, 3.685257675093143*^9, 3.685258587369828*^9, 
   3.685260223838388*^9, 3.685337932411088*^9, 3.685338473375404*^9, 
   3.685343259524251*^9, 3.6853439524510183`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRVtest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rvsys1", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
       RowBox[{
        RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
       RowBox[{"q", "\[Rule]", "qs"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", 
         RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "zs1"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", 
         RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "zs2"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", 
         RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "zs1"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", 
         RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "zs2"}]}], "}"}]}], "/.", 
    
    RowBox[{"ans", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mum", ",", "mua"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ds", ",", "ks"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s1", ",", "s2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zs1", ",", "zs2"}], "}"}], ",", 
      RowBox[{"{", "qs", "}"}]}], "]"}]}], "/.", "rvinittest"}]}]], "Input",
 CellChangeTimes->{{3.683218665145975*^9, 3.683218751018755*^9}, {
  3.683218834916465*^9, 3.683218865201235*^9}, {3.685192934094782*^9, 
  3.685192948044446*^9}, {3.6851929921427317`*^9, 3.685193023237453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRV", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"rvsys1", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
        RowBox[{
         RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
        RowBox[{"d", "\[Rule]", "ds"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
        RowBox[{"q", "\[Rule]", "qs"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "zs2"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "zs2"}]}], "}"}]}], "/.", 
     RowBox[{"ans", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mum", ",", "mua"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ds", ",", "ks"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "s2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zs1", ",", "zs2"}], "}"}], ",", 
       RowBox[{"{", "qs", "}"}]}], "]"}]}], ",", "rvinit"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.683218665145975*^9, 3.683218751018755*^9}, {
   3.685076741218316*^9, 3.6850767416128807`*^9}, 3.685077402475966*^9, {
   3.685192938956091*^9, 3.6851929539738503`*^9}, {3.6851929948325367`*^9, 
   3.685193020365487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRValt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"rvsys2", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
        RowBox[{
         RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
        RowBox[{"d", "\[Rule]", "ds"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q", "\[Rule]", "qs"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "zs2"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "zs2"}]}], "}"}]}], "/.", 
     RowBox[{"ans", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mum", ",", "mua"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ds", ",", "ks"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "s2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zs1", ",", "zs2"}], "}"}], ",", 
       RowBox[{"{", "qs", "}"}]}], "]"}]}], ",", "rvinit"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.683218665145975*^9, 3.683218751018755*^9}, {
   3.683218786439576*^9, 3.6832187887255096`*^9}, 3.68507648246799*^9, {
   3.685076592500215*^9, 3.6850766026439447`*^9}, {3.685076677377842*^9, 
   3.6850767271296663`*^9}, {3.68507738773538*^9, 3.685077388494813*^9}, {
   3.685192942331367*^9, 3.685192957668849*^9}, {3.685192997239044*^9, 
   3.685193017548779*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansRVtest", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9", ",", "1.1"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.683218873277813*^9, 3.683218873656055*^9}, {
  3.685192960640976*^9, 3.6851929636481857`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "True", ",", "False", ",", "False", ",", "False", ",", "False", ",", 
   "False", ",", "False", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{
  3.683218874144144*^9, 3.6832190364721212`*^9, 3.6832201209993773`*^9, 
   3.683220178615947*^9, 3.683220619725257*^9, 3.6832206917760878`*^9, 
   3.683221739749207*^9, 3.6832272194343576`*^9, 3.683227253769411*^9, 
   3.684999304408547*^9, {3.685007561018939*^9, 3.68500758071023*^9}, 
   3.685008324387042*^9, 3.685008495881473*^9, 3.685009968800858*^9, 
   3.685011904704999*^9, 3.685012148679532*^9, 3.685012778113874*^9, 
   3.685012968874452*^9, 3.685013034312097*^9, 3.685013128611377*^9, 
   3.6850132459447393`*^9, 3.6850136012621803`*^9, 3.685013683781107*^9, 
   3.685013776661097*^9, 3.6850748810553713`*^9, 3.685075737112479*^9, 
   3.685075869984694*^9, 3.685075980593357*^9, 3.685076067079996*^9, 
   3.685076250374567*^9, 3.685076350856353*^9, 3.685076432591117*^9, 
   3.685076814663559*^9, 3.685076899523671*^9, 3.685077301002405*^9, 
   3.685077357505937*^9, 3.6850774134127283`*^9, 3.685086648278191*^9, 
   3.685092454086556*^9, 3.6850929166298447`*^9, 3.685092960349992*^9, 
   3.6850934146869*^9, 3.685094211870625*^9, 3.6850949649554863`*^9, 
   3.685095987535314*^9, 3.6850960275877943`*^9, 3.68509626129453*^9, 
   3.685099457253635*^9, 3.685104649450333*^9, 3.685104835686841*^9, 
   3.68510499445448*^9, 3.685106504790185*^9, {3.685192975810932*^9, 
   3.685193025873804*^9}, 3.6851932597601013`*^9, 3.6851956026002502`*^9, 
   3.6852047277051363`*^9, 3.685204762391345*^9, 3.6852055041571417`*^9, {
   3.685212299477137*^9, 3.685212323332427*^9}, 3.685251042425282*^9, 
   3.68525177259466*^9, 3.68525184951694*^9, 3.685253731585734*^9, 
   3.685253973773798*^9, 3.6852540922241077`*^9, 3.685254171990487*^9, 
   3.685254311910521*^9, 3.6852576751376266`*^9, 3.6852585874327087`*^9, 
   3.685260223909561*^9, 3.68533793246581*^9, 3.685338473433188*^9, 
   3.68534325967586*^9, 3.685343952519177*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ansRV", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ansRValt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ3TL/yRq9wteODr4SG0D0T0GhJH0gre5jnwqiK33t
5QyA9L6oJQog+vMukwMg2kYuFUxnzLt8D0SzhS24D6Inqd7fawikj1tlHQfR
p58dvQOir9sn3QfRYbXzLYyAtJzJWTD9tcTzPIj+lV8Jpnt+ZTBNLXntGNBj
wAmiZeUETUA0t/knOxCdXGfwDkQ3Ok4C078M42OnAenOoI9xIDrpxJzFIHrV
o7NgWtB1su5sIJ0V+QlMG5VbTtgJpB//uQSmd0w4vX0fkN4kx7kDRHM8W7Pg
E5D+eyZ6IYhO2724Qqj0teMeMckaEA0A09Gaug==
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "0.9818757174226221`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "1.0762360833936282`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m", ",", "a"}], "]"}], "\[Rule]", 
    "0.848367106656389`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "0.933168773646128`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "1.049703683836784`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "1.1979948667434086`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m", ",", "a"}], "]"}], "\[Rule]", 
    "0.7758884546716867`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "0.9111531702929461`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.683218820594281*^9, 3.683219036538414*^9, 3.6832201210484467`*^9, 
   3.683220178660267*^9, {3.683220243331518*^9, 3.68322026642449*^9}, 
   3.6832206197784853`*^9, 3.6832206918673563`*^9, {3.68322173979817*^9, 
   3.683221765871894*^9}, 3.683223044105772*^9, 3.683223293554968*^9, {
   3.683225075516869*^9, 3.683225147727189*^9}, {3.683225306508679*^9, 
   3.6832253405572767`*^9}, 3.6832260550052843`*^9, 3.683227219481246*^9, {
   3.683227253815124*^9, 3.683227260441658*^9}, 3.684999304466107*^9, {
   3.685001239520643*^9, 3.685001289913117*^9}, {3.685001636255218*^9, 
   3.6850016898553534`*^9}, 3.685001720077265*^9, 3.685003125687276*^9, {
   3.6850040125683928`*^9, 3.685004024006283*^9}, 3.685004574915371*^9, {
   3.6850075610787354`*^9, 3.6850075807699127`*^9}, 3.685008324460988*^9, 
   3.685008495957425*^9, 3.685009968877183*^9, 3.685011904769116*^9, 
   3.685012148764875*^9, 3.685012778238905*^9, 3.6850129689468946`*^9, 
   3.685013034369719*^9, 3.6850131286783133`*^9, 3.685013245999984*^9, 
   3.6850136013315697`*^9, 3.685013683844363*^9, 3.685013776743338*^9, 
   3.685013872164398*^9, 3.6850748811368*^9, 3.68507573721169*^9, 
   3.685075870052024*^9, 3.6850759806634417`*^9, 3.685076067161109*^9, 
   3.685076103168672*^9, 3.6850762504763403`*^9, 3.685076350932088*^9, 
   3.685076432671363*^9, {3.68507673274279*^9, 3.6850767463019037`*^9}, 
   3.68507681473674*^9, 3.685076899593635*^9, 3.685077301071898*^9, 
   3.685077357759632*^9, 3.6850774134896383`*^9, {3.6850866483626957`*^9, 
   3.685086656842175*^9}, 3.685092454134088*^9, 3.6850929166825953`*^9, 
   3.685092960422985*^9, 3.6850934147612963`*^9, 3.6850942119239273`*^9, 
   3.685094965012038*^9, 3.685095987587926*^9, 3.68509602763247*^9, 
   3.6850962613393717`*^9, 3.6850994573073063`*^9, 3.685104649496861*^9, 
   3.685104835720983*^9, 3.6851049944884977`*^9, 3.685106504820263*^9, {
   3.68519297599457*^9, 3.685193025948532*^9}, 3.685193259790923*^9, 
   3.685195602667428*^9, 3.685204727742465*^9, 3.6852047624324093`*^9, 
   3.685205504187049*^9, {3.685212299509021*^9, 3.6852123233620234`*^9}, 
   3.685251042472403*^9, 3.685251772625948*^9, 3.685251849552183*^9, 
   3.6852537316183662`*^9, 3.685253973811075*^9, 3.6852540923092117`*^9, 
   3.6852541720150423`*^9, 3.685254311953022*^9, 3.685257675170349*^9, 
   3.685258231739135*^9, 3.685258587482432*^9, 3.685260223981599*^9, 
   3.685337932509852*^9, 3.685338473481996*^9, 3.685343259727502*^9, 
   3.685343952569127*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "1.0923692188220029`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "1.1644365535007482`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m", ",", "a"}], "]"}], "\[Rule]", 
    "0.817765083135168`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "0.8837491051942823`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a", ",", "a"}], "]"}], "\[Rule]", 
    "1.0688112730520272`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a", ",", "m"}], "]"}], "\[Rule]", 
    "1.1257081618536686`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m", ",", "a"}], "]"}], "\[Rule]", 
    "0.8679254998977238`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}], "\[Rule]", 
    "0.9198825762777785`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.683218820594281*^9, 3.683219036538414*^9, 3.6832201210484467`*^9, 
   3.683220178660267*^9, {3.683220243331518*^9, 3.68322026642449*^9}, 
   3.6832206197784853`*^9, 3.6832206918673563`*^9, {3.68322173979817*^9, 
   3.683221765871894*^9}, 3.683223044105772*^9, 3.683223293554968*^9, {
   3.683225075516869*^9, 3.683225147727189*^9}, {3.683225306508679*^9, 
   3.6832253405572767`*^9}, 3.6832260550052843`*^9, 3.683227219481246*^9, {
   3.683227253815124*^9, 3.683227260441658*^9}, 3.684999304466107*^9, {
   3.685001239520643*^9, 3.685001289913117*^9}, {3.685001636255218*^9, 
   3.6850016898553534`*^9}, 3.685001720077265*^9, 3.685003125687276*^9, {
   3.6850040125683928`*^9, 3.685004024006283*^9}, 3.685004574915371*^9, {
   3.6850075610787354`*^9, 3.6850075807699127`*^9}, 3.685008324460988*^9, 
   3.685008495957425*^9, 3.685009968877183*^9, 3.685011904769116*^9, 
   3.685012148764875*^9, 3.685012778238905*^9, 3.6850129689468946`*^9, 
   3.685013034369719*^9, 3.6850131286783133`*^9, 3.685013245999984*^9, 
   3.6850136013315697`*^9, 3.685013683844363*^9, 3.685013776743338*^9, 
   3.685013872164398*^9, 3.6850748811368*^9, 3.68507573721169*^9, 
   3.685075870052024*^9, 3.6850759806634417`*^9, 3.685076067161109*^9, 
   3.685076103168672*^9, 3.6850762504763403`*^9, 3.685076350932088*^9, 
   3.685076432671363*^9, {3.68507673274279*^9, 3.6850767463019037`*^9}, 
   3.68507681473674*^9, 3.685076899593635*^9, 3.685077301071898*^9, 
   3.685077357759632*^9, 3.6850774134896383`*^9, {3.6850866483626957`*^9, 
   3.685086656842175*^9}, 3.685092454134088*^9, 3.6850929166825953`*^9, 
   3.685092960422985*^9, 3.6850934147612963`*^9, 3.6850942119239273`*^9, 
   3.685094965012038*^9, 3.685095987587926*^9, 3.68509602763247*^9, 
   3.6850962613393717`*^9, 3.6850994573073063`*^9, 3.685104649496861*^9, 
   3.685104835720983*^9, 3.6851049944884977`*^9, 3.685106504820263*^9, {
   3.68519297599457*^9, 3.685193025948532*^9}, 3.685193259790923*^9, 
   3.685195602667428*^9, 3.685204727742465*^9, 3.6852047624324093`*^9, 
   3.685205504187049*^9, {3.685212299509021*^9, 3.6852123233620234`*^9}, 
   3.685251042472403*^9, 3.685251772625948*^9, 3.685251849552183*^9, 
   3.6852537316183662`*^9, 3.685253973811075*^9, 3.6852540923092117`*^9, 
   3.6852541720150423`*^9, 3.685254311953022*^9, 3.685257675170349*^9, 
   3.685258231739135*^9, 3.685258587482432*^9, 3.685260223981599*^9, 
   3.685337932509852*^9, 3.685338473481996*^9, 3.685343259727502*^9, 
   3.685343952607579*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export reproductive value equations to C\
\>", "Subsection",
 CellChangeTimes->{{3.685194333961053*^9, 3.685194337792637*^9}, {
  3.685203438213744*^9, 3.685203466531927*^9}, {3.685204183114839*^9, 
  3.6852042030657663`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvsysRHS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "+", 
          RowBox[{"eul", " ", "*", " ", 
           RowBox[{"dvaadt", "[", "ei", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
          RowBox[{"eul", " ", "*", " ", 
           RowBox[{"dvamdt", "[", "ei", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "+", 
          RowBox[{"eul", "*", 
           RowBox[{"dvmadt", "[", "ei", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "+", 
          RowBox[{"eul", "*", 
           RowBox[{"dvmmdt", "[", "ei", "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "/.", 
     "subslist"}], "//", "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685195465240106*^9, 3.6851954823424053`*^9}, {
  3.685204130383412*^9, 3.6852041335421543`*^9}, {3.685204232937972*^9, 
  3.68520425585082*^9}, {3.6852043923670053`*^9, 3.68520440343507*^9}, {
  3.6852116911291113`*^9, 3.685211726420169*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvalstplus1", "=", 
   RowBox[{"rvals", "/.", 
    RowBox[{"v", "\[Rule]", "vtplus1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68525327207198*^9, 3.685253278023108*^9}}],

Cell[TextData[{
 "Add constraint to system of equations, by means of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["v", 
      RowBox[{"t", "+", "1"}]], "[", 
     RowBox[{"2", ",", "m", ",", "m"}], "]"}], "=", "something"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.685212120257264*^9, 3.685212149928454*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvsysRHS", "=", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"rvsysRHS", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "m", ",", "m"}], "]"}], "/.", 
           RowBox[{"Solve", "[", 
            RowBox[{"rvconstraint", ",", 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", "m"}], "]"}]}], "]"}]}], ")"}], "/.", 
         RowBox[{"v", "\[Rule]", "vtplus1"}]}], ")"}]}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685211821926579*^9, 3.68521184383467*^9}, {
   3.6852119148561153`*^9, 3.685212008292207*^9}, 3.6852121744269876`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"strRVfreq", "=", 
   RowBox[{"recur2c", "[", 
    RowBox[{
    "rvalstplus1", ",", "rvsysRHS", ",", "rvals", ",", "bound0", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685211341946301*^9, 3.6852113832257557`*^9}, {
  3.6852116733493423`*^9, 3.685211676722521*^9}, {3.685211752090807*^9, 
  3.6852117528969297`*^9}, {3.685211858148755*^9, 3.6852118667302027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"cdir", "<>", "\"\<repvals.txt\>\""}], ",", "strRVfreq"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685203492229539*^9, 3.685203532381892*^9}, 
   3.685203673044236*^9, 3.68520402268504*^9, 3.685204062963731*^9, {
   3.6852047183459063`*^9, 3.685204723492091*^9}, 3.6852123650785437`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness", "Section",
 CellChangeTimes->{{3.683226072084312*^9, 3.6832260732677393`*^9}}],

Cell[CellGroupData[{

Cell["Relatedness between two adapted breeders in environment ei", \
"Subsection",
 CellChangeTimes->{{3.6832263374238577`*^9, 3.683226346135641*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.6832263306240892`*^9, 3.683226332943756*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"draadt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", "m", ",", "m"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m"}], "]"}]}], "]"}], 
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"rmm", "[", 
    RowBox[{"3", "-", "ei"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"draadt1dn", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", "m", ",", "m"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m"}], "]"}]}], "]"}], 
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6832261582550077`*^9, 3.683226162827078*^9}, {
  3.6832262684360447`*^9, 3.68322632821279*^9}, {3.683226847788888*^9, 
  3.683226854548562*^9}, {3.685098248886106*^9, 3.685098262182289*^9}, {
  3.685193079370141*^9, 3.68519308943296*^9}}],

Cell["\<\
Mortality adapted breeder on aa patch, replaced by adapted individual\
\>", "Text",
 CellChangeTimes->{{3.6832263495739717`*^9, 3.6832263569263363`*^9}, {
  3.685098517702417*^9, 3.685098522229147*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"draadt2", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "a"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", "2", "]"}]}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"raa", "[", "ei", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"draadt2dn", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "a"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6832263579048767`*^9, 3.683226379255753*^9}, {
   3.683226816326398*^9, 3.683226870143228*^9}, {3.683226921548278*^9, 
   3.6832269308218307`*^9}, 3.683226967103812*^9, 3.683227162240233*^9, {
   3.685090823416366*^9, 3.685090826801281*^9}, {3.6850982841999903`*^9, 
   3.6850983315850267`*^9}, 3.6850985102130203`*^9, {3.685098554721959*^9, 
   3.685098587960403*^9}}],

Cell["\<\
Mortality maladapted breeder on a am patch, replaced by an adapted one\
\>", "Text",
 CellChangeTimes->{{3.683226873229813*^9, 3.683226885157148*^9}, {
  3.6832271433886547`*^9, 3.683227147601173*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"draadt3", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"p", "[", "1", "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"p", "[", "2", "]"}], 
       RowBox[{"ram", "[", "ei", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", "2", "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", "1", "]"}]}], ")"}], 
       RowBox[{"ram", "[", "ei", "]"}]}]}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"draadt3dn", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.683226886366371*^9, 3.683227031097077*^9}, {
  3.685089557670961*^9, 3.685089557764073*^9}, {3.68509859470424*^9, 
  3.685098612263892*^9}, {3.685098669144052*^9, 3.6850986810473948`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"draadt", "[", "ei_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"draadt1", "[", "ei", "]"}], "+", 
    RowBox[{"draadt2", "[", "ei", "]"}], "+", 
    RowBox[{"draadt3", "[", "ei", "]"}]}], 
   RowBox[{
    RowBox[{"draadt1dn", "[", "ei", "]"}], "+", 
    RowBox[{"draadt2dn", "[", "ei", "]"}], "+", 
    RowBox[{"draadt3dn", "[", "ei", "]"}]}]]}]], "Input",
 CellChangeTimes->{{3.685089885269858*^9, 3.685089912820859*^9}, {
  3.685098704945978*^9, 3.685098727658578*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between adapted and maladapted breeder in environment ei\
\>", "Subsection",
 CellChangeTimes->{{3.685089922087837*^9, 3.685089933927652*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.685089996646222*^9, 3.6850899985026617`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dramdt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", "a", ",", "m"}], "]"}], 
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{
         RowBox[{"3", "-", "ei"}], ",", "m"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{
         RowBox[{"3", "-", "ei"}], ",", "a"}], "]"}]}], ")"}]}], "]"}], 
   RowBox[{"ram", "[", 
    RowBox[{"3", "-", "ei"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dramdt1dn", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", "a", ",", "m"}], "]"}], 
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{
         RowBox[{"3", "-", "ei"}], ",", "m"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{
         RowBox[{"3", "-", "ei"}], ",", "a"}], "]"}]}], ")"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.685089934993133*^9, 3.685089982936509*^9}, {
  3.685096249234209*^9, 3.6850962510988398`*^9}, {3.685098738011876*^9, 
  3.685098752679182*^9}, {3.685099114024028*^9, 3.6850991164464827`*^9}, {
  3.685193095429319*^9, 3.685193103612153*^9}}],

Cell["\<\
Mortality maladapted breeder on mm patch, replaced by adapted breeder\
\>", "Text",
 CellChangeTimes->{{3.685090001966022*^9, 3.685090009717272*^9}, {
  3.6850900801327887`*^9, 3.685090087171279*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dramdt2", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", "1", "]"}]}], ")"}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"rmm", "[", "ei", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dramdt2dn", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.685089985071661*^9, 3.6850899936494904`*^9}, {
  3.6850900547451887`*^9, 3.6850901519150047`*^9}, {3.6850907620697308`*^9, 
  3.68509081803652*^9}, {3.6850909179049473`*^9, 3.685090922982024*^9}, {
  3.685090977740945*^9, 3.6850909778172398`*^9}, {3.68509875776523*^9, 
  3.68509878844495*^9}}],

Cell["\<\
Mortality adapted breeder on aa patch, replaced by maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.68509080476338*^9, 3.685090811796315*^9}, {
  3.6850909859687366`*^9, 3.68509099029506*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dramdt3", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", " ", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "a"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", "1", "]"}]}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"raa", "[", "ei", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dramdt3dn", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", " ", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "a"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.685090932465214*^9, 3.685091014313404*^9}, {
  3.685098806451458*^9, 3.68509883276348*^9}, {3.685099621846566*^9, 
  3.6850996219343767`*^9}}],

Cell["\<\
Mortality maladapted breeder on am patch, replaced by maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.685091028166535*^9, 3.685091040605706*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dramdt4", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", "1", "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", "2", "]"}]}], ")"}], 
       RowBox[{"ram", "[", "ei", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"p", "[", "1", "]"}], 
       RowBox[{"ram", "[", "ei", "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"p", "[", "2", "]"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dramdt4dn", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.685091042465046*^9, 3.685091158952574*^9}, {
  3.6850988384220467`*^9, 3.685098855930152*^9}}],

Cell["\<\
Mortality adapted breeder on am patch, replaced by adapted breeder\
\>", "Text",
 CellChangeTimes->{{3.685091165883857*^9, 3.685091170194736*^9}, {
  3.68509127801775*^9, 3.685091286416214*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dramdt5", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"p", "[", "1", "]"}], 
       RowBox[{"ram", "[", "ei", "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"p", "[", "2", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", "1", "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", "2", "]"}]}], ")"}], 
       RowBox[{"ram", "[", "ei", "]"}]}]}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dramdt5dn", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"pa", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.685091287679926*^9, 3.6850913668868923`*^9}, {
  3.685098859038303*^9, 3.685098874761587*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dramdt", "[", "ei_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"dramdt1", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt2", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt3", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt4", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt5", "[", "ei", "]"}]}], 
   RowBox[{
    RowBox[{"dramdt1dn", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt2dn", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt3dn", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt4dn", "[", "ei", "]"}], "+", 
    RowBox[{"dramdt5dn", "[", "ei", "]"}]}]]}]], "Input",
 CellChangeTimes->{{3.6850913966211987`*^9, 3.685091430427689*^9}, {
  3.685098879759472*^9, 3.685098903543779*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between maladapted breeders in environment ei", "Subsection",
 CellChangeTimes->{{3.685091651384255*^9, 3.685091662719458*^9}}],

Cell["Environmental change ", "Text",
 CellChangeTimes->{{3.685091672735778*^9, 3.685091675151469*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"drmmdt1", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", "a", ",", "a"}], "]"}], 
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a"}], "]"}]}], "]"}], 
   RowBox[{"raa", "[", 
    RowBox[{"3", "-", "ei"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drmmdt1dn", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"3", "-", "ei"}], ",", "a", ",", "a"}], "]"}], 
   RowBox[{"s", "[", 
    RowBox[{"3", "-", "ei"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a"}], "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.685091690650779*^9, 3.68509172666856*^9}, {
  3.685096239561246*^9, 3.6850962425777607`*^9}, {3.68509891406322*^9, 
  3.6850989257109413`*^9}, {3.6851931172564096`*^9, 3.685193126655311*^9}}],

Cell["\<\
Mortality adapted breeder on a am patch, replaced by maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.685091732470581*^9, 3.6850917692082443`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"drmmdt2", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", "1", "]"}]}], ")"}], 
       RowBox[{"ram", "[", "ei", "]"}]}], "+", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"p", "[", "2", "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "+", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], 
       RowBox[{"ram", "[", "ei", "]"}]}]}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drmmdt2dn", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.685091770257729*^9, 3.685091774744981*^9}, {
  3.6850919273919287`*^9, 3.685091969155692*^9}, {3.6850921769791603`*^9, 
  3.685092231617579*^9}, {3.685094944637187*^9, 3.685094946745343*^9}, {
  3.685098931338243*^9, 3.685098966113645*^9}}],

Cell["\<\
Mortality maladapted breeder on a mm patch, replaced by maladapted breeder\
\>", "Text",
 CellChangeTimes->{{3.68509223449899*^9, 3.6850922827052526`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"drmmdt3", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", "2", "]"}]}], ")"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"rmm", "[", "ei", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drmmdt3dn", "[", "ei_", "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"f", "[", 
    RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"pa", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.685092284100492*^9, 3.685092362495736*^9}, 
   3.685094185621488*^9, {3.6850989712965927`*^9, 3.685098981708987*^9}, {
   3.6850990164261017`*^9, 3.685099019886153*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drmmdt", "[", "ei_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"drmmdt1", "[", "ei", "]"}], "+", 
    RowBox[{"drmmdt2", "[", "ei", "]"}], "+", 
    RowBox[{"drmmdt3", "[", "ei", "]"}]}], 
   RowBox[{
    RowBox[{"drmmdt1dn", "[", "ei", "]"}], "+", 
    RowBox[{"drmmdt2dn", "[", "ei", "]"}], "+", 
    RowBox[{"drmmdt3dn", "[", "ei", "]"}]}]]}]], "Input",
 CellChangeTimes->{{3.6850923895306797`*^9, 3.685092389706258*^9}, {
  3.685092427104746*^9, 3.685092450338788*^9}, {3.685099031930873*^9, 
  3.685099058297925*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical solutions", "Subsection",
 CellChangeTimes->{{3.685204798302215*^9, 3.685204800036888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"relsys", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"draadt", "[", "ei", "]"}], "\[Equal]", 
         RowBox[{"raa", "[", "ei", "]"}]}], ",", 
        RowBox[{
         RowBox[{"dramdt", "[", "ei", "]"}], "\[Equal]", 
         RowBox[{"ram", "[", "ei", "]"}]}], ",", 
        RowBox[{
         RowBox[{"drmmdt", "[", "ei", "]"}], "\[Equal]", 
         RowBox[{"rmm", "[", "ei", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6850926359834538`*^9, 3.685092668024541*^9}, {
  3.685092742056924*^9, 3.685092743292324*^9}, {3.6850929459744053`*^9, 
  3.685092956339739*^9}, {3.685099076227552*^9, 3.685099078977872*^9}, {
  3.6852048384139137`*^9, 3.685204839188608*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansrel", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"relsys", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
        RowBox[{
         RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
        RowBox[{"d", "\[Rule]", "ds"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
        RowBox[{
         RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
        RowBox[{"q", "\[Rule]", "qs"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "zs2"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "zs1"}], ",", 
        RowBox[{
         RowBox[{"zs", "[", 
          RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "zs2"}]}], "}"}]}], "/.", 
     RowBox[{"ans", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mum", ",", "mua"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ds", ",", "ks"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "s2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zs1", ",", "zs2"}], "}"}], ",", 
       RowBox[{"{", "qs", "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rmm", "[", "1", "]"}], ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rmm", "[", "2", "]"}], ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ram", "[", "1", "]"}], ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ram", "[", "2", "]"}], ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"raa", "[", "1", "]"}], ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"raa", "[", "2", "]"}], ",", "0.1"}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685092747142345*^9, 3.685092767098814*^9}, {
  3.685092869369681*^9, 3.685092907163373*^9}, {3.685193133105699*^9, 
  3.685193145389797*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansrel", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6850929707350483`*^9, 3.685092987561624*^9}, {
  3.685093328974547*^9, 3.685093330794835*^9}, {3.685193146739462*^9, 
  3.685193173868232*^9}, {3.685258494911068*^9, 3.68525850643071*^9}, {
  3.6852601589722223`*^9, 3.685260212383935*^9}, {3.685339257582838*^9, 
  3.685339259715015*^9}, {3.685343017407527*^9, 3.685343027230089*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"rmm", "[", "1", "]"}], "\[Rule]", "0.6805518546696181`"}], ",", 
   RowBox[{
    RowBox[{"rmm", "[", "2", "]"}], "\[Rule]", "0.7159663212515974`"}], ",", 
   RowBox[{
    RowBox[{"ram", "[", "1", "]"}], "\[Rule]", "0.6355938214822638`"}], ",", 
   RowBox[{
    RowBox[{"ram", "[", "2", "]"}], "\[Rule]", "0.6374305716641848`"}], ",", 
   RowBox[{
    RowBox[{"raa", "[", "1", "]"}], "\[Rule]", "0.7127540405843871`"}], ",", 
   RowBox[{
    RowBox[{"raa", "[", "2", "]"}], "\[Rule]", "0.6790985337136375`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.685092987930316*^9, 3.685093415247221*^9, 3.685093608148032*^9, 
   3.685094212309642*^9, 3.685094965536878*^9, 3.6850959877808847`*^9, 
   3.685096027978581*^9, 3.685096261765202*^9, {3.6850990904019547`*^9, 
   3.685099120204673*^9}, 3.685099457624255*^9, 3.685099640154479*^9, 
   3.685104649663999*^9, 3.685104835853153*^9, 3.685104994621853*^9, 
   3.685106504922574*^9, {3.6851931525827103`*^9, 3.685193174371293*^9}, 
   3.685193259914027*^9, 3.6852051763521833`*^9, 3.685205504351398*^9, 
   3.6852510427843*^9, 3.685251772889065*^9, 3.685251849846429*^9, 
   3.6852537317745743`*^9, 3.685253974060173*^9, 3.6852540927045593`*^9, 
   3.6852541721340313`*^9, 3.685254312240426*^9, 3.685257675443727*^9, 
   3.685258524085251*^9, 3.6852585877240953`*^9, 3.685258655104761*^9, 
   3.685258939735718*^9, {3.685260163128764*^9, 3.685260224257094*^9}, 
   3.6853379327135344`*^9, 3.6853384737273207`*^9, 3.68533926004361*^9, 
   3.685343028107081*^9, 3.685343259915612*^9, 3.6853439528099527`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterate", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ds_", ",", "ks_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "qs_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "iter", ",", "tend", ",", "eqns", ",", "valtplus1"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tend", "=", "1000"}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "tend"}], "]"}], ",", "6"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0.1", ",", "6"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"drmmdt", "[", "1", "]"}], ",", 
          RowBox[{"dramdt", "[", "1", "]"}], ",", 
          RowBox[{"draadt", "[", "1", "]"}], ",", 
          RowBox[{"drmmdt", "[", "2", "]"}], ",", 
          RowBox[{"dramdt", "[", "2", "]"}], ",", 
          RowBox[{"draadt", "[", "2", "]"}]}], "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
          RowBox[{
           RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
          RowBox[{"d", "\[Rule]", "ds"}], ",", 
          RowBox[{"k", "\[Rule]", "ks"}], ",", 
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
          RowBox[{
           RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
          RowBox[{"q", "\[Rule]", "qs"}], ",", 
          RowBox[{
           RowBox[{"zs", "[", 
            RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "zs1"}], ",", 
          RowBox[{
           RowBox[{"zs", "[", 
            RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "zs2"}], ",", 
          RowBox[{
           RowBox[{"zs", "[", 
            RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "zs1"}], ",", 
          RowBox[{
           RowBox[{"zs", "[", 
            RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "zs2"}], ",", 
          RowBox[{"eul", "\[Rule]", "0.01"}]}], "}"}]}], "/.", 
       RowBox[{"ans", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mum", ",", "mua"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ds", ",", "ks"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s1", ",", "s2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"zs1", ",", "zs2"}], "}"}], ",", 
         RowBox[{"{", "qs", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "2"}], ",", 
       RowBox[{"iter", "\[LessEqual]", "tend"}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"valtplus1", "=", 
         RowBox[{"eqns", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"rmm", "[", "1", "]"}], "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"iter", "-", "1"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"ram", "[", "1", "]"}], "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"iter", "-", "1"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"raa", "[", "1", "]"}], "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", 
                RowBox[{"iter", "-", "1"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"rmm", "[", "2", "]"}], "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", 
                RowBox[{"iter", "-", "1"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"ram", "[", "2", "]"}], "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", 
                RowBox[{"iter", "-", "1"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"raa", "[", "2", "]"}], "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"6", ",", 
                RowBox[{"iter", "-", "1"}]}], "]"}], "]"}]}]}], "}"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "iter"}], "]"}], "]"}], "=", "valtplus1"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "data", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6853393286196127`*^9, 3.685339430155675*^9}, {
   3.685339801946978*^9, 3.6853398654116783`*^9}, {3.68533989595795*^9, 
   3.685339910380239*^9}, {3.685339944339469*^9, 3.685340058172694*^9}, {
   3.6853420420251827`*^9, 3.685342050335567*^9}, {3.685342139459573*^9, 
   3.685342141731482*^9}, {3.685342182348106*^9, 3.685342263697603*^9}, {
   3.685342350497631*^9, 3.68534257811666*^9}, {3.685342627741596*^9, 
   3.6853426663158693`*^9}, {3.6853427545024548`*^9, 3.6853427553440113`*^9}, 
   3.6853429923301*^9, {3.685343083074415*^9, 3.685343174818591*^9}, {
   3.685343243113549*^9, 3.685343247761511*^9}, {3.685343290103466*^9, 
   3.6853434692733593`*^9}, {3.685343508166279*^9, 3.685343597521884*^9}, {
   3.685343660642346*^9, 3.685343764023426*^9}, {3.68534380513021*^9, 
   3.685343878637858*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "out", "]"}]], "Input",
 CellChangeTimes->{{3.685343204733749*^9, 3.685343208340457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansrel", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.42", ",", "0.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.05"}], ",", "0.0418152"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.685342846266159*^9, 3.6853428615289183`*^9}, {
  3.685342919994781*^9, 3.68534292134759*^9}, {3.685342951720602*^9, 
  3.685342952493753*^9}, {3.685344231595797*^9, 3.6853442632414703`*^9}, {
  3.685344366160803*^9, 3.685344386524284*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"rmm", "[", "1", "]"}], "\[Rule]", "0.25`"}], ",", 
   RowBox[{
    RowBox[{"rmm", "[", "2", "]"}], "\[Rule]", "1.0000000000000009`"}], ",", 
   RowBox[{
    RowBox[{"ram", "[", "1", "]"}], "\[Rule]", "0.11959581338871376`"}], ",", 
   
   RowBox[{
    RowBox[{"ram", "[", "2", "]"}], "\[Rule]", "0.14258088209345238`"}], ",", 
   
   RowBox[{
    RowBox[{"raa", "[", "1", "]"}], "\[Rule]", "0.9999999999999996`"}], ",", 
   RowBox[{
    RowBox[{"raa", "[", "2", "]"}], "\[Rule]", "0.2500000000000001`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6853428466408653`*^9, 3.685342862368379*^9}, 
   3.685342921710594*^9, 3.685342952902536*^9, 3.685342994085865*^9, 
   3.685343084979506*^9, {3.685343143378738*^9, 3.685343176465404*^9}, 
   3.68534320957588*^9, 3.6853432622627087`*^9, {3.685343303703109*^9, 
   3.685343358645639*^9}, {3.685343428907836*^9, 3.685343471659*^9}, {
   3.685343515874008*^9, 3.685343562439826*^9}, 3.6853435995601387`*^9, {
   3.6853436781822567`*^9, 3.6853437081909103`*^9}, 3.685343767635582*^9, 
   3.685343952869279*^9, {3.685344239561555*^9, 3.685344263785284*^9}, {
   3.6853443668381367`*^9, 3.685344387389385*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"datax", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "2"}], "]"}], ",", "6"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685343621963573*^9, 3.6853436252930326`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"datax", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.685343626403981*^9, 3.6853436331997766`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.685343627550664*^9, 3.685343633598551*^9}, {
   3.6853436796857653`*^9, 3.68534370936375*^9}, 3.6853437690674763`*^9, 
   3.685343952913621*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"iterate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.42", ",", "0.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.05"}], ",", "0.0418152"}], "}"}], ",", 
     RowBox[{"{", "0.5", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685339381210638*^9, 3.685339381889451*^9}, {
   3.685339884015512*^9, 3.685339884421837*^9}, 3.685342670519112*^9, {
   3.685342866170848*^9, 3.685342883584831*^9}, {3.685342983080626*^9, 
   3.685342983182329*^9}, {3.685344292130466*^9, 3.6853443064899483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", 
    RowBox[{"Length", "[", "out", "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.685344079140101*^9, 3.685344085166245*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6630558163792115`", ",", "0.6175459464021105`", ",", 
   "0.6993579919423276`", ",", "0.7017627618746919`", ",", 
   "0.6217275058710847`", ",", "0.6663520804857588`"}], "}"}]], "Output",
 CellChangeTimes->{3.685344085548547*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"out", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"20", ";;", "40"}]}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6853393980755*^9, 3.685339400676148*^9}, {
  3.685339873116386*^9, 3.685339886593206*^9}, {3.6853399200036097`*^9, 
  3.685339920736581*^9}, {3.685342999178743*^9, 3.6853430022818317`*^9}, {
  3.685344319270338*^9, 3.685344343820549*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7OMMlG8Ghz61hwo4qD7fMzsEzudweHVy9y8E
X8BhrrW0ZiicL+KwL3afPYIv4bDG97QXgi/joORqEIDgKzjopV0KQvCVHD5W
SYcg+CoOS+X3IPHVHH51cYUi+BoOzy4ZIPG1HM42OSPxdRykFvkg8fUcJMUC
kfgGDtOdgpH4hg4OQSFIfCOHO9eQ+cYOM8RDkfgmDkbmyHxTh/luED4AySpU
yg==
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7O9mFJa/vHDFHirgIJ5o34jgczjUiem3IvgC
DqELD7ch+CIOT1nT2hF8CYc00+VIfBmHtfEHkfgKDq4PTiPxlRxyxC8g8VUc
Jpy4iMRXc8guu4TE13Aw2YPM13IwvYHM13EofozM13P49hyZb+Bw9CUy39Ch
/hUy38jhFArf2OE5Ct/E4QsK39ThJ5QPAPX5eJc=
     "]]}, 
   {Hue[0.1421359549995791, 0.6, 0.6], 
    LineBox[{{1., 0.9999999999695309}, {2., 0.9999999999914433}, {3., 
     0.9999999999975969}, {4., 0.9999999999993252}, {5., 
     0.9999999999998107}, {6., 0.9999999999999469}, {7., 
     0.9999999999999851}, {8., 0.9999999999999959}, {9., 
     0.9999999999999989}, {10., 0.9999999999999998}, {11., 1.}}]}, 
   {Hue[0.37820393249936934`, 0.6, 0.6], 
    LineBox[{{1., 0.9999999999706292}, {2., 0.999999999991752}, {3., 
     0.9999999999976841}, {4., 0.99999999999935}, {5., 0.9999999999998178}, {
     6., 0.9999999999999493}, {7., 0.9999999999999862}, {8., 
     0.9999999999999964}, {9., 0.9999999999999994}, {9.714285714285714, 
     1.}}]}, 
   {Hue[0.6142719099991583, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7H+wO8u45pywhwo4OFxWUEHwORySbTzVEXwB
h0X7ejUQfBGHXQwCmgi+hEOfpwsSX8aB0S0Sia/gkLIpEYmv5PBSOBWJr+Lg
n5+GxFdz2PcLma/hsNUoHYmv5aDticzXcdAPQubrOZwLReYbODiFI/MNHa6j
8I0chCOQ+cYO2ih8EwcTFL6pgwWUDwAIyUrY
     "]]}, 
   {Hue[0.8503398874989481, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7N1/vngfHPrUHirgkHPw1rIQOJ/DwZ1ZkyEU
zhdwmJJyUBvBF3Gwz+J0RPAlHDxf5Hgj+DIOjRr1AQi+gsOWFz+CEHwlhzJ3
vRAEX8Xhtc9RJL6aw2lW/lAEX8NhF5MxEl/LQXyKCxJfx6FZ3ReJr+dgFR6I
xDdwSEkKRuIbOhxLDEHiGzkU3kPmGzv4SIci8U0cmCyR+aYOze4QPgBhaVJe

     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{0, 21.}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], Automatic}]], "Output",
 CellChangeTimes->{{3.685339400999349*^9, 3.68533941222363*^9}, {
   3.68533986209042*^9, 3.6853398870215693`*^9}, {3.685339917322517*^9, 
   3.685339921160513*^9}, 3.685342493611964*^9, {3.685342655252496*^9, 
   3.685342675867703*^9}, 3.6853427595960493`*^9, {3.68534287148421*^9, 
   3.685342886304716*^9}, {3.685342996745088*^9, 3.685343002697628*^9}, 
   3.6853432772217093`*^9, {3.685343825546193*^9, 3.685343883142948*^9}, 
   3.685343953005444*^9, {3.685344308901114*^9, 3.6853443449929533`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export relatedness equations to C", "Subsection",
 CellChangeTimes->{{3.685194333961053*^9, 3.685194337792637*^9}, {
  3.685203438213744*^9, 3.685203466531927*^9}, {3.685204183114839*^9, 
  3.685204185013172*^9}, {3.685251412271525*^9, 3.685251438372085*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"relvals", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"raa", "[", "ei", "]"}], ",", 
        RowBox[{"ram", "[", "ei", "]"}], ",", 
        RowBox[{"rmm", "[", "ei", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relvalstplus1", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"raatplus1", "[", "ei", "]"}], ",", 
        RowBox[{"ramtplus1", "[", "ei", "]"}], ",", 
        RowBox[{"rmmtplus1", "[", "ei", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.685212650400878*^9, 3.6852126583226337`*^9}, {
   3.685213235903267*^9, 3.685213243783313*^9}, {3.685213550514761*^9, 
   3.685213581096352*^9}, {3.685251432536742*^9, 3.685251433182921*^9}, 
   3.685254308157276*^9, {3.685258561103169*^9, 3.6852585766014977`*^9}, {
   3.685258622667613*^9, 3.685258627913665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"relRHS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"draadt", "[", "ei", "]"}], ",", 
         RowBox[{"dramdt", "[", "ei", "]"}], ",", 
         RowBox[{"drmmdt", "[", "ei", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], "/.", 
     "subslist"}], "//", "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685212665706449*^9, 3.685212716074629*^9}, {
  3.685212822871293*^9, 3.685212945561305*^9}, {3.685250975057384*^9, 
  3.6852510535103827`*^9}, {3.685258634790441*^9, 3.685258651571164*^9}, {
  3.685258931026114*^9, 3.685258936430332*^9}, {3.685338452629325*^9, 
  3.685338468288291*^9}, {3.685343920532147*^9, 3.685343938392309*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"strrel", "=", 
   RowBox[{"recur2c", "[", 
    RowBox[{
    "relvalstplus1", ",", "relRHS", ",", "relvals", ",", "bound01", ",", 
     "True"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6852129491915293`*^9, 3.685212972499621*^9}, {
  3.6852509483201838`*^9, 3.6852509583730173`*^9}, {3.68525105779468*^9, 
  3.685251058738039*^9}, {3.685251111458826*^9, 3.68525111249012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"cdir", "<>", "\"\<relvals.txt\>\""}], ",", "strrel"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685203492229539*^9, 3.685203532381892*^9}, 
   3.685203673044236*^9, 3.68520402268504*^9, 3.685204062963731*^9, {
   3.6852047183459063`*^9, 3.685204723492091*^9}, {3.685205154970559*^9, 
   3.685205172138235*^9}, {3.685251310814743*^9, 3.685251313963423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rmm", "[", "2", "]"}], "+", 
     RowBox[{"eul", " ", 
      RowBox[{"drmmdt", "[", "2", "]"}]}]}], "/.", "subslist"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"ram", "[", "2", "]"}], "\[Rule]", "0.1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "\[Rule]", "0.8"}], ",", 
     RowBox[{
      RowBox[{"rmm", "[", "1", "]"}], "\[Rule]", "0.1"}], ",", 
     RowBox[{
      RowBox[{"raa", "[", "2", "]"}], "\[Rule]", "0.1"}], ",", 
     RowBox[{"eul", "\[Rule]", "0.01"}], ",", 
     RowBox[{
      RowBox[{"raa", "[", "1", "]"}], "\[Rule]", "0.1"}], ",", 
     RowBox[{
      RowBox[{"ram", "[", "1", "]"}], "\[Rule]", "0.1"}], ",", 
     RowBox[{
      RowBox[{"rmm", "[", "2", "]"}], "\[Rule]", "0.1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], "\[Rule]", "0.3"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", "0.5"}], ",", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], "\[Rule]", "0.3"}], ",", 
     RowBox[{
      RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "2"}], ",", 
     RowBox[{"d", "\[Rule]", "0.2"}]}], "}"}]}], "/.", 
  RowBox[{"ans", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2.0", ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.2", ",", "0.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", "0.5", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6853387252280188`*^9, 3.685338737892887*^9}, {
  3.685338790557757*^9, 3.6853389747695007`*^9}, {3.6853390529546213`*^9, 
  3.6853390543351088`*^9}, {3.685339140521946*^9, 3.685339183824676*^9}}],

Cell[BoxData["0.10427444460810949`"], "Output",
 CellChangeTimes->{{3.6853388083581553`*^9, 3.6853388347387743`*^9}, {
   3.685338944121122*^9, 3.685338975073584*^9}, 3.685339055039781*^9, {
   3.685339147366062*^9, 3.685339184185502*^9}, 3.685343953105834*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection gradient p1, p2", "Section",
 CellChangeTimes->{{3.682844962098281*^9, 3.6828449638582706`*^9}, {
  3.685099872496736*^9, 3.685099875478538*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvals", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"ex", ",", "statex1", ",", "statex2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex1", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex2", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683200086190008*^9, 3.683200155658983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvalsTest", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "statex1", ",", "statex2"}], "]"}], "\[Rule]", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "statex1", ",", "statex2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"statex1", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex2", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6832001606051397`*^9, 3.683200179314473*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"dv", "[", 
    SubscriptBox["e", "i"]}], TraditionalForm]]],
 ",a,m]/d\[Delta]p"
}], "Subsection",
 CellChangeTimes->{{3.682845152607973*^9, 3.6828451899586554`*^9}, {
  3.683199373324525*^9, 3.683199405378907*^9}, {3.68509979054459*^9, 
  3.685099805196212*^9}, {3.6852052274422092`*^9, 3.685205230890399*^9}}],

Cell["Environmental change:", "Text",
 CellChangeTimes->{{3.682845239557769*^9, 3.6828452435668077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt1\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6828451992130203`*^9, 3.682845246071899*^9}, {
  3.683199347330213*^9, 3.68319940962227*^9}, {3.685099888146659*^9, 
  3.68509988919601*^9}, {3.685193183238106*^9, 3.685193186525836*^9}}],

Cell["Mortality of focal, replaced by her own maladapted offspring", "Text",
 CellChangeTimes->{{3.6828452501496277`*^9, 3.68284525658976*^9}, {
  3.682845329972937*^9, 3.682845331604385*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt2\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
        RowBox[{"\[Delta]p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
       RowBox[{"\[Delta]p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845258154578*^9, 3.682845356278455*^9}, {
   3.683199411005266*^9, 3.683199421837904*^9}, {3.683199452764576*^9, 
   3.68319951112311*^9}, 3.683227210190816*^9, {3.685099892127275*^9, 
   3.6850999220778933`*^9}}],

Cell["Mortality of focal, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68284535944386*^9, 3.682845365923882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt3\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845368271618*^9, 3.682845390486068*^9}, {
   3.683199514840802*^9, 3.683199523540876*^9}, 3.683227209011223*^9, {
   3.685099932084655*^9, 3.685099932817914*^9}}],

Cell["Mortality of nonfocal, replaced by focal's offspring", "Text",
 CellChangeTimes->{{3.682845393347591*^9, 3.682845405355267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt4\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
        RowBox[{"\[Delta]p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
          RowBox[{"\[Delta]p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "m", ",", "a"}], "]"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}], "]"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845406494494*^9, 3.6828454555095787`*^9}, {
   3.6831995261390457`*^9, 3.683199751862639*^9}, {3.6851000075329237`*^9, 
   3.6851000083426437`*^9}, {3.68510008674711*^9, 3.685100099681864*^9}, 
   3.68510013414925*^9}],

Cell["\<\
Mortality of nonfocal, replaced by nonfocal offspring of a different type \
than nonfocal\
\>", "Text",
 CellChangeTimes->{{3.682845472978017*^9, 3.6828454882093973`*^9}, {
  3.683199796656701*^9, 3.683199797376515*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt5\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"ram", "[", "ei", "]"}], 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], ")"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"ram", "[", "ei", "]"}], 
            RowBox[{"\[Delta]p", "[", 
             RowBox[{"phen", "[", 
              RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], ")"}]}]}], "]"}]}], 
     "+", 
     RowBox[{
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845489127758*^9, 3.682845652705119*^9}, {
   3.683199761631853*^9, 3.683199902715605*^9}, {3.683200116816619*^9, 
   3.683200118465126*^9}, {3.683200860421144*^9, 3.683200864659851*^9}, 
   3.6832189099756813`*^9, 3.683227206083026*^9, {3.68510026532806*^9, 
   3.685100289394421*^9}, {3.68510056693756*^9, 3.685100576394641*^9}}],

Cell["\<\
Mortality of individual in remote patch, replaced by focal's offspring\
\>", "Text",
 CellChangeTimes->{{3.682845684654298*^9, 3.682845694533659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt6\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682845654868635*^9, 3.682845679124524*^9}, {
   3.6831983981408043`*^9, 3.683198481007554*^9}, {3.683198569254446*^9, 
   3.683198631061006*^9}, {3.683198894243639*^9, 3.683199109099525*^9}, 
   3.68319934095358*^9, {3.683199926463127*^9, 3.683199981943626*^9}, {
   3.68320035894034*^9, 3.6832003611335793`*^9}, 3.683218944788011*^9, 
   3.683227204207383*^9, {3.6851005887706623`*^9, 3.685100641127967*^9}, {
   3.68510069960653*^9, 3.685100703478928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvamdt\[Delta]p", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvamdt1\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt2\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt3\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt4\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt5\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt6\[Delta]p", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683199311291834*^9, 3.683199335664133*^9}, {
  3.683200008076005*^9, 3.6832000770423727`*^9}, {3.683200190847007*^9, 
  3.683200245334814*^9}, {3.685103747530366*^9, 3.685103789406893*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"dv", "[", 
    SubscriptBox["e", "i"]}], TraditionalForm]]],
 ",m,a]/",
 "d\[Delta]p"
}], "Subsection",
 CellChangeTimes->{{3.682845152607973*^9, 3.6828451899586554`*^9}, {
  3.683199373324525*^9, 3.683199405378907*^9}, {3.683200341720703*^9, 
  3.683200352201293*^9}, {3.685103822521986*^9, 3.685103827806457*^9}, {
  3.685205215780604*^9, 3.685205234292453*^9}}],

Cell["Environmental change:", "Text",
 CellChangeTimes->{{3.682845239557769*^9, 3.6828452435668077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt1\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6828451992130203`*^9, 3.682845246071899*^9}, {
  3.683199347330213*^9, 3.68319940962227*^9}, {3.6832004127359333`*^9, 
  3.68320043309993*^9}, {3.68510386446531*^9, 3.6851038653904552`*^9}, {
  3.685193195174513*^9, 3.6851931979504833`*^9}}],

Cell["Mortality of focal, replaced by her own adapted offspring", "Text",
 CellChangeTimes->{{3.6828452501496277`*^9, 3.68284525658976*^9}, {
  3.682845329972937*^9, 3.682845331604385*^9}, {3.683200460076082*^9, 
  3.6832004609474897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt2\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
      RowBox[{"\[Delta]p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}], "-", 
      RowBox[{"\[Delta]p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845258154578*^9, 3.682845356278455*^9}, {
   3.683199411005266*^9, 3.683199421837904*^9}, {3.683199452764576*^9, 
   3.68319951112311*^9}, {3.6832004363552237`*^9, 3.683200472657877*^9}, {
   3.683200555700583*^9, 3.6832005768996687`*^9}, 3.683219505299831*^9, 
   3.683227201430964*^9, {3.6851038747967176`*^9, 3.6851039099299517`*^9}}],

Cell["Mortality of focal, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68284535944386*^9, 3.682845365923882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt3\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845368271618*^9, 3.682845390486068*^9}, {
   3.683199514840802*^9, 3.683199523540876*^9}, {3.68320058014487*^9, 
   3.683200589869781*^9}, 3.683227200189714*^9, {3.685104085495924*^9, 
   3.68510408668926*^9}}],

Cell["Mortality of nonfocal, replaced by focal's offspring", "Text",
 CellChangeTimes->{{3.682845393347591*^9, 3.682845405355267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt4\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
        RowBox[{"\[Delta]p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
          RowBox[{"\[Delta]p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], "]"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845406494494*^9, 3.6828454555095787`*^9}, {
   3.6831995261390457`*^9, 3.683199751862639*^9}, {3.6832005956307487`*^9, 
   3.683200742417244*^9}, {3.683200801830461*^9, 3.683200802245098*^9}, {
   3.685103952285736*^9, 3.68510397022288*^9}, 3.685104089978538*^9}],

Cell["\<\
Mortality of nonfocal adapted, replaced by nonfocal maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.682845472978017*^9, 3.6828454882093973`*^9}, {
  3.683199796656701*^9, 3.683199797376515*^9}, {3.683213694530525*^9, 
  3.683213700345112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt5\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"ram", "[", "ei", "]"}], " ", 
            RowBox[{"\[Delta]p", "[", 
             RowBox[{"phen", "[", 
              RowBox[{"ei", ",", "a"}], "]"}], "]"}]}]}], ")"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"ram", "[", "ei", "]"}], " ", 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}]}]}], ")"}]}], "]"}]}], 
     "+", 
     RowBox[{
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845489127758*^9, 3.682845652705119*^9}, {
   3.683199761631853*^9, 3.683199902715605*^9}, {3.683200116816619*^9, 
   3.683200118465126*^9}, {3.683200754640517*^9, 3.6832008538239202`*^9}, {
   3.6832008997121553`*^9, 3.683200902071858*^9}, 3.6832189925315723`*^9, {
   3.68321984562053*^9, 3.683219862401634*^9}, 3.6832271967477627`*^9, {
   3.6851039745740433`*^9, 3.6851040064771423`*^9}, 3.685104092123537*^9, {
   3.685105104042547*^9, 3.6851051093775063`*^9}}],

Cell["\<\
Mortality of individual in remote patch, replaced by focal's offspring\
\>", "Text",
 CellChangeTimes->{{3.682845684654298*^9, 3.682845694533659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt6\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682845654868635*^9, 3.682845679124524*^9}, {
   3.6831983981408043`*^9, 3.683198481007554*^9}, {3.683198569254446*^9, 
   3.683198631061006*^9}, {3.683198894243639*^9, 3.683199109099525*^9}, 
   3.68319934095358*^9, {3.683199926463127*^9, 3.683199981943626*^9}, {
   3.683200927136066*^9, 3.6832009722494783`*^9}, 3.683218996081359*^9, 
   3.683227195001505*^9, {3.6851040319656553`*^9, 3.685104094192264*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvmadt\[Delta]p", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvmadt1\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt2\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt3\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt4\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt5\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt6\[Delta]p", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683199311291834*^9, 3.683199335664133*^9}, {
  3.683200008076005*^9, 3.6832000770423727`*^9}, {3.683200190847007*^9, 
  3.683200245334814*^9}, {3.683200978950598*^9, 3.6832009932869453`*^9}, {
  3.6851040967204742`*^9, 3.6851041075759087`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "d",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    RowBox[{
     SubscriptBox["e", "i"], ",", "a", ",", "a"}], "]"}], TraditionalForm]]],
 "/",
 "d\[Delta]p"
}], "Subsection",
 CellChangeTimes->{{3.6832132294642563`*^9, 3.683213249847337*^9}, {
  3.6852052179393387`*^9, 3.685205236755865*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.6832132582712584`*^9, 3.683213260558799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt1\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6832132616833057`*^9, 3.683213303386718*^9}, {
   3.6832177969847403`*^9, 3.6832178203628473`*^9}, 3.6832271931226387`*^9, {
   3.685104118171009*^9, 3.685104121023273*^9}, {3.685193201540094*^9, 
   3.685193204012808*^9}}],

Cell["Focal adapted dies, replaced by her own maladapted offspring", "Text",
 CellChangeTimes->{{3.6832132809258957`*^9, 3.683213296676857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt2\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
        RowBox[{"\[Delta]p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
      RowBox[{"\[Delta]p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6832133014352007`*^9, 3.683213357824053*^9}, {
   3.683213401879324*^9, 3.683213403911558*^9}, {3.683213534705427*^9, 
   3.683213542979003*^9}, 3.683227192084193*^9, 3.685104123596192*^9, {
   3.685104216120593*^9, 3.685104230052704*^9}}],

Cell["Focal adapted dies, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68321336010565*^9, 3.683213366625884*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt3\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683213367584035*^9, 3.683213416711776*^9}, 
   3.683227190646262*^9, 3.6851041252833643`*^9}],

Cell["Nonfocal adapted dies, replaced by focal offspring", "Text",
 CellChangeTimes->{{3.683213418678454*^9, 3.68321342567815*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt4\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
         RowBox[{"\[Delta]p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
         RowBox[{"\[Delta]p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6832134270223827`*^9, 3.683213583469589*^9}, 
   3.683227187898449*^9, 3.685104127171273*^9, {3.68510424073841*^9, 
   3.685104264090149*^9}}],

Cell["\<\
Nonfocal adapted dies, replaced by nonfocal maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.6832135876560698`*^9, 3.683213597054346*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt5\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"raa", "[", "ei", "]"}], 
            RowBox[{"\[Delta]p", "[", 
             RowBox[{"phen", "[", 
              RowBox[{"ei", ",", "a"}], "]"}], "]"}]}]}], ")"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"raa", "[", "ei", "]"}], 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "a"}], "]"}], "]"}]}]}], ")"}]}], "]"}]}], 
     "+", 
     RowBox[{"d", "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683213598227193*^9, 3.6832137177*^9}, 
   3.6832190029681473`*^9, 3.683220676813352*^9, {3.683224361949139*^9, 
   3.683224364332396*^9}, 3.68322718657099*^9, {3.685005433142889*^9, 
   3.685005439598843*^9}, 3.6851041305766077`*^9, {3.68510428454543*^9, 
   3.6851043177177896`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt6\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683213719921734*^9, 3.683213773822291*^9}, 
   3.6832190057815733`*^9, 3.6832271841108418`*^9, 3.685104133311658*^9, {
   3.685104334406159*^9, 3.685104363443533*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvaadt\[Delta]p", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvaadt1\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt2\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt3\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt4\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt5\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt6\[Delta]p", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683213786759811*^9, 3.6832138193694963`*^9}, 
   3.68510413546329*^9, {3.685104369290401*^9, 3.685104393844062*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "d",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    RowBox[{
     SubscriptBox["e", "i"], ",", "m", ",", "m"}], "]"}], TraditionalForm]]],
 "/",
 "d\[Delta]p"
}], "Subsection",
 CellChangeTimes->{{3.6832144102492037`*^9, 3.683214425500306*^9}, {
  3.685205223164042*^9, 3.6852052386999063`*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.6832177787163754`*^9, 3.683217781747661*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt1\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", " ", 
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683217782423493*^9, 3.683217791529729*^9}, {
   3.683217881336334*^9, 3.683217897056925*^9}, {3.6832271799072657`*^9, 
   3.683227182420065*^9}, 3.6832272429076*^9, {3.685104806744871*^9, 
   3.685104807642209*^9}, {3.685193208051794*^9, 3.685193210179565*^9}}],

Cell["Focal dies, replaced by her own adapted offspring", "Text",
 CellChangeTimes->{{3.6832144383815317`*^9, 3.683214453429648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt2\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
       RowBox[{"\[Delta]p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
        RowBox[{"\[Delta]p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683214430586694*^9, 3.6832144562819443`*^9}, {
   3.6832174226063623`*^9, 3.683217427491819*^9}, {3.683217776583317*^9, 
   3.683217776664213*^9}, {3.683217903779244*^9, 3.6832179482178926`*^9}, 
   3.6832271790872507`*^9, {3.685104417748333*^9, 3.6851044387025146`*^9}, {
   3.6851048044381123`*^9, 3.685104805049736*^9}}],

Cell["Focal dies, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6832179512898397`*^9, 3.683217958449692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt3\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683217959347053*^9, 3.683217984452059*^9}, 
   3.6832271776208477`*^9, {3.685104801545739*^9, 3.685104802332456*^9}}],

Cell["Nonfocal dies, replaced by focal offspring ", "Text",
 CellChangeTimes->{{3.683217987151927*^9, 3.683217991370469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt4\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
         RowBox[{"\[Delta]p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
         RowBox[{"\[Delta]p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683217993904415*^9, 3.6832180563791037`*^9}, {
  3.683218095013372*^9, 3.683218143285419*^9}, {3.685104457573469*^9, 
  3.6851044702038918`*^9}, {3.6851047961068573`*^9, 3.685104799038278*^9}}],

Cell["\<\
Nonfocal maladapted dies, replaced by nonfocal adapted offspring\
\>", "Text",
 CellChangeTimes->{{3.683218151473761*^9, 3.683218170208146*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt5\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{"zs", "[", 
     RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"rmm", "[", "ei", "]"}], 
           RowBox[{"\[Delta]p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], ")"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"rmm", "[", "ei", "]"}], 
            RowBox[{"\[Delta]p", "[", 
             RowBox[{"phen", "[", 
              RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], ")"}]}]}], "]"}]}], 
     "+", 
     RowBox[{"d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683218146483746*^9, 3.683218227381504*^9}, 
   3.683219026276667*^9, 3.683220671511565*^9, 3.683227168476479*^9, {
   3.685104499586337*^9, 3.685104513800539*^9}, {3.6851047934683723`*^9, 
   3.685104794183606*^9}, {3.6851049123080273`*^9, 3.685104916056225*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt6\[Delta]p", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
               RowBox[{"\[Delta]p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}], "+", 
                 RowBox[{"\[Delta]p", "[", 
                  RowBox[{"phen", "[", 
                   RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683213719921734*^9, 3.683213773822291*^9}, {
   3.6832182359567204`*^9, 3.683218271839697*^9}, 3.6832190294842663`*^9, 
   3.6832271744595623`*^9, {3.685104524104491*^9, 3.685104548092345*^9}, {
   3.6851047882312937`*^9, 3.685104788887375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvmmdt\[Delta]p", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvmmdt1\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt2\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt3\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt4\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt5\[Delta]p", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt6\[Delta]p", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683218278288801*^9, 3.683218309191255*^9}, {
  3.6832185168692217`*^9, 3.68321852724966*^9}, {3.683227169531499*^9, 
  3.6832271732217007`*^9}, {3.685104551855403*^9, 3.6851045672550097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"selgrad", "[", "x_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "a"}], "]"}], 
        RowBox[{"dvaadt\[Delta]p", "[", "ei", "]"}]}], "+", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
        RowBox[{"dvamdt\[Delta]p", "[", "ei", "]"}]}], "+", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
        RowBox[{"dvmadt\[Delta]p", "[", "ei", "]"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
        RowBox[{"dvmmdt\[Delta]p", "[", "ei", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "x"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6851047139388113`*^9, 3.685104768776784*^9}, {
  3.6851048310097923`*^9, 3.68510486210417*^9}, {3.685105060331935*^9, 
  3.6851050710027227`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection gradient zs1, zs2", "Section",
 CellChangeTimes->{{3.682844962098281*^9, 3.6828449638582706`*^9}, {
  3.685105285124785*^9, 3.685105291371434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvals", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"ex", ",", "statex1", ",", "statex2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex1", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex2", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683200086190008*^9, 3.683200155658983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvalsTest", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "statex1", ",", "statex2"}], "]"}], "\[Rule]", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "statex1", ",", "statex2"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"statex1", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"statex2", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6832001606051397`*^9, 3.683200179314473*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "d",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    SubscriptBox["e", "i"]}], TraditionalForm]]],
 ",a,m]/d\[Delta]z"
}], "Subsection",
 CellChangeTimes->{{3.682845152607973*^9, 3.6828451899586554`*^9}, {
   3.683199373324525*^9, 3.683199405378907*^9}, {3.685105299869849*^9, 
   3.685105310740342*^9}, 3.6852054002343283`*^9}],

Cell["Environmental change:", "Text",
 CellChangeTimes->{{3.682845239557769*^9, 3.6828452435668077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt1\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{
        RowBox[{"ram", "[", "ei", "]"}], 
        RowBox[{"\[Delta]zs", "[", 
         RowBox[{"ei", ",", "m"}], "]"}]}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6828451992130203`*^9, 3.682845246071899*^9}, {
  3.683199347330213*^9, 3.68319940962227*^9}, {3.685105313696069*^9, 
  3.685105340351347*^9}, {3.685105413108971*^9, 3.685105415318947*^9}, {
  3.68519321581007*^9, 3.685193221360756*^9}}],

Cell["Mortality of focal, replaced by her own maladapted offspring", "Text",
 CellChangeTimes->{{3.6828452501496277`*^9, 3.68284525658976*^9}, {
  3.682845329972937*^9, 3.682845331604385*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt2\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845258154578*^9, 3.682845356278455*^9}, {
   3.683199411005266*^9, 3.683199421837904*^9}, {3.683199452764576*^9, 
   3.68319951112311*^9}, 3.683227210190816*^9, {3.685105358112289*^9, 
   3.685105359351172*^9}, {3.6851054011181803`*^9, 3.685105406070928*^9}}],

Cell["Mortality of focal, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68284535944386*^9, 3.682845365923882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt3\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845368271618*^9, 3.682845390486068*^9}, {
   3.683199514840802*^9, 3.683199523540876*^9}, 3.683227209011223*^9, 
   3.685105427949265*^9, 3.6851056103200006`*^9}],

Cell["Mortality of nonfocal, replaced by focal's offspring", "Text",
 CellChangeTimes->{{3.682845393347591*^9, 3.682845405355267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt4\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{
      RowBox[{"ram", "[", "ei", "]"}], " ", 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "m"}], "]"}]}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "m", ",", "a"}], "]"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}]}], "]"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845406494494*^9, 3.6828454555095787`*^9}, {
   3.6831995261390457`*^9, 3.683199751862639*^9}, {3.6851054331221533`*^9, 
   3.685105437160469*^9}, {3.685105468871879*^9, 3.685105478049226*^9}, 
   3.6851056127398777`*^9}],

Cell["\<\
Mortality of nonfocal, replaced by nonfocal offspring of a different type \
than nonfocal\
\>", "Text",
 CellChangeTimes->{{3.682845472978017*^9, 3.6828454882093973`*^9}, {
  3.683199796656701*^9, 3.683199797376515*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt5\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{
      RowBox[{"ram", "[", "ei", "]"}], " ", 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "m"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845489127758*^9, 3.682845652705119*^9}, {
   3.683199761631853*^9, 3.683199902715605*^9}, {3.683200116816619*^9, 
   3.683200118465126*^9}, {3.683200860421144*^9, 3.683200864659851*^9}, 
   3.6832189099756813`*^9, 3.683227206083026*^9, {3.6851054606675777`*^9, 
   3.6851054821521063`*^9}, 3.6851056081810093`*^9}],

Cell["\<\
Mortality of individual in remote patch, replaced by focal's offspring\
\>", "Text",
 CellChangeTimes->{{3.682845684654298*^9, 3.682845694533659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvamdt6\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682845654868635*^9, 3.682845679124524*^9}, {
   3.6831983981408043`*^9, 3.683198481007554*^9}, {3.683198569254446*^9, 
   3.683198631061006*^9}, {3.683198894243639*^9, 3.683199109099525*^9}, 
   3.68319934095358*^9, {3.683199926463127*^9, 3.683199981943626*^9}, {
   3.68320035894034*^9, 3.6832003611335793`*^9}, 3.683218944788011*^9, 
   3.683227204207383*^9, 3.685105605557281*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvamdt\[Delta]z", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvamdt1\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt2\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt3\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt4\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt5\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvamdt6\[Delta]z", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683199311291834*^9, 3.683199335664133*^9}, {
  3.683200008076005*^9, 3.6832000770423727`*^9}, {3.683200190847007*^9, 
  3.683200245334814*^9}, {3.685105588079419*^9, 3.6851056032380857`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"dvamdt\[Delta]z", "[", "1", "]"}], ",", 
   RowBox[{"\[Delta]zs", "[", 
    RowBox[{"1", ",", "a"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.68510562811147*^9, 3.6851056838973017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     FractionBox["1", "2"], " ", "q", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "+", 
       RowBox[{
        RowBox[{"ram", "[", "1", "]"}], " ", 
        RowBox[{"\[Delta]zs", "[", 
         RowBox[{"1", ",", "m"}], "]"}]}]}], ")"}]}]], " ", "q", " ", 
   RowBox[{"s", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a", ",", "m"}], "]"}]}], "+", 
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "m", ",", "a"}], "]"}]}], ")"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}]}], ")"}], " ", "k", " ", 
   RowBox[{"mu", "[", "a", "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "a", ",", "m"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"1", ",", "a"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", "k", " ", 
   RowBox[{"mu", "[", "a", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a", ",", "m"}], "]"}]}], "+", 
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "m", ",", "m"}], "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"1", ",", "a"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.685105645115741*^9, 3.685105684664744*^9}, 
   3.68510650518358*^9, 3.685193260133572*^9, 3.685205504657777*^9, 
   3.685251773159732*^9, 3.685251850081277*^9, 3.685253732002571*^9, 
   3.685253974275497*^9, 3.6852540929771013`*^9, 3.6852541723881893`*^9, 
   3.6852543124816933`*^9, 3.685257675976309*^9, 3.685338474003463*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "d",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    SubscriptBox["e", "i"]}], TraditionalForm]]],
 ",m,a]/d\[Delta]z"
}], "Subsection",
 CellChangeTimes->{{3.682845152607973*^9, 3.6828451899586554`*^9}, {
  3.683199373324525*^9, 3.683199405378907*^9}, {3.683200341720703*^9, 
  3.683200352201293*^9}, {3.685205402275049*^9, 3.6852054088745728`*^9}}],

Cell["Environmental change:", "Text",
 CellChangeTimes->{{3.682845239557769*^9, 3.6828452435668077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt1\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{
        RowBox[{"ram", "[", "ei", "]"}], 
        RowBox[{"\[Delta]zs", "[", 
         RowBox[{"ei", ",", "a"}], "]"}]}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6828451992130203`*^9, 3.682845246071899*^9}, {
   3.683199347330213*^9, 3.68319940962227*^9}, {3.6832004127359333`*^9, 
   3.68320043309993*^9}, 3.685105618855906*^9, {3.685105843592907*^9, 
   3.685105887463728*^9}, {3.6851932355671263`*^9, 3.685193240999161*^9}}],

Cell["Mortality of focal, replaced by her own adapted offspring", "Text",
 CellChangeTimes->{{3.6828452501496277`*^9, 3.68284525658976*^9}, {
  3.682845329972937*^9, 3.682845331604385*^9}, {3.683200460076082*^9, 
  3.6832004609474897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt2\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845258154578*^9, 3.682845356278455*^9}, {
   3.683199411005266*^9, 3.683199421837904*^9}, {3.683199452764576*^9, 
   3.68319951112311*^9}, {3.6832004363552237`*^9, 3.683200472657877*^9}, {
   3.683200555700583*^9, 3.6832005768996687`*^9}, 3.683219505299831*^9, 
   3.683227201430964*^9, {3.685105894164751*^9, 3.68510589820173*^9}, 
   3.6851059480515823`*^9}],

Cell["Mortality of focal, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68284535944386*^9, 3.682845365923882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt3\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845368271618*^9, 3.682845390486068*^9}, {
   3.683199514840802*^9, 3.683199523540876*^9}, {3.68320058014487*^9, 
   3.683200589869781*^9}, 3.683227200189714*^9, 3.685105903865139*^9, 
   3.685105949998584*^9}],

Cell["Mortality of nonfocal, replaced by focal's offspring", "Text",
 CellChangeTimes->{{3.682845393347591*^9, 3.682845405355267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt4\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{
      RowBox[{"ram", "[", "ei", "]"}], 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "a"}], "]"}]}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"v", "[", 
           RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}]}], "]"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845406494494*^9, 3.6828454555095787`*^9}, {
   3.6831995261390457`*^9, 3.683199751862639*^9}, {3.6832005956307487`*^9, 
   3.683200742417244*^9}, {3.683200801830461*^9, 3.683200802245098*^9}, {
   3.68510590764001*^9, 3.685105914387108*^9}, 3.685105952438374*^9}],

Cell["\<\
Mortality of nonfocal adapted, replaced by nonfocal maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.682845472978017*^9, 3.6828454882093973`*^9}, {
  3.683199796656701*^9, 3.683199797376515*^9}, {3.683213694530525*^9, 
  3.683213700345112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt5\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{
      RowBox[{"ram", "[", "ei", "]"}], 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "a"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], "d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.682845489127758*^9, 3.682845652705119*^9}, {
   3.683199761631853*^9, 3.683199902715605*^9}, {3.683200116816619*^9, 
   3.683200118465126*^9}, {3.683200754640517*^9, 3.6832008538239202`*^9}, {
   3.6832008997121553`*^9, 3.683200902071858*^9}, 3.6832189925315723`*^9, {
   3.68321984562053*^9, 3.683219862401634*^9}, 3.6832271967477627`*^9, {
   3.685105931998399*^9, 3.685105954879033*^9}}],

Cell["\<\
Mortality of individual in remote patch, replaced by focal's offspring\
\>", "Text",
 CellChangeTimes->{{3.682845684654298*^9, 3.682845694533659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmadt6\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.682845654868635*^9, 3.682845679124524*^9}, {
   3.6831983981408043`*^9, 3.683198481007554*^9}, {3.683198569254446*^9, 
   3.683198631061006*^9}, {3.683198894243639*^9, 3.683199109099525*^9}, 
   3.68319934095358*^9, {3.683199926463127*^9, 3.683199981943626*^9}, {
   3.683200927136066*^9, 3.6832009722494783`*^9}, 3.683218996081359*^9, 
   3.683227195001505*^9, 3.685105959516412*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvmadt\[Delta]z", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvmadt1\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt2\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt3\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt4\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt5\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmadt6\[Delta]z", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683199311291834*^9, 3.683199335664133*^9}, {
  3.683200008076005*^9, 3.6832000770423727`*^9}, {3.683200190847007*^9, 
  3.683200245334814*^9}, {3.683200978950598*^9, 3.6832009932869453`*^9}, {
  3.6851059630188303`*^9, 3.685105975094479*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "d",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    RowBox[{
     SubscriptBox["e", "i"], ",", "a", ",", "a"}], "]"}], TraditionalForm]]],
 "/d\[Delta]z"
}], "Subsection",
 CellChangeTimes->{{3.6832132294642563`*^9, 3.683213249847337*^9}, {
  3.685205410218521*^9, 3.685205417657596*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.6832132582712584`*^9, 3.683213260558799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt1\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "+", 
       RowBox[{
        RowBox[{"raa", "[", "ei", "]"}], 
        RowBox[{"\[Delta]zs", "[", 
         RowBox[{"ei", ",", "a"}], "]"}]}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "m", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6832132616833057`*^9, 3.683213303386718*^9}, {
   3.6832177969847403`*^9, 3.6832178203628473`*^9}, 3.6832271931226387`*^9, {
   3.685106052132043*^9, 3.685106114524485*^9}, {3.685193243950995*^9, 
   3.685193246222458*^9}}],

Cell["Focal adapted dies, replaced by her own maladapted offspring", "Text",
 CellChangeTimes->{{3.6832132809258957`*^9, 3.683213296676857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt2\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6832133014352007`*^9, 3.683213357824053*^9}, {
   3.683213401879324*^9, 3.683213403911558*^9}, {3.683213534705427*^9, 
   3.683213542979003*^9}, 3.683227192084193*^9, 3.685106054455937*^9, 
   3.685106123869409*^9}],

Cell["Focal adapted dies, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.68321336010565*^9, 3.683213366625884*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt3\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683213367584035*^9, 3.683213416711776*^9}, 
   3.683227190646262*^9, 3.685106056397469*^9, 3.685106127131112*^9}],

Cell["Nonfocal adapted dies, replaced by focal offspring", "Text",
 CellChangeTimes->{{3.683213418678454*^9, 3.68321342567815*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt4\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{
      RowBox[{"raa", "[", "ei", "]"}], 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "a"}], "]"}]}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6832134270223827`*^9, 3.683213583469589*^9}, 
   3.683227187898449*^9, 3.685106058393654*^9, {3.6851061333958883`*^9, 
   3.685106137359034*^9}}],

Cell["\<\
Nonfocal adapted dies, replaced by nonfocal maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.6832135876560698`*^9, 3.683213597054346*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt5\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "a", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "a"}], "]"}], "+", 
     RowBox[{
      RowBox[{"raa", "[", "ei", "]"}], 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "a"}], "]"}]}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], "]"}]}], "+", 
     RowBox[{"d", "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "a"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683213598227193*^9, 3.6832137177*^9}, 
   3.6832190029681473`*^9, 3.683220676813352*^9, {3.683224361949139*^9, 
   3.683224364332396*^9}, 3.68322718657099*^9, {3.685005433142889*^9, 
   3.685005439598843*^9}, 3.6851060606351757`*^9, 3.685106155825282*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvaadt6\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "a"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "a"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683213719921734*^9, 3.683213773822291*^9}, 
   3.6832190057815733`*^9, 3.6832271841108418`*^9, 3.685106062965802*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvaadt\[Delta]z", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvaadt1\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt2\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt3\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt4\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt5\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvaadt6\[Delta]z", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683213786759811*^9, 3.6832138193694963`*^9}, {
  3.6851061634742603`*^9, 3.685106193511704*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "d",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "[", 
    RowBox[{
     SubscriptBox["e", "i"], ",", "m", ",", "m"}], "]"}], TraditionalForm]]],
 "/d\[Delta]z"
}], "Subsection",
 CellChangeTimes->{{3.6832144102492037`*^9, 3.683214425500306*^9}, {
  3.685205419008654*^9, 3.685205422162251*^9}}],

Cell["Environmental change", "Text",
 CellChangeTimes->{{3.6832177787163754`*^9, 3.683217781747661*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt1\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"q", 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{"zs", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "+", 
       RowBox[{
        RowBox[{"rmm", "[", "ei", "]"}], 
        RowBox[{"\[Delta]zs", "[", 
         RowBox[{"ei", ",", "m"}], "]"}]}]}], ")"}]}], "]"}], 
   RowBox[{"s", "[", "ei", "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
       RowBox[{"3", "-", "ei"}], ",", "a", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683217782423493*^9, 3.683217791529729*^9}, {
   3.683217881336334*^9, 3.683217897056925*^9}, {3.6832271799072657`*^9, 
   3.683227182420065*^9}, 3.6832272429076*^9, {3.6851061968845654`*^9, 
   3.685106197710475*^9}, {3.685106258694045*^9, 3.68510627479255*^9}, {
   3.685193251727318*^9, 3.6851932546949663`*^9}}],

Cell["Focal dies, replaced by her own adapted offspring", "Text",
 CellChangeTimes->{{3.6832144383815317`*^9, 3.683214453429648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt2\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"phen", "[", 
       RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"phen", "[", 
        RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683214430586694*^9, 3.6832144562819443`*^9}, {
   3.6832174226063623`*^9, 3.683217427491819*^9}, {3.683217776583317*^9, 
   3.683217776664213*^9}, {3.683217903779244*^9, 3.6832179482178926`*^9}, 
   3.6832271790872507`*^9, {3.685106200083531*^9, 3.6851062010572443`*^9}, 
   3.685106286417898*^9}],

Cell["Focal dies, replaced by nonfocal offspring", "Text",
 CellChangeTimes->{{3.6832179512898397`*^9, 3.683217958449692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt3\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{"\[Delta]zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}]}], "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683217959347053*^9, 3.683217984452059*^9}, 
   3.6832271776208477`*^9, {3.685106203146194*^9, 3.685106204008687*^9}, 
   3.685106289239203*^9}],

Cell["Nonfocal dies, replaced by focal offspring ", "Text",
 CellChangeTimes->{{3.683217987151927*^9, 3.683217991370469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt4\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{
      RowBox[{"rmm", "[", "ei", "]"}], 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "m"}], "]"}]}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ei", "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "a", ",", "m"}], "]"}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
       RowBox[{"v", "[", 
        RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683217993904415*^9, 3.6832180563791037`*^9}, {
  3.683218095013372*^9, 3.683218143285419*^9}, {3.685106206498041*^9, 
  3.6851062074328814`*^9}, {3.685106293553238*^9, 3.685106305592475*^9}}],

Cell["\<\
Nonfocal maladapted dies, replaced by nonfocal adapted offspring\
\>", "Text",
 CellChangeTimes->{{3.683218151473761*^9, 3.683218170208146*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt5\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   RowBox[{"mu", "[", "m", "]"}], 
   RowBox[{"nu", "[", 
    RowBox[{
     RowBox[{"zs", "[", 
      RowBox[{"ei", ",", "m"}], "]"}], "+", 
     RowBox[{
      RowBox[{"rmm", "[", "ei", "]"}], 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"ei", ",", "m"}], "]"}]}]}], "]"}], 
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ei", "\[Equal]", "1"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "m"}], "]"}], "]"}], ",", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"phen", "[", 
           RowBox[{"ei", ",", "m"}], "]"}], "]"}]}]}], "]"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"ex", ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"statex", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ei", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "+", "1", 
             "-", 
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ex", ",", 
                RowBox[{"statex", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"statex", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "a"}], "]"}], "-", 
     RowBox[{"v", "[", 
      RowBox[{"ei", ",", "m", ",", "m"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.683218146483746*^9, 3.683218227381504*^9}, 
   3.683219026276667*^9, 3.683220671511565*^9, 3.683227168476479*^9, {
   3.685106220917781*^9, 3.685106222677141*^9}, 3.685106314942418*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvmmdt6\[Delta]z", "[", "ei_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], "d", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ex", ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"statex", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"mu", "[", 
          RowBox[{"statex", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], 
         RowBox[{"nu", "[", 
          RowBox[{"zs", "[", 
           RowBox[{"ex", ",", 
            RowBox[{"statex", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ex", "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"1", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"phen", "[", 
               RowBox[{"ei", ",", "m"}], "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "m", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p", "[", 
                RowBox[{"phen", "[", 
                 RowBox[{"ei", ",", "m"}], "]"}], "]"}]}], ")"}], 
             RowBox[{"v", "[", 
              RowBox[{"2", ",", "a", ",", 
               RowBox[{"statex", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"statex", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "m"}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683213719921734*^9, 3.683213773822291*^9}, {
   3.6832182359567204`*^9, 3.683218271839697*^9}, 3.6832190294842663`*^9, 
   3.6832271744595623`*^9, {3.685106225065007*^9, 3.6851062263339233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvmmdt\[Delta]z", "[", "ei_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dvmmdt1\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt2\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt3\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt4\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt5\[Delta]z", "[", "ei", "]"}], "+", 
    RowBox[{"dvmmdt6\[Delta]z", "[", "ei", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.683218278288801*^9, 3.683218309191255*^9}, {
  3.6832185168692217`*^9, 3.68321852724966*^9}, {3.683227169531499*^9, 
  3.6832271732217007`*^9}, {3.685106228712351*^9, 3.68510624517472*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"selgrad\[Delta]z", "[", "x_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "a"}], "]"}], 
        RowBox[{"dvaadt\[Delta]z", "[", "ei", "]"}]}], "+", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
        RowBox[{"dvamdt\[Delta]z", "[", "ei", "]"}]}], "+", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "a", ",", "m"}], "]"}], 
        RowBox[{"dvmadt\[Delta]z", "[", "ei", "]"}]}], "+", 
       RowBox[{"2", 
        RowBox[{"f", "[", 
         RowBox[{"ei", ",", "m", ",", "m"}], "]"}], 
        RowBox[{"dvmmdt\[Delta]z", "[", "ei", "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ei", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "x"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6851047139388113`*^9, 3.685104768776784*^9}, {
  3.6851048310097923`*^9, 3.68510486210417*^9}, {3.685105060331935*^9, 
  3.6851050710027227`*^9}, {3.685106481422261*^9, 3.685106499899653*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dze1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"selgrad\[Delta]z", "[", 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"1", ",", "m"}], "]"}], "]"}], "+", 
     RowBox[{"selgrad\[Delta]z", "[", 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"1", ",", "a"}], "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dze2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"selgrad\[Delta]z", "[", 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"2", ",", "m"}], "]"}], "]"}], "+", 
     RowBox[{"selgrad\[Delta]z", "[", 
      RowBox[{"\[Delta]zs", "[", 
       RowBox[{"2", ",", "a"}], "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"\[Delta]zs", "[", 
        RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "0"}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.68510669417272*^9, 3.6851068155406017`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Export selection gradients to C", "Subsection",
 CellChangeTimes->{{3.6852052550872498`*^9, 3.6852052596237097`*^9}, 
   3.685251348422414*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"strselgrads", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{
   "strselgrads", "<>", "\"\<double p1tplus1 = bound01(p1 + eul * (\>\"", "<>", 
    RowBox[{"tc", "[", 
     RowBox[{
      RowBox[{"selgrad", "[", 
       RowBox[{"\[Delta]p", "[", "1", "]"}], "]"}], "/.", "subslist"}], "]"}],
     "<>", "\"\<));\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{
   "strselgrads", "<>", "\"\<double p2tplus1 = bound01(p2 + eul * (\>\"", "<>", 
    RowBox[{"tc", "[", 
     RowBox[{
      RowBox[{"selgrad", "[", 
       RowBox[{"\[Delta]p", "[", "2", "]"}], "]"}], "/.", "subslist"}], "]"}],
     "<>", "\"\<));\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{"strselgrads", "<>", "\"\<double zs1tplus1 = zs1 + eul * (\>\"", "<>", 
    RowBox[{"tc", "[", 
     RowBox[{"dze1", "/.", "subslist"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{"strselgrads", "<>", "\"\<double zs2tplus1 = zs2 + eul * (\>\"", "<>", 
    RowBox[{"tc", "[", 
     RowBox[{"dze2", "/.", "subslist"}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{
   "strselgrads", "<>", "\"\<gsl_vector_set(f, 0, p1tplus1);\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{
   "strselgrads", "<>", "\"\<gsl_vector_set(f, 1, p2tplus1);\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{
   "strselgrads", "<>", "\"\<gsl_vector_set(f, 2, zs1tplus1);\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strselgrads", "=", 
   RowBox[{
   "strselgrads", "<>", "\"\<gsl_vector_set(f, 3, zs2tplus1);\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"cdir", "<>", "\"\<selgrad.txt\>\""}], ",", "strselgrads"}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6852052797178383`*^9, 3.685205381692547*^9}, {
   3.685205443115889*^9, 3.685205585962865*^9}, {3.685205666605548*^9, 
   3.685205716667718*^9}, 3.685251348423333*^9, {3.685253952308258*^9, 
   3.685253961330715*^9}, {3.685254070656358*^9, 3.68525407997407*^9}}],

Cell["Parameters", "Text",
 CellChangeTimes->{{3.68279161412716*^9, 3.682791615861644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printIt", "[", "x_", "]"}], ":=", 
   RowBox[{"\"\<double \>\"", "<>", 
    RowBox[{"tc", "[", "x", "]"}], "<>", "\"\<;\\n\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682791732865602*^9, 3.682791753923362*^9}, {
  3.685253642038793*^9, 3.685253642373803*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], ",", 
     RowBox[{"mu", "[", "a", "]"}], ",", "d", ",", 
     RowBox[{"s", "[", "1", "]"}], ",", 
     RowBox[{"s", "[", "2", "]"}], ",", "k", ",", "q", ",", "eul"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"pars", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"zs", "[", "1", "]"}], ",", 
       RowBox[{"zs", "[", "2", "]"}]}], "}"}], ",", "patches", ",", "rvals", 
     ",", "relvals"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682791618416059*^9, 3.682791711864233*^9}, {
  3.685253651970591*^9, 3.685253683553267*^9}, {3.6852541643925037`*^9, 
  3.6852541678072433`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ix", "=", "1"}], ",", 
    RowBox[{"ix", "\[LessEqual]", 
     RowBox[{"Length", "[", "pars", "]"}]}], ",", 
    RowBox[{"++", "ix"}], ",", 
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"printIt", "[", 
       RowBox[{"pars", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"cdir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ix", "=", "1"}], ",", 
    RowBox[{"ix", "\[LessEqual]", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"++", "ix"}], ",", 
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"printIt", "[", 
       RowBox[{"variables", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"cdir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6827917566100817`*^9, 3.6827918647221117`*^9}, {
  3.685253692782035*^9, 3.685253695587323*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1449, 1028},
WindowMargins->{{55, Automatic}, {Automatic, 14}},
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}},
Magnification->1.25,
FrontEndVersion->"7.0 for Linux x86 (64-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 133, 1, 104, "Title"],
Cell[CellGroupData[{
Cell[725, 27, 150, 2, 88, "Section"],
Cell[878, 31, 139, 2, 38, "Input"],
Cell[1020, 35, 239, 4, 37, "Text"],
Cell[1262, 41, 469, 10, 41, "Input"],
Cell[1734, 53, 187, 6, 37, "Text"],
Cell[1924, 61, 265, 6, 38, "Input"],
Cell[2192, 69, 112, 1, 37, "Text"],
Cell[2307, 72, 240, 7, 38, "Input"],
Cell[2550, 81, 101, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[2676, 86, 677, 20, 38, "Input"],
Cell[3356, 108, 982, 24, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4375, 137, 533, 15, 38, "Input"],
Cell[4911, 154, 5221, 90, 323, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10169, 249, 71, 1, 38, "Input"],
Cell[10243, 252, 207, 3, 56, "Output"]
}, Open  ]],
Cell[10465, 258, 126, 3, 37, "Text"],
Cell[10594, 263, 6638, 153, 931, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17269, 421, 151, 2, 88, "Section"],
Cell[17423, 425, 203, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[17651, 433, 103, 1, 46, "Subsection"],
Cell[CellGroupData[{
Cell[17779, 438, 798, 24, 58, "Input"],
Cell[18580, 464, 2570, 43, 70, "Output"]
}, Open  ]],
Cell[21165, 510, 246, 7, 57, "Text"],
Cell[21414, 519, 682, 21, 58, "Input"],
Cell[22099, 542, 653, 20, 95, "Text"],
Cell[22755, 564, 2940, 81, 293, "Input"],
Cell[CellGroupData[{
Cell[25720, 649, 371, 8, 58, "Input"],
Cell[26094, 659, 3760, 71, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29891, 735, 587, 16, 58, "Input"],
Cell[30481, 753, 3149, 53, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33667, 811, 1282, 31, 58, "Input"],
Cell[34952, 844, 3454, 56, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[38455, 906, 171, 3, 35, "Subsection"],
Cell[38629, 911, 102, 1, 71, "Text"],
Cell[38734, 914, 914, 26, 72, "Input"],
Cell[39651, 942, 214, 4, 71, "Text"],
Cell[39868, 948, 531, 14, 72, "Input"],
Cell[40402, 964, 186, 2, 71, "Text"],
Cell[40591, 968, 631, 17, 72, "Input"],
Cell[41225, 987, 343, 8, 72, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[41605, 1000, 214, 5, 35, "Subsection"],
Cell[41822, 1007, 128, 2, 106, "Text"],
Cell[41953, 1011, 1231, 36, 303, "Input"],
Cell[43187, 1049, 210, 5, 106, "Text"],
Cell[43400, 1056, 465, 13, 110, "Input"],
Cell[43868, 1071, 214, 5, 106, "Text"],
Cell[44085, 1078, 518, 15, 110, "Input"],
Cell[44606, 1095, 349, 10, 106, "Text"],
Cell[44958, 1107, 649, 17, 110, "Input"],
Cell[45610, 1126, 214, 5, 106, "Text"],
Cell[45827, 1133, 479, 14, 110, "Input"],
Cell[46309, 1149, 123, 2, 106, "Text"],
Cell[46435, 1153, 437, 11, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[46909, 1169, 172, 3, 35, "Subsection"],
Cell[47084, 1174, 887, 25, 110, "Input"],
Cell[47974, 1201, 457, 13, 110, "Input"],
Cell[48434, 1216, 484, 14, 110, "Input"],
Cell[48921, 1232, 292, 7, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49250, 1244, 126, 1, 35, "Subsection"],
Cell[49379, 1247, 318, 11, 37, "Text"],
Cell[49700, 1260, 314, 8, 38, "Input"],
Cell[50017, 1270, 120, 1, 37, "Text"],
Cell[50140, 1273, 676, 19, 38, "Input"],
Cell[CellGroupData[{
Cell[50841, 1296, 99, 1, 38, "Input"],
Cell[50943, 1299, 1033, 22, 56, "Output"]
}, Open  ]],
Cell[51991, 1324, 288, 5, 37, "Text"],
Cell[52282, 1331, 493, 13, 64, "Input"],
Cell[52778, 1346, 175, 2, 37, "Text"],
Cell[52956, 1350, 173, 4, 37, "Text"],
Cell[53132, 1356, 2439, 66, 89, "Input"],
Cell[55574, 1424, 3106, 86, 114, "Input"],
Cell[58683, 1512, 3110, 86, 114, "Input"],
Cell[CellGroupData[{
Cell[61818, 1602, 844, 20, 38, "Input"],
Cell[62665, 1624, 3314, 62, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66016, 1691, 762, 18, 38, "Input"],
Cell[66781, 1711, 3286, 61, 82, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70116, 1778, 231, 5, 46, "Subsection"],
Cell[CellGroupData[{
Cell[70372, 1787, 197, 4, 58, "Input"],
Cell[70572, 1793, 976, 21, 70, "Output"]
}, Open  ]],
Cell[71563, 1817, 1633, 46, 138, "Input"],
Cell[73199, 1865, 286, 7, 58, "Input"],
Cell[73488, 1874, 328, 8, 58, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73865, 1888, 106, 1, 88, "Section"],
Cell[73974, 1891, 642, 19, 38, "Input"],
Cell[74619, 1912, 720, 21, 64, "Input"],
Cell[CellGroupData[{
Cell[75364, 1937, 368, 9, 46, "Subsection"],
Cell[75735, 1948, 105, 1, 106, "Text"],
Cell[75843, 1951, 780, 23, 166, "Input"],
Cell[76626, 1976, 192, 2, 106, "Text"],
Cell[76821, 1980, 1005, 29, 166, "Input"],
Cell[77829, 2011, 131, 1, 106, "Text"],
Cell[77963, 2014, 633, 19, 166, "Input"],
Cell[78599, 2035, 134, 1, 106, "Text"],
Cell[78736, 2038, 1566, 47, 321, "Input"],
Cell[80305, 2087, 230, 5, 106, "Text"],
Cell[80538, 2094, 3053, 85, 808, "Input"],
Cell[83594, 2181, 160, 3, 106, "Text"],
Cell[83757, 2186, 5072, 135, 835, "Input"],
Cell[88832, 2323, 556, 13, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[89425, 2341, 418, 10, 35, "Subsection"],
Cell[89846, 2353, 105, 1, 106, "Text"],
Cell[89954, 2356, 826, 23, 166, "Input"],
Cell[90783, 2381, 240, 3, 106, "Text"],
Cell[91026, 2386, 1131, 31, 166, "Input"],
Cell[92160, 2419, 131, 1, 106, "Text"],
Cell[92294, 2422, 682, 20, 166, "Input"],
Cell[92979, 2444, 134, 1, 106, "Text"],
Cell[93116, 2447, 1663, 48, 395, "Input"],
Cell[94782, 2497, 262, 5, 106, "Text"],
Cell[95047, 2504, 3154, 86, 808, "Input"],
Cell[98204, 2592, 160, 3, 106, "Text"],
Cell[98367, 2597, 5073, 135, 835, "Input"],
Cell[103443, 2734, 604, 13, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[104084, 2752, 343, 9, 35, "Subsection"],
Cell[104430, 2763, 104, 1, 106, "Text"],
Cell[104537, 2766, 668, 18, 110, "Input"],
Cell[105208, 2786, 144, 1, 106, "Text"],
Cell[105355, 2789, 1008, 29, 166, "Input"],
Cell[106366, 2820, 131, 1, 106, "Text"],
Cell[106500, 2823, 587, 19, 166, "Input"],
Cell[107090, 2844, 131, 1, 106, "Text"],
Cell[107224, 2847, 1918, 58, 395, "Input"],
Cell[109145, 2907, 156, 3, 106, "Text"],
Cell[109304, 2912, 2990, 84, 616, "Input"],
Cell[112297, 2998, 4806, 131, 835, "Input"],
Cell[117106, 3131, 458, 11, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[117601, 3147, 233, 6, 35, "Subsection"],
Cell[117837, 3155, 104, 1, 106, "Text"],
Cell[117944, 3158, 708, 19, 110, "Input"],
Cell[118655, 3179, 133, 1, 106, "Text"],
Cell[118791, 3182, 1064, 30, 166, "Input"],
Cell[119858, 3214, 126, 1, 106, "Text"],
Cell[119987, 3217, 589, 19, 166, "Input"],
Cell[120579, 3238, 125, 1, 106, "Text"],
Cell[120707, 3241, 1936, 57, 321, "Input"],
Cell[122646, 3300, 154, 3, 106, "Text"],
Cell[122803, 3305, 2894, 82, 616, "Input"],
Cell[125700, 3389, 4858, 132, 835, "Input"],
Cell[130561, 3523, 557, 13, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[131155, 3541, 124, 1, 35, "Subsection"],
Cell[131282, 3544, 691, 20, 38, "Input"],
Cell[131976, 3566, 1135, 32, 71, "Input"],
Cell[CellGroupData[{
Cell[133136, 3602, 103, 1, 38, "Input"],
Cell[133242, 3605, 3173, 69, 111, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136452, 3679, 1050, 30, 114, "Input"],
Cell[137505, 3711, 2768, 54, 56, "Output"]
}, Open  ]],
Cell[140288, 3768, 2290, 63, 89, "Input"],
Cell[142581, 3833, 2390, 65, 114, "Input"],
Cell[144974, 3900, 2537, 67, 114, "Input"],
Cell[CellGroupData[{
Cell[147536, 3971, 533, 15, 38, "Input"],
Cell[148072, 3988, 2021, 31, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150130, 4024, 1212, 34, 64, "Input"],
Cell[151345, 4060, 3580, 70, 64, "Output"],
Cell[154928, 4132, 3582, 70, 64, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158559, 4208, 236, 5, 46, "Subsection"],
Cell[158798, 4215, 1376, 35, 89, "Input"],
Cell[160177, 4252, 208, 5, 38, "Input"],
Cell[160388, 4259, 391, 13, 37, "Text"],
Cell[160782, 4274, 791, 21, 38, "Input"],
Cell[161576, 4297, 423, 9, 38, "Input"],
Cell[162002, 4308, 370, 8, 38, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[162421, 4322, 98, 1, 88, "Section"],
Cell[CellGroupData[{
Cell[162544, 4327, 150, 2, 46, "Subsection"],
Cell[162697, 4331, 104, 1, 106, "Text"],
Cell[162804, 4334, 1126, 32, 187, "Input"],
Cell[163933, 4368, 212, 4, 106, "Text"],
Cell[164148, 4374, 1424, 38, 246, "Input"],
Cell[165575, 4414, 211, 4, 106, "Text"],
Cell[165789, 4420, 1610, 49, 322, "Input"],
Cell[167402, 4471, 517, 13, 178, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[167956, 4489, 164, 3, 35, "Subsection"],
Cell[168123, 4494, 104, 1, 106, "Text"],
Cell[168230, 4497, 1487, 45, 303, "Input"],
Cell[169720, 4544, 210, 4, 106, "Text"],
Cell[169933, 4550, 1377, 38, 246, "Input"],
Cell[171313, 4590, 208, 4, 106, "Text"],
Cell[171524, 4596, 1260, 37, 246, "Input"],
Cell[172787, 4635, 162, 3, 106, "Text"],
Cell[172952, 4640, 1564, 49, 322, "Input"],
Cell[174519, 4691, 204, 4, 106, "Text"],
Cell[174726, 4697, 1516, 48, 322, "Input"],
Cell[176245, 4747, 711, 17, 178, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[176993, 4769, 145, 1, 35, "Subsection"],
Cell[177141, 4772, 103, 1, 37, "Text"],
Cell[177247, 4775, 1079, 31, 64, "Input"],
Cell[178329, 4808, 163, 3, 37, "Text"],
Cell[178495, 4813, 1580, 47, 99, "Input"],
Cell[180078, 4862, 165, 3, 37, "Text"],
Cell[180246, 4867, 1305, 38, 99, "Input"],
Cell[181554, 4907, 568, 14, 75, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182159, 4926, 107, 1, 46, "Subsection"],
Cell[182269, 4929, 909, 23, 38, "Input"],
Cell[183181, 4954, 2957, 84, 139, "Input"],
Cell[CellGroupData[{
Cell[186163, 5042, 764, 18, 38, "Input"],
Cell[186930, 5062, 1620, 30, 56, "Output"]
}, Open  ]],
Cell[188565, 5095, 6272, 154, 364, "Input"],
Cell[194840, 5251, 126, 2, 38, "Input"],
Cell[CellGroupData[{
Cell[194991, 5257, 702, 18, 38, "Input"],
Cell[195696, 5277, 1218, 26, 56, "Output"]
}, Open  ]],
Cell[196929, 5306, 275, 7, 38, "Input"],
Cell[CellGroupData[{
Cell[197229, 5317, 175, 4, 38, "Input"],
Cell[197407, 5323, 283, 6, 38, "Output"]
}, Open  ]],
Cell[197705, 5332, 797, 20, 38, "Input"],
Cell[CellGroupData[{
Cell[198527, 5356, 208, 5, 38, "Input"],
Cell[198738, 5363, 274, 6, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199049, 5374, 552, 13, 38, "Input"],
Cell[199604, 5389, 2690, 53, 333, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[202343, 5448, 265, 3, 46, "Subsection"],
Cell[202611, 5453, 1189, 31, 64, "Input"],
Cell[203803, 5486, 823, 19, 38, "Input"],
Cell[204629, 5507, 419, 9, 38, "Input"],
Cell[205051, 5518, 439, 9, 38, "Input"],
Cell[CellGroupData[{
Cell[205515, 5531, 2031, 55, 89, "Input"],
Cell[207549, 5588, 261, 3, 56, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[207871, 5598, 161, 2, 88, "Section"],
Cell[208035, 5602, 642, 19, 38, "Input"],
Cell[208680, 5623, 720, 21, 64, "Input"],
Cell[CellGroupData[{
Cell[209425, 5648, 365, 9, 46, "Subsection"],
Cell[209793, 5659, 105, 1, 106, "Text"],
Cell[209901, 5662, 834, 23, 166, "Input"],
Cell[210738, 5687, 192, 2, 106, "Text"],
Cell[210933, 5691, 1407, 40, 322, "Input"],
Cell[212343, 5733, 131, 1, 106, "Text"],
Cell[212477, 5736, 692, 20, 166, "Input"],
Cell[213172, 5758, 134, 1, 106, "Text"],
Cell[213309, 5761, 2056, 59, 395, "Input"],
Cell[215368, 5822, 230, 5, 106, "Text"],
Cell[215601, 5829, 3673, 101, 808, "Input"],
Cell[219277, 5932, 160, 3, 106, "Text"],
Cell[219440, 5937, 6882, 176, 1127, "Input"],
Cell[226325, 6115, 665, 13, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[227027, 6133, 418, 11, 35, "Subsection"],
Cell[227448, 6146, 105, 1, 106, "Text"],
Cell[227556, 6149, 888, 24, 166, "Input"],
Cell[228447, 6175, 240, 3, 106, "Text"],
Cell[228690, 6180, 1441, 38, 322, "Input"],
Cell[230134, 6220, 131, 1, 106, "Text"],
Cell[230268, 6223, 740, 21, 166, "Input"],
Cell[231011, 6246, 134, 1, 106, "Text"],
Cell[231148, 6249, 2101, 59, 395, "Input"],
Cell[233252, 6310, 262, 5, 106, "Text"],
Cell[233517, 6317, 3818, 103, 808, "Input"],
Cell[237338, 6422, 160, 3, 106, "Text"],
Cell[237501, 6427, 6834, 175, 1127, "Input"],
Cell[244338, 6604, 720, 14, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[245095, 6623, 317, 11, 35, "Subsection"],
Cell[245415, 6636, 104, 1, 106, "Text"],
Cell[245522, 6639, 725, 19, 110, "Input"],
Cell[246250, 6660, 144, 1, 106, "Text"],
Cell[246397, 6663, 1397, 39, 322, "Input"],
Cell[247797, 6704, 131, 1, 106, "Text"],
Cell[247931, 6707, 620, 19, 166, "Input"],
Cell[248554, 6728, 131, 1, 106, "Text"],
Cell[248688, 6731, 2730, 79, 541, "Input"],
Cell[251421, 6812, 156, 3, 106, "Text"],
Cell[251580, 6817, 3591, 100, 616, "Input"],
Cell[255174, 6919, 6591, 172, 1127, "Input"],
Cell[261768, 7093, 592, 12, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[262397, 7110, 317, 11, 35, "Subsection"],
Cell[262717, 7123, 104, 1, 57, "Text"],
Cell[262824, 7126, 763, 19, 58, "Input"],
Cell[263590, 7147, 133, 1, 57, "Text"],
Cell[263726, 7150, 1514, 41, 153, "Input"],
Cell[265243, 7193, 126, 1, 57, "Text"],
Cell[265372, 7196, 644, 19, 110, "Input"],
Cell[266019, 7217, 125, 1, 57, "Text"],
Cell[266147, 7220, 2776, 78, 275, "Input"],
Cell[268926, 7300, 154, 3, 57, "Text"],
Cell[269083, 7305, 3570, 99, 352, "Input"],
Cell[272656, 7406, 6669, 173, 470, "Input"],
Cell[279328, 7581, 668, 13, 58, "Input"],
Cell[279999, 7596, 1084, 29, 100, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[281132, 7631, 163, 2, 88, "Section"],
Cell[281298, 7635, 642, 19, 38, "Input"],
Cell[281943, 7656, 720, 21, 64, "Input"],
Cell[CellGroupData[{
Cell[282688, 7681, 349, 10, 46, "Subsection"],
Cell[283040, 7693, 105, 1, 106, "Text"],
Cell[283148, 7696, 1109, 30, 166, "Input"],
Cell[284260, 7728, 192, 2, 106, "Text"],
Cell[284455, 7732, 1207, 33, 246, "Input"],
Cell[285665, 7767, 131, 1, 106, "Text"],
Cell[285799, 7770, 787, 23, 166, "Input"],
Cell[286589, 7795, 134, 1, 106, "Text"],
Cell[286726, 7798, 1860, 54, 321, "Input"],
Cell[288589, 7854, 230, 5, 106, "Text"],
Cell[288822, 7861, 3298, 91, 735, "Input"],
Cell[292123, 7954, 160, 3, 106, "Text"],
Cell[292286, 7959, 5103, 135, 835, "Input"],
Cell[297392, 8096, 667, 13, 110, "Input"],
Cell[CellGroupData[{
Cell[298084, 8113, 250, 6, 110, "Input"],
Cell[298337, 8121, 2344, 68, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[300730, 8195, 371, 10, 35, "Subsection"],
Cell[301104, 8207, 105, 1, 106, "Text"],
Cell[301212, 8210, 1138, 30, 166, "Input"],
Cell[302353, 8242, 240, 3, 106, "Text"],
Cell[302596, 8247, 1308, 35, 246, "Input"],
Cell[303907, 8284, 131, 1, 106, "Text"],
Cell[304041, 8287, 834, 24, 166, "Input"],
Cell[304878, 8313, 134, 1, 106, "Text"],
Cell[305015, 8316, 1898, 54, 321, "Input"],
Cell[306916, 8372, 262, 5, 106, "Text"],
Cell[307181, 8379, 3366, 92, 735, "Input"],
Cell[310550, 8473, 160, 3, 106, "Text"],
Cell[310713, 8478, 5104, 135, 835, "Input"],
Cell[315820, 8615, 718, 14, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[316575, 8634, 310, 10, 35, "Subsection"],
Cell[316888, 8646, 104, 1, 106, "Text"],
Cell[316995, 8649, 1096, 30, 166, "Input"],
Cell[318094, 8681, 144, 1, 106, "Text"],
Cell[318241, 8684, 1160, 33, 246, "Input"],
Cell[319404, 8719, 131, 1, 106, "Text"],
Cell[319538, 8722, 735, 22, 166, "Input"],
Cell[320276, 8746, 131, 1, 106, "Text"],
Cell[320410, 8749, 2154, 64, 321, "Input"],
Cell[322567, 8815, 156, 3, 106, "Text"],
Cell[322726, 8820, 3198, 89, 540, "Input"],
Cell[325927, 8911, 4837, 131, 835, "Input"],
Cell[330767, 9044, 572, 12, 110, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[331376, 9061, 310, 10, 35, "Subsection"],
Cell[331689, 9073, 104, 1, 57, "Text"],
Cell[331796, 9076, 1187, 31, 110, "Input"],
Cell[332986, 9109, 133, 1, 57, "Text"],
Cell[333122, 9112, 1242, 34, 110, "Input"],
Cell[334367, 9148, 126, 1, 57, "Text"],
Cell[334496, 9151, 765, 23, 110, "Input"],
Cell[335264, 9176, 125, 1, 57, "Text"],
Cell[335392, 9179, 2195, 63, 193, "Input"],
Cell[337590, 9244, 154, 3, 57, "Text"],
Cell[337747, 9249, 3128, 88, 310, "Input"],
Cell[340878, 9339, 4915, 132, 352, "Input"],
Cell[345796, 9473, 665, 13, 58, "Input"],
Cell[346464, 9488, 1139, 29, 100, "Input"],
Cell[347606, 9519, 1294, 39, 100, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[348937, 9563, 149, 2, 35, "Subsection"],
Cell[349089, 9567, 2421, 61, 289, "Input"],
Cell[351513, 9630, 91, 1, 37, "Text"],
Cell[351607, 9633, 311, 7, 38, "Input"],
Cell[351921, 9642, 875, 23, 64, "Input"],
Cell[352799, 9667, 1428, 42, 189, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
