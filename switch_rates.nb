(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    106446,       3158]
NotebookOptionsPosition[    102700,       3037]
NotebookOutlinePosition[    103041,       3052]
CellTagsIndexPosition[    102998,       3049]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Evolving environmental change", "Title",
 CellChangeTimes->{{3.6827638644330893`*^9, 3.682763868848737*^9}}],

Cell["1 individual per patch", "Text",
 CellChangeTimes->{{3.682763888272765*^9, 3.682763896263945*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.682768388206812*^9, 3.68276839468965*^9}}],

Cell[CellGroupData[{

Cell["Patch frequency", "Section",
 CellChangeTimes->{{3.682763884152597*^9, 3.68276388617667*^9}}],

Cell[CellGroupData[{

Cell["Differential equations", "Subsection",
 CellChangeTimes->{{3.682768303285231*^9, 3.6827683107648973`*^9}}],

Cell["Determine whether individual is z1 or z2", "Text",
 CellChangeTimes->{{3.682768626045609*^9, 3.682768636837356*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phen", "[", 
    RowBox[{"ei_", ",", "state_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "state", "}"}], ",", "a"}], "]"}], ">", "0"}], "&&", 
       RowBox[{"ei", "\[Equal]", "1"}]}], "||", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", "state", "}"}], ",", "m"}], "]"}], ">", "0"}], "&&", 
       RowBox[{"ei", "\[Equal]", "2"}]}]}], ",", "1", ",", "2"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682768616543724*^9, 3.682768648193602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pa", "[", 
   RowBox[{"ei_", ",", "state_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Return", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ei", "\[Equal]", "1"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"phen", "[", 
         RowBox[{"ei", ",", "state"}], "]"}], "]"}], ",", 
       RowBox[{"1", "-", 
        RowBox[{"p", "[", 
         RowBox[{"phen", "[", 
          RowBox[{"ei", ",", "state"}], "]"}], "]"}]}]}], "]"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ei", "\[Equal]", "1"}], ",", 
          RowBox[{"p", "[", 
           RowBox[{"phen", "[", 
            RowBox[{"ex", ",", "statex"}], "]"}], "]"}], ",", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"phen", "[", 
             RowBox[{"ex", ",", "statex"}], "]"}], "]"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6827673915286417`*^9, 3.68276742478113*^9}, {
  3.6827675702751226`*^9, 3.682767646762702*^9}, {3.682767681043479*^9, 
  3.6827677700590687`*^9}, {3.6827678199712048`*^9, 3.682767927035509*^9}, {
  3.682768442512026*^9, 3.682768471230925*^9}, {3.6827685325024157`*^9, 
  3.682768540932166*^9}, {3.682768603300664*^9, 3.682768614061735*^9}, {
  3.682768646291939*^9, 3.6827687209146643`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pa", "[", 
  RowBox[{"1", ",", "m"}], "]"}]], "Input",
 CellChangeTimes->{{3.68276923122064*^9, 3.6827692333149567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"p", "[", "2", "]"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "a"}], "]"}], " ", 
      RowBox[{"p", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "m"}], "]"}], " ", 
      RowBox[{"p", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "m"}], "]"}], " ", 
      RowBox[{"p", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a"}], "]"}], " ", 
      RowBox[{"p", "[", "2", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.68276923359488*^9, 3.6827694063591967`*^9, 3.6827694366202707`*^9, 
   3.682770577385211*^9, {3.682788836506572*^9, 3.68278886305239*^9}, 
   3.682788902017569*^9, 3.6827891998391848`*^9, 3.682789422287826*^9, 
   3.682789636994791*^9, 3.682790888130117*^9, 3.682790989797842*^9, 
   3.682792507790913*^9, {3.682792599815382*^9, 3.682792618036566*^9}, 
   3.682837092962688*^9, 3.683016322768654*^9, 3.6830164954285707`*^9, 
   3.683016700378866*^9, 3.683016879041841*^9, 3.683017350277113*^9, 
   3.683017464661296*^9, 3.683019425513064*^9, 3.683019486917809*^9, 
   3.683019566622244*^9, 3.683020357082395*^9, 3.683020574878606*^9, 
   3.683021716219266*^9, 3.683028415474286*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nu", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "+", 
   RowBox[{"k", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}], "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.6827884191114492`*^9, 3.6827884698944073`*^9}, {
   3.682788505405492*^9, 3.682788511598352*^9}, {3.682788580329287*^9, 
   3.682788581440958*^9}, {3.6827886293630857`*^9, 3.682788653045253*^9}, 
   3.6827887360673*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df1adt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], " ", 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "m"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"pa", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"pa", "[", 
      RowBox[{"1", ",", "m"}], "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "m"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682766805301547*^9, 3.682766817481395*^9}, {
   3.6827668798*^9, 3.682766885423793*^9}, {3.682767169170526*^9, 
   3.6827672988462353`*^9}, 3.6827673866681623`*^9, {3.6827693749460897`*^9, 
   3.682769389654607*^9}, {3.682788161087639*^9, 3.682788165823213*^9}, {
   3.682788274804131*^9, 3.682788339687872*^9}, {3.682788383606764*^9, 
   3.682788414922187*^9}, {3.682788714644362*^9, 3.682788714930736*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df1mdt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], 
     RowBox[{"s", "[", "2", "]"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "a"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "m"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"pa", "[", 
      RowBox[{"1", ",", "m"}], "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "m"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"pa", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682767388408317*^9, 3.6827673885641537`*^9}, {
   3.68276800391866*^9, 3.682768045508753*^9}, {3.682769394583363*^9, 
   3.682769397006249*^9}, {3.6827882794099617`*^9, 3.6827883915647078`*^9}, {
   3.682788678401025*^9, 3.6827886837124166`*^9}, 3.682788720591032*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"df2adt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", "\[Rule]", "1"}], ",", 
     RowBox[{"k", "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
     RowBox[{
      RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}], "}"}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "4"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "4"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "4"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", 
      RowBox[{"1", "/", "4"}]}]}], "}"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.683016337899499*^9, 3.683016383925825*^9}, {
   3.6830164821386137`*^9, 3.683016488681697*^9}, {3.683016665680129*^9, 
   3.6830166925121593`*^9}, {3.683016870870768*^9, 3.683016874789014*^9}, {
   3.683017345067685*^9, 3.68301734568939*^9}, {3.683017457688661*^9, 
   3.6830174603592987`*^9}, {3.683019429739964*^9, 3.683019447001114*^9}, {
   3.68301948210079*^9, 3.683019482328404*^9}, {3.68301956203368*^9, 
   3.683019562263832*^9}, {3.6830203501831408`*^9, 3.683020350381001*^9}, 
   3.683020569324643*^9, 3.6830217117610683`*^9, {3.6830217467748337`*^9, 
   3.683021759167398*^9}}],

Cell[BoxData["df2adt"], "Output",
 CellChangeTimes->{{3.683016339591024*^9, 3.683016384435462*^9}, 
   3.683016495536484*^9, 3.683016700393394*^9, 3.683016879106238*^9, 
   3.683017350372692*^9, 3.6830174647738953`*^9, {3.683019425595789*^9, 
   3.6830194475268707`*^9}, {3.683019486991935*^9, 3.683019494540307*^9}, {
   3.683019566689843*^9, 3.683019570003338*^9}, {3.6830203571699*^9, 
   3.6830203610738773`*^9}, {3.683020574958273*^9, 3.683020579556819*^9}, {
   3.68302171629845*^9, 3.683021718635941*^9}, 3.683021759541648*^9, 
   3.683028415569264*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"df2adt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], " ", 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "m"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "a"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"pa", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}], 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "a"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"pa", "[", 
      RowBox[{"2", ",", "m"}], "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "m"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682768048234853*^9, 3.6827680949396276`*^9}, {
   3.68276939999916*^9, 3.6827694012230387`*^9}, {3.682788301394486*^9, 
   3.6827883977316236`*^9}, {3.68278869090585*^9, 3.682788693507311*^9}, 
   3.682788724070685*^9, {3.6827888888634863`*^9, 3.6827888894392767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"df2mdt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], " ", 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "m"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"pa", "[", 
      RowBox[{"2", ",", "m"}], "]"}], 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "m"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"pa", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}], 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "a"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682768096679983*^9, 3.682768155843134*^9}, {
   3.682788303888438*^9, 3.68278832935038*^9}, {3.682788369238825*^9, 
   3.68278836999865*^9}, 3.682788403421238*^9, {3.682788699846263*^9, 
   3.682788726854998*^9}, {3.682788892829587*^9, 3.6827888928833227`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving for equilibrium patch frequencies", "Subsection",
 CellChangeTimes->{{3.682770596465253*^9, 3.68277060295327*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anstest", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"df1adt", "\[Equal]", "0"}], ",", 
       RowBox[{"df1mdt", "\[Equal]", "0"}], ",", 
       RowBox[{"df2adt", "\[Equal]", "0"}]}], "}"}], "/.", "fconst"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
      RowBox[{
       RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
      RowBox[{"d", "\[Rule]", "ds"}], ",", 
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
      RowBox[{
       RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "0.25"}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "0.25"}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "0.25"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.682768848221097*^9, 3.682768998106976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_", ",", "zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "ks_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"df1adt", "\[Equal]", "0"}], ",", 
       RowBox[{"df1mdt", "\[Equal]", "0"}], ",", 
       RowBox[{"df2adt", "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a"}], "]"}], "+", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a"}], "]"}], "+", 
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "m"}], "]"}], "+", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "m"}], "]"}]}], "\[Equal]", "1"}]}], "}"}], "/.", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
       RowBox[{
        RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "zs1"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "zs2"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "a"}], "]"}], ",", "0.25"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"2", ",", "a"}], "]"}], ",", "0.25"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "m"}], "]"}], ",", "0.25"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"2", ",", "m"}], "]"}], ",", "0.25"}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682768848221097*^9, 3.682769038470108*^9}, {
  3.68276913357165*^9, 3.682769182355651*^9}, {3.682788752653775*^9, 
  3.682788798280837*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansalt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_", ",", "zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "ks_", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"df2mdt", "\[Equal]", "0"}], ",", 
       RowBox[{"df1mdt", "\[Equal]", "0"}], ",", 
       RowBox[{"df2adt", "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a"}], "]"}], "+", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a"}], "]"}], "+", 
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "m"}], "]"}], "+", 
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "m"}], "]"}]}], "\[Equal]", "1"}]}], "}"}], "/.", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
       RowBox[{
        RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
       RowBox[{"d", "\[Rule]", "ds"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
       RowBox[{
        RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "zs1"}], ",", 
       RowBox[{
        RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "zs2"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "a"}], "]"}], ",", "0.25"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"2", ",", "a"}], "]"}], ",", "0.25"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "m"}], "]"}], ",", "0.25"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"2", ",", "m"}], "]"}], ",", "0.25"}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682768848221097*^9, 3.682769038470108*^9}, {
   3.68276913357165*^9, 3.682769182355651*^9}, {3.682769418229239*^9, 
   3.6827694245109987`*^9}, 3.6827888070643053`*^9, {3.682788853710979*^9, 
   3.682788855893478*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1.2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.55"}], "}"}], ",", 
   RowBox[{"{", "0.3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.1", ",", "0.3", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682768945860664*^9, 3.682768959924099*^9}, {
  3.682769110243471*^9, 3.6827691110004253`*^9}, {3.682769200696623*^9, 
  3.682769201375626*^9}, {3.682788812854828*^9, 3.682788823053809*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "0.08427476861652906`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "0.3592887086668769`"}], ",", 
   
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "0.08813902448691925`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "0.4682974982296748`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.682768960301362*^9, 3.682768992611936*^9, 3.682769042042082*^9, 
   3.682769111592382*^9, {3.682769155231983*^9, 3.682769202228785*^9}, 
   3.682769406475606*^9, 3.682769436702003*^9, 3.682770577452641*^9, {
   3.682788836691828*^9, 3.682788863189314*^9}, 3.6827889021681833`*^9, 
   3.682789200048193*^9, 3.6827894224985437`*^9, 3.682789637227326*^9, 
   3.682790888248399*^9, 3.682790989891852*^9, 3.682792508064386*^9, {
   3.682792599910986*^9, 3.682792618144018*^9}, 3.682837093193513*^9, 
   3.683028415657215*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansalt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1.2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.55"}], "}"}], ",", 
   RowBox[{"{", "0.3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.1", ",", "0.3", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682768945860664*^9, 3.682768959924099*^9}, {
  3.682769110243471*^9, 3.6827691110004253`*^9}, {3.682769200696623*^9, 
  3.682769201375626*^9}, {3.68276943225176*^9, 3.682769432481248*^9}, {
  3.682788826476562*^9, 3.6827888299247713`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "0.08427476861652905`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "0.3592887086668769`"}], ",", 
   
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "0.08813902448691924`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "0.4682974982296748`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.682768960301362*^9, 3.682768992611936*^9, 3.682769042042082*^9, 
   3.682769111592382*^9, {3.682769155231983*^9, 3.682769202228785*^9}, {
   3.682769406475606*^9, 3.682769436737947*^9}, 3.682770577479863*^9, {
   3.6827888367584677`*^9, 3.682788863231625*^9}, 3.682788902212552*^9, 
   3.68278920010533*^9, 3.682789422550351*^9, 3.682789637273903*^9, 
   3.6827908882824373`*^9, 3.6827909899129457`*^9, 3.682792508118969*^9, {
   3.682792599939076*^9, 3.6827926181771584`*^9}, 3.6828370932525454`*^9, 
   3.68302841573599*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reproductive values", "Section",
 CellChangeTimes->{{3.6827694506270638`*^9, 3.682769454091098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv1adt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", "1", "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], "d", " ", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827695786509733`*^9, 3.682769718119273*^9}, {
  3.682769840712222*^9, 3.6827698885945377`*^9}, {3.682770124797146*^9, 
  3.682770129215046*^9}, {3.682770257967051*^9, 3.682770302290698*^9}, {
  3.6827889262639923`*^9, 3.682788972714546*^9}, {3.682789256910828*^9, 
  3.682789257460292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv1mdt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"p", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682769891045833*^9, 3.6827699162614727`*^9}, {
   3.682770090932701*^9, 3.682770121047059*^9}, 3.6827702552540617`*^9, {
   3.682770314069001*^9, 3.682770328930175*^9}, {3.682776140375333*^9, 
   3.6827761417930603`*^9}, {3.682789042524041*^9, 3.6827890702514563`*^9}, {
   3.6827892549086742`*^9, 3.682789255091359*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv2adt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"p", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827703314841537`*^9, 3.6827703408350077`*^9}, {
  3.682770375026702*^9, 3.682770466829452*^9}, {3.682789079712366*^9, 
  3.6827890989639587`*^9}, {3.682789253053019*^9, 3.682789253221051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv2mdt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", "1", "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827703314841537`*^9, 3.6827703408350077`*^9}, {
  3.682770375026702*^9, 3.682770485197935*^9}, {3.6827705315898237`*^9, 
  3.682770571268989*^9}, {3.682789104249457*^9, 3.6827891206236753`*^9}, {
  3.682789222792787*^9, 3.682789222944289*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dv1adt", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.683028429775833*^9, 3.683028459834607*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "d"}], " ", 
   RowBox[{"mu", "[", "a", "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "a"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "d"}], ")"}], " ", 
   RowBox[{"mu", "[", "a", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a"}], "]"}]}], "+", 
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"s", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a"}], "]"}]}], "+", 
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "a"}], "]"}], " ", 
      RowBox[{"mu", "[", "a", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"1", ",", "a"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"1", ",", "m"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "m"}], "]"}], " ", 
      RowBox[{"mu", "[", "m", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"1", ",", "a"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"1", ",", "m"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a"}], "]"}], " ", 
      RowBox[{"mu", "[", "a", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"2", ",", "a"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"2", ",", "m"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "m"}], "]"}], " ", 
      RowBox[{"mu", "[", "m", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"2", ",", "a"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{"2", ",", "m"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.683028427261037*^9, 3.683028460234742*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving for equilibrium reproductive values", "Subsection",
 CellChangeTimes->{{3.6827706144569607`*^9, 3.682770618888837*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vconst", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "a"}], "]"}], 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a"}], "]"}], 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "a"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "m"}], "]"}], 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "m"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "m"}], "]"}], 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "m"}], "]"}]}]}], "\[Equal]", "1"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682770624233438*^9, 3.682770659036252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRValt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_", ",", "zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "ks_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "patchfreq", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"patchfreq", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mum", ",", "mua"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], ",", 
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s1", ",", "s2", ",", "zs1", ",", "zs2"}], "}"}], ",", 
        RowBox[{"{", "ks", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dv1adt", "\[Equal]", "0"}], ",", 
           RowBox[{"dv1mdt", "\[Equal]", "0"}], ",", 
           RowBox[{"dv2adt", "\[Equal]", "0"}], ",", "vconst"}], "}"}], "/.", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
           RowBox[{
            RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
           RowBox[{"d", "\[Rule]", "ds"}], ",", 
           RowBox[{
            RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
           RowBox[{
            RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
           RowBox[{
            RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "zs1"}], ",", 
           RowBox[{
            RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "zs2"}], ",", 
           RowBox[{"k", "\[Rule]", "ks"}]}], "}"}]}], "/.", "patchfreq"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "a"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "a"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "m"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "m"}], "]"}], ",", "1"}], "}"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682768848221097*^9, 3.682769038470108*^9}, {
  3.68276913357165*^9, 3.682769182355651*^9}, {3.682769418229239*^9, 
  3.6827694245109987`*^9}, {3.682770679204117*^9, 3.682770728175935*^9}, {
  3.682771268508471*^9, 3.682771334635438*^9}, {3.682789128306673*^9, 
  3.682789152757839*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansRV", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mum_", ",", "mua_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
    RowBox[{"{", "ds_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_", ",", "zs1_", ",", "zs2_"}], "}"}], ",", 
    RowBox[{"{", "ks_", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "patchfreq", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"patchfreq", "=", 
      RowBox[{"ans", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mum", ",", "mua"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], ",", 
        RowBox[{"{", "ds", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s1", ",", "s2", ",", "zs1", ",", "zs2"}], "}"}], ",", 
        RowBox[{"{", "ks", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dv2mdt", "\[Equal]", "0"}], ",", 
           RowBox[{"dv1adt", "\[Equal]", "0"}], ",", 
           RowBox[{"dv2adt", "\[Equal]", "0"}], ",", "vconst"}], "}"}], "/.", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"mu", "[", "m", "]"}], "\[Rule]", "mum"}], ",", 
           RowBox[{
            RowBox[{"mu", "[", "a", "]"}], "\[Rule]", "mua"}], ",", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], "\[Rule]", "p1"}], ",", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], "\[Rule]", "p2"}], ",", 
           RowBox[{"d", "\[Rule]", "ds"}], ",", 
           RowBox[{
            RowBox[{"s", "[", "1", "]"}], "\[Rule]", "s1"}], ",", 
           RowBox[{
            RowBox[{"s", "[", "2", "]"}], "\[Rule]", "s2"}], ",", 
           RowBox[{
            RowBox[{"zs", "[", "1", "]"}], "\[Rule]", "zs1"}], ",", 
           RowBox[{
            RowBox[{"zs", "[", "2", "]"}], "\[Rule]", "zs2"}], ",", 
           RowBox[{"k", "\[Rule]", "ks"}]}], "}"}]}], "/.", "patchfreq"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "a"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "a"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "m"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "m"}], "]"}], ",", "1"}], "}"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682768848221097*^9, 3.682769038470108*^9}, {
  3.68276913357165*^9, 3.682769182355651*^9}, {3.682769418229239*^9, 
  3.6827694245109987`*^9}, {3.682770679204117*^9, 3.682770728175935*^9}, {
  3.682771268508471*^9, 3.682771347499242*^9}, {3.682775306862702*^9, 
  3.682775307953706*^9}, {3.682789158731008*^9, 3.682789175102509*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansRV", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1.8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.55"}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.1", ",", "0.3", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682768945860664*^9, 3.682768959924099*^9}, {
  3.682769110243471*^9, 3.6827691110004253`*^9}, {3.682769200696623*^9, 
  3.682769201375626*^9}, {3.6827713526202593`*^9, 3.682771379474493*^9}, {
  3.682774969711666*^9, 3.682774969956497*^9}, {3.682775051749898*^9, 
  3.682775060666423*^9}, {3.682789179676941*^9, 3.682789182642201*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "0.950235143451057`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "0.9817691574242644`"}], ",", 
   
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "0.9844581718500356`"}], ",", 
   
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "1.02503989505449`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.682768960301362*^9, 3.682768992611936*^9, 3.682769042042082*^9, 
   3.682769111592382*^9, {3.682769155231983*^9, 3.682769202228785*^9}, 
   3.682769406475606*^9, 3.682769436702003*^9, 3.682770577452641*^9, {
   3.682771354983201*^9, 3.68277138368426*^9}, 3.68277497400532*^9, 
   3.6827750612899523`*^9, 3.682775312702305*^9, 3.6827761491887093`*^9, 
   3.682789200437587*^9, 3.682789263145055*^9, 3.682789422663824*^9, 
   3.682789637394553*^9, 3.6827908883658743`*^9, 3.682790990014633*^9, 
   3.682792508214138*^9, {3.682792600024199*^9, 3.68279261825775*^9}, 
   3.682837093327888*^9, 3.6830284158511267`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ansRValt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1.8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.55"}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.1", ",", "0.3", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682768945860664*^9, 3.682768959924099*^9}, {
  3.682769110243471*^9, 3.6827691110004253`*^9}, {3.682769200696623*^9, 
  3.682769201375626*^9}, {3.68276943225176*^9, 3.682769432481248*^9}, {
  3.682771358164497*^9, 3.6827713767144823`*^9}, {3.682774972256584*^9, 
  3.68277497247656*^9}, {3.6827750558529863`*^9, 3.6827750707135963`*^9}, {
  3.682789188293253*^9, 3.682789191991747*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "a"}], "]"}], "\[Rule]", "0.9502351434510572`"}], ",", 
   
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "a"}], "]"}], "\[Rule]", "0.9817691574242644`"}], ",", 
   
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "m"}], "]"}], "\[Rule]", "0.9844581718500358`"}], ",", 
   
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "m"}], "]"}], "\[Rule]", "1.02503989505449`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.682768960301362*^9, 3.682768992611936*^9, 3.682769042042082*^9, 
   3.682769111592382*^9, {3.682769155231983*^9, 3.682769202228785*^9}, {
   3.682769406475606*^9, 3.682769436737947*^9}, 3.682770577479863*^9, {
   3.6827713595657797`*^9, 3.682771377181476*^9}, 3.682774976434935*^9, 
   3.682775071402005*^9, 3.682775313644252*^9, 3.682776149294218*^9, 
   3.6827892006619987`*^9, 3.6827892631935797`*^9, 3.6827894227027473`*^9, 
   3.6827896374353952`*^9, 3.682790888400642*^9, 3.68279099004025*^9, 
   3.6827925082458572`*^9, {3.682792600056264*^9, 3.682792618291267*^9}, 
   3.682837093366789*^9, 3.6830284159344788`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection gradients on ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    SubscriptBox["s", "1"]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    SubscriptBox["s", "2"]], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Section",
 CellChangeTimes->{{3.682776240655957*^9, 3.682776243759879*^9}, {
  3.682788132682406*^9, 3.68278813328895*^9}, {3.682789289746978*^9, 
  3.682789308639287*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv1adt\[Delta]zs1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", "1", "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", "1", "]"}]}], ")"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "1", "]"}]}], ")"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", "1", "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "1", "]"}]}], ")"}], "]"}], "d", " ", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827695786509733`*^9, 3.682769718119273*^9}, {
  3.682769840712222*^9, 3.6827698885945377`*^9}, {3.682770124797146*^9, 
  3.682770129215046*^9}, {3.682770257967051*^9, 3.682770302290698*^9}, {
  3.6827889262639923`*^9, 3.682788972714546*^9}, {3.682789256910828*^9, 
  3.682789257460292*^9}, {3.682789314325097*^9, 3.6827893304634523`*^9}, {
  3.682789584732375*^9, 3.6827895884537888`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv1mdt\[Delta]zs1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", "1", "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", "1", "]"}]}], ")"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "1", "]"}]}], ")"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"p", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "1", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "1", "]"}]}], ")"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682769891045833*^9, 3.6827699162614727`*^9}, {
   3.682770090932701*^9, 3.682770121047059*^9}, 3.6827702552540617`*^9, {
   3.682770314069001*^9, 3.682770328930175*^9}, {3.682776140375333*^9, 
   3.6827761417930603`*^9}, {3.682789042524041*^9, 3.6827890702514563`*^9}, {
   3.6827892549086742`*^9, 3.682789255091359*^9}, {3.682789345817491*^9, 
   3.6827893573771353`*^9}, 3.682789591971065*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv2adt\[Delta]zs2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", "2", "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", "2", "]"}]}], ")"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "2", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "2", "]"}]}], ")"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"p", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "2", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "2", "]"}]}], ")"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827703314841537`*^9, 3.6827703408350077`*^9}, {
  3.682770375026702*^9, 3.682770466829452*^9}, {3.682789079712366*^9, 
  3.6827890989639587`*^9}, {3.682789253053019*^9, 3.682789253221051*^9}, {
  3.68278936995886*^9, 3.682789385782818*^9}, {3.682789593858295*^9, 
  3.682789594419519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv2mdt\[Delta]zs2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zs", "[", "2", "]"}], "+", 
       RowBox[{"\[Delta]zs", "[", "2", "]"}]}], ")"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "2", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "2", "]"}]}], ")"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", "1", "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zs", "[", "2", "]"}], "+", 
        RowBox[{"\[Delta]zs", "[", "2", "]"}]}], ")"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827703314841537`*^9, 3.6827703408350077`*^9}, {
  3.682770375026702*^9, 3.682770485197935*^9}, {3.6827705315898237`*^9, 
  3.682770571268989*^9}, {3.682789104249457*^9, 3.6827891206236753`*^9}, {
  3.682789222792787*^9, 3.682789222944289*^9}, {3.682789389343864*^9, 
  3.6827894122131367`*^9}, {3.68278959579001*^9, 3.682789596902966*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dv\[Delta]zs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "a"}], "]"}], 
      RowBox[{"D", "[", 
       RowBox[{"dv1adt\[Delta]zs1", ",", 
        RowBox[{"\[Delta]zs", "[", "1", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "m"}], "]"}], 
      RowBox[{"D", "[", 
       RowBox[{"dv1mdt\[Delta]zs1", ",", 
        RowBox[{"\[Delta]zs", "[", "1", "]"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"\[Delta]zs", "[", "1", "]"}], "\[Rule]", "0"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.682789424009139*^9, 3.682789485796049*^9}, {
  3.6827896022415857`*^9, 3.6827896052501163`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "a"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"1", ",", "a"}], "]"}]}], "+", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "d", " ", "k", " ", 
      RowBox[{"mu", "[", "a", "]"}], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "1", "]"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "k", " ", 
      RowBox[{"mu", "[", "a", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "a"}], "]"}], "-", 
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "m"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "1", "]"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "m"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"1", ",", "m"}], "]"}]}], "+", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "k", " ", 
      RowBox[{"mu", "[", "m", "]"}], " ", 
      RowBox[{"p", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "a"}], "]"}], "-", 
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "m"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "1", "]"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "d", " ", "k", " ", 
      RowBox[{"mu", "[", "m", "]"}], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "m"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "1", "]"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.682789433620594*^9, {3.68278947299157*^9, 3.68278948615483*^9}, 
   3.682789637555604*^9, 3.6827908884713793`*^9, 3.6827909901824217`*^9, 
   3.6827925083162727`*^9, {3.682792600239794*^9, 3.682792618384636*^9}, 
   3.682837093443184*^9, 3.683028416056237*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dv\[Delta]zs2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "a"}], "]"}], 
      RowBox[{"D", "[", 
       RowBox[{"dv2adt\[Delta]zs2", ",", 
        RowBox[{"\[Delta]zs", "[", "2", "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "m"}], "]"}], 
      RowBox[{"D", "[", 
       RowBox[{"dv2mdt\[Delta]zs2", ",", 
        RowBox[{"\[Delta]zs", "[", "2", "]"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"\[Delta]zs", "[", "2", "]"}], "\[Rule]", "0"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6827895719642477`*^9, 3.682789575444037*^9}, {
  3.682789609548036*^9, 3.682789642543296*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "a"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "m"}], "]"}], "-", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "d", " ", "k", " ", 
      RowBox[{"mu", "[", "a", "]"}], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "a"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "2", "]"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "k", " ", 
      RowBox[{"mu", "[", "a", "]"}], " ", 
      RowBox[{"p", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "a"}], "]"}], "-", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "m"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "2", "]"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "m"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "a"}], "]"}], "-", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "k", " ", 
      RowBox[{"mu", "[", "m", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"p", "[", "1", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "a"}], "]"}], "-", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "m"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "2", "]"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "d", " ", "k", " ", 
      RowBox[{"mu", "[", "m", "]"}], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "m"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"zs", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6827896376327553`*^9, 3.682789643392434*^9}, 
   3.682790888517602*^9, 3.682790990242696*^9, 3.6827925083687572`*^9, {
   3.682792600279194*^9, 3.6827926184323807`*^9}, 3.682837093503551*^9, 
   3.6830284162087307`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection on p1, p2", "Section",
 CellChangeTimes->{{3.6827897654828*^9, 3.682789767954774*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv1adt\[Delta]p1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], "+", 
         RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], "d", " ", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827695786509733`*^9, 3.682769718119273*^9}, {
   3.682769840712222*^9, 3.6827698885945377`*^9}, {3.682770124797146*^9, 
   3.682770129215046*^9}, {3.682770257967051*^9, 3.682770302290698*^9}, {
   3.6827889262639923`*^9, 3.682788972714546*^9}, {3.682789256910828*^9, 
   3.682789257460292*^9}, {3.6827897831496696`*^9, 3.6827898205600777`*^9}, 
   3.682789863359096*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv1mdt\[Delta]p2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "1", "]"}], 
     RowBox[{"s", "[", "1", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], "+", 
       RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "1", "]"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "2", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "2", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682769891045833*^9, 3.6827699162614727`*^9}, {
   3.682770090932701*^9, 3.682770121047059*^9}, 3.6827702552540617`*^9, {
   3.682770314069001*^9, 3.682770328930175*^9}, {3.682776140375333*^9, 
   3.6827761417930603`*^9}, {3.682789042524041*^9, 3.6827890702514563`*^9}, {
   3.6827892549086742`*^9, 3.682789255091359*^9}, {3.682789830767522*^9, 
   3.682789876112171*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv2adt\[Delta]p2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], "+", 
       RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "a", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "2", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "2", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "2", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827703314841537`*^9, 3.6827703408350077`*^9}, {
  3.682770375026702*^9, 3.682770466829452*^9}, {3.682789079712366*^9, 
  3.6827890989639587`*^9}, {3.682789253053019*^9, 3.682789253221051*^9}, {
  3.682789881966402*^9, 3.682789918550375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv2mdt\[Delta]p1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"zs", "[", "2", "]"}], 
     RowBox[{"s", "[", "2", "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], "+", 
         RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}], "-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], 
     RowBox[{"nu", "[", 
      RowBox[{"zs", "[", "2", "]"}], "]"}], "d", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"ex", ",", "statex"}], "]"}], 
        RowBox[{"mu", "[", "statex", "]"}], 
        RowBox[{"nu", "[", 
         RowBox[{"zs", "[", "ex", "]"}], "]"}], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ex", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"1", ",", "m"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], "+", 
                RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"\[Delta]p", "[", "1", "]"}]}], ")"}], 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "m"}], "]"}]}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ex", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"statex", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6827703314841537`*^9, 3.6827703408350077`*^9}, {
  3.682770375026702*^9, 3.682770485197935*^9}, {3.6827705315898237`*^9, 
  3.682770571268989*^9}, {3.682789104249457*^9, 3.6827891206236753`*^9}, {
  3.682789222792787*^9, 3.682789222944289*^9}, {3.682789886573709*^9, 
  3.6827898890998507`*^9}, {3.682789929139634*^9, 3.682789952278234*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dvdt\[Delta]p1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "a"}], "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dv1adt\[Delta]p1", ",", 
       RowBox[{"\[Delta]p", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "m"}], "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dv2mdt\[Delta]p1", ",", 
       RowBox[{"\[Delta]p", "[", "1", "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dvdt\[Delta]p2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "m"}], "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dv1mdt\[Delta]p2", ",", 
       RowBox[{"\[Delta]p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "a"}], "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"dv2adt\[Delta]p2", ",", 
       RowBox[{"\[Delta]p", "[", "2", "]"}]}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682789964217968*^9, 3.6827900090485067`*^9}, {
  3.6827901524925413`*^9, 3.682790215846972*^9}}],

Cell[CellGroupData[{

Cell[BoxData["dvdt\[Delta]p2"], "Input",
 CellChangeTimes->{{3.682790219299736*^9, 3.6827902291382093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "m"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"mu", "[", "m", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "a"}], "]"}], "-", 
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "m"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"k", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"zs", "[", "1", "]"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a"}], "]"}], " ", 
         RowBox[{"mu", "[", "a", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "a"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "1", "]"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "m"}], "]"}], " ", 
         RowBox[{"mu", "[", "m", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "a"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "1", "]"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a"}], "]"}], " ", 
         RowBox[{"mu", "[", "a", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "2", "]"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "m"}], "]"}], " ", 
         RowBox[{"mu", "[", "m", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "2", "]"}]}], ")"}], "2"]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "a"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "a"}], "]"}], " ", 
         RowBox[{"mu", "[", "a", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "a"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "1", "]"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "m"}], "]"}], " ", 
         RowBox[{"mu", "[", "m", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "a"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "1", "]"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "a"}], "]"}], " ", 
         RowBox[{"mu", "[", "a", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "2", "]"}]}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"2", ",", "m"}], "]"}], " ", 
         RowBox[{"mu", "[", "m", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"v", "[", 
             RowBox[{"2", ",", "a"}], "]"}]}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "m"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"k", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"zs", "[", "2", "]"}]}], ")"}], "2"]}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "d"}], ")"}], " ", 
      RowBox[{"mu", "[", "a", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"2", ",", "a"}], "]"}]}], "+", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "m"}], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"k", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"zs", "[", "2", "]"}]}], ")"}], "2"]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6827901726639233`*^9, 3.682790230039369*^9}, 
   3.682790888573217*^9, 3.682790990292053*^9, 3.682792508422213*^9, {
   3.682792600336831*^9, 3.682792618487915*^9}, 3.682837093564006*^9, 
   3.683028416611373*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export to C for numerical iterations\
\>", "Section",
 CellChangeTimes->{{3.682789698615266*^9, 3.682789708221863*^9}}],

Cell["\<\
Directory for the exported files\
\>", "Text",
 CellChangeTimes->{{3.6827897268767242`*^9, 3.6827897361085033`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/switch_rates/src/numerical/s1s2/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toC", "[", "str_", "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", "str", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682789737490488*^9, 3.68278975607978*^9}, {
  3.6827902410896673`*^9, 3.6827902431701603`*^9}, {3.682790331382429*^9, 
  3.682790344876502*^9}}],

Cell["Patch frequencies", "Text",
 CellChangeTimes->{{3.6827897156456833`*^9, 3.6827897196132*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<double f1atplus1, f1mtplus1, f2atplus1, f2mtplus1;\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", "\"\<for (int iter=0; iter<1e08; ++iter) {\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<f1atplus1 = bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"f1a", "+", 
      RowBox[{"0.01", "*", "df1adt"}]}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<f1mtplus1 = bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"f1m", "+", 
      RowBox[{"0.01", "*", "df1mdt"}]}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<f2atplus1 = bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"f2a", "+", 
      RowBox[{"0.01", "*", "df2adt"}]}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<f2mtplus1 = bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"f2m", "+", 
      RowBox[{"0.01", "*", "df2mdt"}]}], "]"}], "<>", "\"\<);\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(f1atplus1 - f1a) < 1e-07 && fabs(f2atplus1 - f2a) < 1e-07 \
&& fabs(f1mtplus1 - f1m) < 1e-07 && fabs(f2mtplus1 - f2m) < 1e-07) \
{\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<break;\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<}\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<f1a = f1atplus1;\\nf2a = f2atplus1;\\nf1m = f1mtplus1;\\nf2m = \
f2mtplus1;\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<}\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f, 0, f1a);\\ngsl_vector_set(f, 1, \
f2a);\\ngsl_vector_set(f, 2, f1m);\\ngsl_vector_set(f, 3, f2m);\\n\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6827902469431267`*^9, 3.6827903961329393`*^9}, {
  3.68279045538764*^9, 3.682790612353447*^9}, {3.6827906511096697`*^9, 
  3.682790652087944*^9}, {3.682790698750043*^9, 3.6827907697864647`*^9}, {
  3.682790932188768*^9, 3.682791005539283*^9}, {3.682791089305035*^9, 
  3.68279111423083*^9}, {3.6827926146030817`*^9, 3.682792615699706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"dir", "<>", "\"\<patchrecurs.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682789722862713*^9, 3.682789723751486*^9}, {
  3.682790776559287*^9, 3.682790783864439*^9}, {3.682790881171773*^9, 
  3.68279091384346*^9}}],

Cell["Reproductive values", "Text",
 CellChangeTimes->{{3.682791012522871*^9, 3.682791014490178*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<double v1atplus1, v2atplus1, v1mtplus1, v2mtplus1;\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", "\"\<for (int iter=0; iter<1e08; ++iter) {\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<v1atplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "a"}], "]"}], "+", 
      RowBox[{"0.01", " ", "dv1adt"}]}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<v2atplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "a"}], "]"}], "+", 
      RowBox[{"0.01", " ", "dv2adt"}]}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<v1mtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "m"}], "]"}], "+", 
      RowBox[{"0.01", " ", "dv1mdt"}]}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<v2mtplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "m"}], "]"}], "+", 
      RowBox[{"0.01", " ", "dv2mdt"}]}], "]"}], "<>", "\"\<;\\n\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<if (fabs(v1atplus1 - v1a) < 1e-07 && fabs(v2atplus1 - v2a) < 1e-07 \
&& fabs(v1mtplus1-v1m) < 1e-07 && fabs(v2mtplus1-v2m)) {\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<break;\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<}\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<v1a=v1atplus1;\\nv2a=v2atplus1;\\nv1m=v1mtplus1;\\nv2m=v2mtplus1;\\n\
\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<}\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f, 0, v1a);\\ngsl_vector_set(f, 1, \
v2a);\\ngsl_vector_set(f, 2, v1m);\\ngsl_vector_set(f, 3, v2m);\\n\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"dir", "<>", "\"\<repvals.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682791018889832*^9, 3.682791081738611*^9}, {
  3.682791120914106*^9, 3.682791351384303*^9}, {3.682792611284843*^9, 
  3.6827926117796307`*^9}, {3.682792646419422*^9, 3.6827926467981*^9}}],

Cell["Selection gradients", "Text",
 CellChangeTimes->{{3.68279135567551*^9, 3.682791363473833*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double zs1tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"zs1", "+", 
      RowBox[{"0.01", "*", "dv\[Delta]zs1"}]}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double zs2tplus1 = \>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"zs2", "+", 
      RowBox[{"0.01", "*", "dv\[Delta]zs2"}]}], "]"}], "<>", 
    "\"\<;\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double p1tplus1 = bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"p1", "+", 
      RowBox[{"0.01", "*", "dvdt\[Delta]p1"}]}], "]"}], "<>", 
    "\"\<);\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{"str", "<>", "\"\<double p2tplus1 = bound(\>\"", "<>", 
    RowBox[{"toC", "[", 
     RowBox[{"p2", "+", 
      RowBox[{"0.01", "*", "dvdt\[Delta]p2"}]}], "]"}], "<>", 
    "\"\<);\\n\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", 
   RowBox[{
   "str", "<>", 
    "\"\<gsl_vector_set(f, 0, zs1tplus1);\\ngsl_vector_set(f, 1, \
zs2tplus1);\\ngsl_vector_set(f, 2, p1tplus1);\\ngsl_vector_set(f, 3, \
p2tplus1);\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"dir", "<>", "\"\<selgrad.txt\>\""}], ",", "str"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.682791364582546*^9, 3.682791406099321*^9}, {
   3.68279144656254*^9, 3.6827916096197557`*^9}, 3.6827925977719707`*^9, {
   3.6828370900923862`*^9, 3.682837090136817*^9}}],

Cell["Parameters", "Text",
 CellChangeTimes->{{3.68279161412716*^9, 3.682791615861644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printIt", "[", "x_", "]"}], ":=", 
   RowBox[{"\"\<double \>\"", "<>", 
    RowBox[{"toC", "[", "x", "]"}], "<>", "\"\<;\\n\>\""}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682791732865602*^9, 3.682791753923362*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mu", "[", "m", "]"}], ",", 
     RowBox[{"mu", "[", "a", "]"}], ",", "d", ",", 
     RowBox[{"s", "[", "1", "]"}], ",", 
     RowBox[{"s", "[", "2", "]"}], ",", "k"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"pars", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"zs", "[", "1", "]"}], ",", 
       RowBox[{"zs", "[", "2", "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "a"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "a"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "m"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"2", ",", "m"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "a"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"1", ",", "m"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "a"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"2", ",", "m"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682791618416059*^9, 3.682791711864233*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ix", "=", "1"}], ",", 
    RowBox[{"ix", "\[LessEqual]", 
     RowBox[{"Length", "[", "pars", "]"}]}], ",", 
    RowBox[{"++", "ix"}], ",", 
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"printIt", "[", 
       RowBox[{"pars", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"dir", "<>", "\"\<params.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", "=", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ix", "=", "1"}], ",", 
    RowBox[{"ix", "\[LessEqual]", 
     RowBox[{"Length", "[", "variables", "]"}]}], ",", 
    RowBox[{"++", "ix"}], ",", 
    RowBox[{"str", "=", 
     RowBox[{"str", "<>", 
      RowBox[{"printIt", "[", 
       RowBox[{"variables", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"dir", "<>", "\"\<variables.txt\>\""}], ",", "str"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6827917566100817`*^9, 3.6827918647221117`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{Automatic, -11}, {Automatic, 152}},
FrontEndVersion->"7.0 for Linux x86 (64-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 114, 1, 84, "Title"],
Cell[684, 25, 104, 1, 31, "Text"],
Cell[791, 28, 138, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[954, 34, 99, 1, 73, "Section"],
Cell[CellGroupData[{
Cell[1078, 39, 112, 1, 39, "Subsection"],
Cell[1193, 42, 122, 1, 31, "Text"],
Cell[1318, 45, 683, 21, 32, "Input"],
Cell[2004, 68, 1784, 47, 55, "Input"],
Cell[CellGroupData[{
Cell[3813, 119, 145, 3, 32, "Input"],
Cell[3961, 124, 1422, 35, 31, "Output"]
}, Open  ]],
Cell[5398, 162, 443, 11, 32, "Input"],
Cell[5844, 175, 1389, 37, 32, "Input"],
Cell[7236, 214, 1249, 35, 32, "Input"],
Cell[CellGroupData[{
Cell[8510, 253, 1751, 46, 32, "Input"],
Cell[10264, 301, 560, 8, 31, "Output"]
}, Open  ]],
Cell[10839, 312, 1250, 35, 32, "Input"],
Cell[12092, 349, 1242, 35, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13371, 389, 128, 1, 39, "Subsection"],
Cell[13502, 392, 1564, 46, 55, "Input"],
Cell[15069, 440, 2525, 72, 77, "Input"],
Cell[17597, 514, 2606, 73, 77, "Input"],
Cell[CellGroupData[{
Cell[20228, 591, 553, 13, 32, "Input"],
Cell[20784, 606, 1063, 25, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21884, 636, 606, 14, 32, "Input"],
Cell[22493, 652, 1069, 25, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23623, 684, 106, 1, 73, "Section"],
Cell[23732, 687, 2751, 81, 55, "Input"],
Cell[26486, 770, 2721, 79, 55, "Input"],
Cell[29210, 851, 2593, 77, 55, "Input"],
Cell[31806, 930, 2699, 80, 55, "Input"],
Cell[CellGroupData[{
Cell[34530, 1014, 294, 8, 32, "Input"],
Cell[34827, 1024, 3024, 98, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37888, 1127, 133, 1, 39, "Subsection"],
Cell[38024, 1130, 781, 26, 32, "Input"],
Cell[38808, 1158, 3093, 81, 121, "Input"],
Cell[41904, 1241, 3136, 81, 121, "Input"],
Cell[CellGroupData[{
Cell[45065, 1326, 701, 15, 32, "Input"],
Cell[45769, 1343, 1155, 27, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46961, 1375, 755, 16, 32, "Input"],
Cell[47719, 1393, 1170, 28, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48950, 1428, 490, 16, 76, "Section"],
Cell[49443, 1446, 3158, 91, 55, "Input"],
Cell[52604, 1539, 3103, 89, 55, "Input"],
Cell[55710, 1630, 2998, 88, 55, "Input"],
Cell[58711, 1720, 3103, 90, 55, "Input"],
Cell[CellGroupData[{
Cell[61839, 1814, 736, 21, 32, "Input"],
Cell[62578, 1837, 2802, 85, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65417, 1927, 734, 21, 32, "Input"],
Cell[66154, 1950, 2707, 82, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68910, 2038, 102, 1, 73, "Section"],
Cell[69015, 2041, 3423, 97, 55, "Input"],
Cell[72441, 2140, 3357, 95, 55, "Input"],
Cell[75801, 2237, 3228, 93, 55, "Input"],
Cell[79032, 2332, 3388, 96, 55, "Input"],
Cell[82423, 2430, 1101, 33, 55, "Input"],
Cell[CellGroupData[{
Cell[83549, 2467, 108, 1, 32, "Input"],
Cell[83660, 2470, 6995, 209, 104, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90704, 2685, 129, 3, 73, "Section"],
Cell[90836, 2690, 126, 3, 31, "Text"],
Cell[90965, 2695, 512, 14, 55, "Input"],
Cell[91480, 2711, 99, 1, 31, "Text"],
Cell[91582, 2714, 2797, 75, 297, "Input"],
Cell[94382, 2791, 319, 8, 32, "Input"],
Cell[94704, 2801, 101, 1, 31, "Text"],
Cell[94808, 2804, 2983, 86, 319, "Input"],
Cell[97794, 2892, 100, 1, 31, "Text"],
Cell[97897, 2895, 1755, 45, 165, "Input"],
Cell[99655, 2942, 91, 1, 31, "Text"],
Cell[99749, 2945, 265, 7, 32, "Input"],
Cell[100017, 2954, 1275, 36, 55, "Input"],
Cell[101295, 2992, 1377, 41, 165, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
