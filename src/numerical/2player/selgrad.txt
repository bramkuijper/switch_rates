double p1tplus1 = bound01(p1 + eul * (-((1 - d)*f(1,a,m)*mu(a)*ram(1)*(-v(1,m,a) + v(1,m,m))*(1 + k*Power(zs(1),2)))/2. - ((1 - d)*f(2,a,m)*mu(m)*ram(2)*(v(2,a,a) - v(2,a,m))*(1 + k*Power(zs(2),2)))/2. + 2*f(1,a,a)*(-((1 - d)*mu(a)*raa(1)*(-v(1,a,a) + v(1,a,m))*(1 + k*Power(zs(1),2)))/2. + ((1 - d)*mu(a)*(2*v(1,a,a) - v(1,a,m) - v(1,m,a))*(1 + k*Power(zs(1),2)))/2. - ((1 - d)*mu(a)*(-v(1,a,a) + v(1,m,a))*(1 + k*Power(zs(1),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.) + f(1,a,m)*(((1 - d)*mu(m)*(2*v(1,a,a) - v(1,a,m) - v(1,m,a))*(1 + k*Power(zs(1),2)))/2. - ((1 - d)*mu(a)*(-v(1,a,m) + v(1,m,m))*(1 + k*Power(zs(1),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.) + f(2,a,m)*(-((1 - d)*mu(m)*(v(2,a,a) - v(2,m,a))*(1 + k*Power(zs(2),2)))/2. + ((1 - d)*mu(a)*(-v(2,a,m) - v(2,m,a) + 2*v(2,m,m))*(1 + k*Power(zs(2),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.) + 2*f(2,m,m)*(-((1 - d)*mu(m)*(v(2,a,m) - v(2,m,m))*(1 + k*Power(zs(2),2)))/2. - ((1 - d)*mu(m)*rmm(2)*(v(2,m,a) - v(2,m,m))*(1 + k*Power(zs(2),2)))/2. + ((1 - d)*mu(m)*(-v(2,a,m) - v(2,m,a) + 2*v(2,m,m))*(1 + k*Power(zs(2),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.)));

double p2tplus1 = bound01(p2 + eul * (((1 - d)*f(1,a,m)*mu(m)*ram(1)*(v(1,a,a) - v(1,a,m))*(1 + k*Power(zs(1),2)))/2. + ((1 - d)*f(2,a,m)*mu(a)*ram(2)*(-v(2,m,a) + v(2,m,m))*(1 + k*Power(zs(2),2)))/2. + f(1,a,m)*(((1 - d)*mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)))/2. + ((1 - d)*mu(a)*(v(1,a,m) + v(1,m,a) - 2*v(1,m,m))*(1 + k*Power(zs(1),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.) + 2*f(1,m,m)*(((1 - d)*mu(m)*(v(1,a,m) + v(1,m,a) - 2*v(1,m,m))*(1 + k*Power(zs(1),2)))/2. + ((1 - d)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)))/2. + ((1 - d)*mu(m)*rmm(1)*(v(1,m,a) - v(1,m,m))*(1 + k*Power(zs(1),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.) + 2*f(2,a,a)*(((1 - d)*mu(a)*raa(2)*(-v(2,a,a) + v(2,a,m))*(1 + k*Power(zs(2),2)))/2. + ((1 - d)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)))/2. + ((1 - d)*mu(a)*(-2*v(2,a,a) + v(2,a,m) + v(2,m,a))*(1 + k*Power(zs(2),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.) + f(2,a,m)*(((1 - d)*mu(m)*(-2*v(2,a,a) + v(2,a,m) + v(2,m,a))*(1 + k*Power(zs(2),2)))/2. + ((1 - d)*mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))/2. + (d*(2*f(1,a,a)*mu(a)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + 2*f(1,m,m)*mu(m)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2)) + f(1,a,m)*(mu(m)*(v(1,a,a) - v(1,m,a))*(1 + k*Power(zs(1),2)) + mu(a)*(v(1,a,m) - v(1,m,m))*(1 + k*Power(zs(1),2))) + 2*f(2,a,a)*mu(a)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + 2*f(2,m,m)*mu(m)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)) + f(2,a,m)*(mu(m)*(-v(2,a,a) + v(2,m,a))*(1 + k*Power(zs(2),2)) + mu(a)*(-v(2,a,m) + v(2,m,m))*(1 + k*Power(zs(2),2)))))/2.)));

double zs1tplus1 = zs1 + eul * (f(1,a,m)*((Power(E,q*zs(1))*q*s(1)*(-v(1,m,a) + v(2,a,m)))/2. + (1 - d)*k*mu(m)*p(2)*(v(1,a,a) - v(1,m,a))*zs(1) - 2*(1 + (-1 + d)/2.)*k*mu(m)*v(1,m,a)*zs(1)) + f(1,a,m)*((Power(E,q*zs(1))*q*ram(1)*s(1)*(-v(1,a,m) + v(2,m,a)))/2. + 2*k*mu(m)*(((1 - d)*p(2))/2. + (d*(2*f(1,a,a)*p(1) + 2*f(2,m,m)*p(1) + 2*f(1,m,m)*p(2) + 2*f(2,a,a)*p(2) + f(1,a,m)*(p(1) + p(2)) + f(2,a,m)*(p(1) + p(2))))/2.)*ram(1)*(v(1,a,a) - v(1,a,m))*zs(1) + (1 - d)*k*mu(m)*ram(1)*(p(1)*(2*v(1,a,a) - v(1,a,m)) + (1 - p(1))*v(1,m,a))*zs(1)) + 2*f(1,a,a)*((Power(E,q*zs(1))*q*(1 + raa(1))*s(1)*(-v(1,a,a) + v(2,m,m)))/2. - 2*(1 + (-1 + d)/2.)*k*mu(a)*v(1,a,a)*zs(1) + k*mu(a)*((1 - d)*(1 - p(1)) + d*(f(1,a,a)*(2 - 2*p(1)) + f(2,m,m)*(2 - 2*p(1)) + f(1,m,m)*(2 - 2*p(2)) + f(2,a,a)*(2 - 2*p(2)) + f(1,a,m)*(2 - p(1) - p(2)) + f(2,a,m)*(2 - p(1) - p(2))))*raa(1)*(-v(1,a,a) + v(1,a,m))*zs(1) + (1 - d)*k*mu(a)*(1 - p(1))*(-v(1,a,a) + v(1,m,a))*zs(1) + (1 - d)*k*mu(a)*raa(1)*(p(1)*v(1,a,a) + (1 - p(1))*(-v(1,a,a) + v(1,a,m) + v(1,m,a)))*zs(1)) + f(1,a,m)*((Power(E,q*zs(1))*q*s(1)*(-v(1,a,m) + v(2,m,a)))/2. - 2*(1 + (-1 + d)/2.)*k*mu(a)*v(1,a,m)*zs(1) + (1 - d)*k*mu(a)*(1 - p(1))*(-v(1,a,m) + v(1,m,m))*zs(1)) + 2*f(1,m,m)*((Power(E,q*zs(1))*q*(1 + rmm(1))*s(1)*(-v(1,m,m) + v(2,a,a)))/2. + (1 - d)*k*mu(m)*p(2)*(v(1,a,m) - v(1,m,m))*zs(1) + k*mu(m)*((1 - d)*p(2) + d*(2*f(1,a,a)*p(1) + 2*f(2,m,m)*p(1) + 2*f(1,m,m)*p(2) + 2*f(2,a,a)*p(2) + f(1,a,m)*(p(1) + p(2)) + f(2,a,m)*(p(1) + p(2))))*rmm(1)*(v(1,m,a) - v(1,m,m))*zs(1) - 2*(1 + (-1 + d)/2.)*k*mu(m)*v(1,m,m)*zs(1) + (1 - d)*k*mu(m)*rmm(1)*(p(2)*(v(1,a,m) + v(1,m,a) - v(1,m,m)) + (1 - p(2))*v(1,m,m))*zs(1)) + f(1,a,m)*((Power(E,q*zs(1))*q*ram(1)*s(1)*(-v(1,m,a) + v(2,a,m)))/2. + 2*k*mu(a)*(((1 - d)*(1 - p(1)))/2. + (d*(f(1,a,a)*(2 - 2*p(1)) + f(2,m,m)*(2 - 2*p(1)) + f(1,m,m)*(2 - 2*p(2)) + f(2,a,a)*(2 - 2*p(2)) + f(1,a,m)*(2 - p(1) - p(2)) + f(2,a,m)*(2 - p(1) - p(2))))/2.)*ram(1)*(-v(1,m,a) + v(1,m,m))*zs(1) + (1 - d)*k*mu(a)*ram(1)*(p(2)*v(1,a,m) + (1 - p(2))*(-v(1,m,a) + 2*v(1,m,m)))*zs(1)));

double zs2tplus1 = zs2 + eul * (f(2,a,m)*((Power(E,q*zs(2))*q*s(2)*(v(1,a,m) - v(2,m,a)))/2. + (1 - d)*k*mu(m)*(1 - p(1))*(v(2,a,a) - v(2,m,a))*zs(2) - 2*(1 + (-1 + d)/2.)*k*mu(m)*v(2,m,a)*zs(2)) + f(2,a,m)*((Power(E,q*zs(2))*q*ram(2)*s(2)*(v(1,m,a) - v(2,a,m)))/2. + 2*k*mu(m)*(((1 - d)*(1 - p(1)))/2. + (d*(f(1,a,a)*(2 - 2*p(1)) + f(2,m,m)*(2 - 2*p(1)) + f(1,m,m)*(2 - 2*p(2)) + f(2,a,a)*(2 - 2*p(2)) + f(1,a,m)*(2 - p(1) - p(2)) + f(2,a,m)*(2 - p(1) - p(2))))/2.)*ram(2)*(v(2,a,a) - v(2,a,m))*zs(2) + (1 - d)*k*mu(m)*ram(2)*((1 - p(2))*(2*v(2,a,a) - v(2,a,m)) + p(2)*v(2,m,a))*zs(2)) + 2*f(2,a,a)*((Power(E,q*zs(2))*q*(1 + raa(2))*s(2)*(v(1,m,m) - v(2,a,a)))/2. - 2*(1 + (-1 + d)/2.)*k*mu(a)*v(2,a,a)*zs(2) + k*mu(a)*((1 - d)*p(2) + d*(2*f(1,a,a)*p(1) + 2*f(2,m,m)*p(1) + 2*f(1,m,m)*p(2) + 2*f(2,a,a)*p(2) + f(1,a,m)*(p(1) + p(2)) + f(2,a,m)*(p(1) + p(2))))*raa(2)*(-v(2,a,a) + v(2,a,m))*zs(2) + (1 - d)*k*mu(a)*p(2)*(-v(2,a,a) + v(2,m,a))*zs(2) + (1 - d)*k*mu(a)*raa(2)*((1 - p(2))*v(2,a,a) + p(2)*(-v(2,a,a) + v(2,a,m) + v(2,m,a)))*zs(2)) + f(2,a,m)*((Power(E,q*zs(2))*q*s(2)*(v(1,m,a) - v(2,a,m)))/2. - 2*(1 + (-1 + d)/2.)*k*mu(a)*v(2,a,m)*zs(2) + (1 - d)*k*mu(a)*p(2)*(-v(2,a,m) + v(2,m,m))*zs(2)) + 2*f(2,m,m)*((Power(E,q*zs(2))*q*(1 + rmm(2))*s(2)*(v(1,a,a) - v(2,m,m)))/2. + (1 - d)*k*mu(m)*(1 - p(1))*(v(2,a,m) - v(2,m,m))*zs(2) + k*mu(m)*((1 - d)*(1 - p(1)) + d*(f(1,a,a)*(2 - 2*p(1)) + f(2,m,m)*(2 - 2*p(1)) + f(1,m,m)*(2 - 2*p(2)) + f(2,a,a)*(2 - 2*p(2)) + f(1,a,m)*(2 - p(1) - p(2)) + f(2,a,m)*(2 - p(1) - p(2))))*rmm(2)*(v(2,m,a) - v(2,m,m))*zs(2) - 2*(1 + (-1 + d)/2.)*k*mu(m)*v(2,m,m)*zs(2) + (1 - d)*k*mu(m)*rmm(2)*((1 - p(1))*(v(2,a,m) + v(2,m,a) - v(2,m,m)) + p(1)*v(2,m,m))*zs(2)) + f(2,a,m)*((Power(E,q*zs(2))*q*ram(2)*s(2)*(v(1,a,m) - v(2,m,a)))/2. + 2*k*mu(a)*(((1 - d)*p(2))/2. + (d*(2*f(1,a,a)*p(1) + 2*f(2,m,m)*p(1) + 2*f(1,m,m)*p(2) + 2*f(2,a,a)*p(2) + f(1,a,m)*(p(1) + p(2)) + f(2,a,m)*(p(1) + p(2))))/2.)*ram(2)*(-v(2,m,a) + v(2,m,m))*zs(2) + (1 - d)*k*mu(a)*ram(2)*((1 - p(1))*v(2,a,m) + p(1)*(-v(2,m,a) + 2*v(2,m,m)))*zs(2)));

gsl_vector_set(f, 0, p1tplus1);
gsl_vector_set(f, 1, p2tplus1);
gsl_vector_set(f, 2, zs1tplus1);
gsl_vector_set(f, 3, zs2tplus1);
